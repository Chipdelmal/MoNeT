(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25866,        650]
NotebookOptionsPosition[     24385,        614]
NotebookOutlinePosition[     24752,        630]
CellTagsIndexPosition[     24709,        627]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions", "Section",
 CellChangeTimes->{{3.795367827465465*^9, 
  3.795367831057701*^9}},ExpressionUUID->"b852c9ed-45db-4036-9364-\
e2e73134bb82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceDiagonal", "[", "m_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mat", "=", "m"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "=", "0"}], ")"}],
          "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "m"}]}], "}"}]}], "]"}]}], "]"}], ";", 
      "mat"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"originalColorsValues", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"70", ",", "50", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100", ",", "100", ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPalette", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"CMYKColor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/", "100"}]}], "]"}], "&"}], "/@", 
    "originalColorsValues"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexToRGB", "=", 
   RowBox[{
    RowBox[{"RGBColor", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IntegerDigits", "[", 
        RowBox[{
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<#\>\"", "\[Rule]", "\"\<16^^\>\""}]}], "]"}]}], ",", 
         "256", ",", "3"}], "]"}], "/", "255."}], ")"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapProcess", "[", 
    RowBox[{
    "freqs_", ",", " ", "pops_", ",", " ", "latLon_", ",", "max_", ",", 
     "countryName_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"GeoGraphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GeoStyling", "[", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Opacity", "[", "0", "]"}], ",", 
              RowBox[{"Thickness", "[", ".05", "]"}], ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"colorPalette", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", ".06"}], "]"}]}], "]"}],
             "]"}], ",", 
           RowBox[{"Opacity", "[", "0", "]"}], ",", 
           RowBox[{"colorPalette", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CountryData", "[", 
          RowBox[{"countryName", ",", "\"\<SchematicPolygon\>\""}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"GeoStyling", "[", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Opacity", "[", "0", "]"}], ",", 
              RowBox[{"Thickness", "[", ".1", "]"}], ",", 
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"Opacity", "[", "0", "]"}], ",", 
           RowBox[{"colorPalette", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CountryData", "[", 
          RowBox[{"countryName", ",", "\"\<SchematicPolygon\>\""}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"GeoStyling", "[", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Opacity", "[", "0", "]"}], ",", 
              RowBox[{"Thickness", "[", ".030", "]"}], ",", 
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"Opacity", "[", "0", "]"}], ",", 
           RowBox[{"colorPalette", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CountryData", "[", 
          RowBox[{"countryName", ",", "\"\<Polygon\>\""}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], "\[IndentingNewLine]",
        ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"colorPalette", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"Thickness", "[", ".0035", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"FrameTicks", "\[Rule]", "None"}], "\[IndentingNewLine]", ",", 
       
       RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]",
        ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", 
           RowBox[{"Opacity", "[", ".2", "]"}], ",", 
           RowBox[{"Thickness", "[", ".00001", "]"}], ",", "Black"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "1500"}], "\[IndentingNewLine]", ",", 
       RowBox[{"GeoBackground", "\[Rule]", "None"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6.6", ",", "6.75"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", ".4"}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", "PopSize", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Darker", "[", 
           RowBox[{
            RowBox[{"hexToRGB", "[", "\"\<#F20060\>\"", "]"}], ",", ".1"}], 
           "]"}], ",", 
          RowBox[{"Opacity", "[", ".015", "]"}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", ".001", "]"}], ",", 
             RowBox[{"Dashing", "[", ".005", "]"}], ",", 
             RowBox[{"Opacity", "[", ".1", "]"}], ",", 
             RowBox[{"Darker", "[", 
              RowBox[{
               RowBox[{"hexToRGB", "[", "\"\<#F20060\>\"", "]"}], ",", ".1"}],
               "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{".001", "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Reverse", "/@", "latLon"}], ",", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"pops", "/", 
                  RowBox[{"Max", "[", "pops", "]"}]}], "/", "7500"}], ")"}], 
               RowBox[{"1", "/", "2"}]]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "Centrality", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"hexToRGB", "[", "\"\<#80A1FC\>\"", "]"}], ",", 
          RowBox[{"Opacity", "[", ".25", "]"}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", ".002", "]"}], ",", 
             RowBox[{"Dashing", "[", "1", "]"}], ",", 
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"hexToRGB", "[", "\"\<#80A1FC\>\"", "]"}]}], "]"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Reverse", "/@", "latLon"}], ",", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"5000", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"pops", "/", 
                    RowBox[{"Max", "[", "pops", "]"}]}], "/", "7500"}], ")"}],
                  "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"freqs", "/", "max"}], "/", "7500"}], ")"}]}], 
                ")"}], 
               RowBox[{"1", "/", "2"}]]}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HistProcess", "[", 
   RowBox[{"steps_", ",", "migration_", ",", "max_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{"steps", ",", 
      RowBox[{"migration", "//", "Length"}], "\[IndentingNewLine]", ",", 
      RowBox[{"AspectRatio", "\[Rule]", ".1"}], "\[IndentingNewLine]", ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], "\[IndentingNewLine]", ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hexToRGB", "[", "\"\<#80A1FC\>\"", "]"}], ",", 
              RowBox[{"Opacity", "[", "0", "]"}], ",", "Thick"}], "}"}], 
            "]"}], "]"}], ",", 
          RowBox[{"Opacity", "[", ".5", "]"}], ",", 
          RowBox[{"hexToRGB", "[", "\"\<#80A1FC\>\"", "]"}]}], "}"}], "]"}]}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"colorPalette", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"Thickness", "[", ".0035", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"FrameTicks", "\[Rule]", "None"}], "\[IndentingNewLine]", ",", 
      RowBox[{"ImageSize", "\[Rule]", "1500"}], "\[IndentingNewLine]", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"migration", "//", "Length"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.795363937547575*^9, 3.79536394931841*^9}, {
  3.7953640881982193`*^9, 3.795364104619007*^9}, {3.795367735320448*^9, 
  3.795367743254055*^9}, {3.795367820057014*^9, 3.795367824325094*^9}, {
  3.795377642104388*^9, 3.795377645937508*^9}, {3.795380730687224*^9, 
  3.7953807400192823`*^9}, {3.795394071869163*^9, 3.795394082498006*^9}, {
  3.795394182918858*^9, 3.795394186465023*^9}, {3.795394237963194*^9, 
  3.795394265427479*^9}, {3.795394302813395*^9, 3.795394316655933*^9}, {
  3.795394416274136*^9, 3.79539441944557*^9}, {3.795394957904023*^9, 
  3.7953949599263363`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"3cd9284b-8809-416a-9918-e16787c084da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Data", "Section",
 CellChangeTimes->{{3.795367834403121*^9, 
  3.795367837863332*^9}},ExpressionUUID->"e0e0fe40-c61e-4d1f-810d-\
fb18d5e7570f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bPath", "=", " ", "\"\<./kernels_cluster/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lonLatPop", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"bPath", "<>", "\"\<stp_cluster_sites_pop.csv\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "All"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"migration", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"bPath", "<>", "\"\<kernel_cluster_2500_2.csv\>\""}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"latLon", "=", 
   RowBox[{"Reverse", "/@", 
    RowBox[{"lonLatPop", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pops", "=", 
   RowBox[{"lonLatPop", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7953601122980747`*^9, 3.795360118745537*^9}, {
  3.7953601814200087`*^9, 3.795360281625147*^9}, {3.795360317874412*^9, 
  3.7953603716506453`*^9}, {3.7953646552714567`*^9, 3.795364712401043*^9}, {
  3.7953673844553833`*^9, 3.795367384885187*^9}, {3.795373315713558*^9, 
  3.7953733163534*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"f619571b-c8a7-4707-b736-0bf5e8251a3a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Markov Process", "Section",
 CellChangeTimes->{{3.7953807632997847`*^9, 
  3.795380769926614*^9}},ExpressionUUID->"7d0a4ee2-5fa2-46c6-9918-\
92389b686312"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sp", ",", "rep"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"500", ",", "1000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Simulate", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialState", "=", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"migration", "//", "Length"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", 
       RowBox[{"247", "\[Rule]", "1"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"markov", "=", 
   RowBox[{"DiscreteMarkovProcess", "[", 
    RowBox[{"initialState", ",", "migration"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MarkovProcessProperties", "[", 
    RowBox[{"markov", ",", "\"\<LimitTransitionMatrix\>\""}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simTraces", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"RandomFunction", "[", 
      RowBox[{"markov", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "sp"}], "}"}], ",", "rep"}], "]"}], "//", 
     "Normal"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "&"}], "/@", "simTraces"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"max", ",", "maxTwo"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Tally", "[", 
        RowBox[{"steps", "//", "Flatten"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Max"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Tally", "[", 
        RowBox[{"steps", "//", "Flatten"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Max"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7953675235207*^9, 3.795367528320244*^9}, {
   3.795367619972732*^9, 3.795367665290456*^9}, {3.79536769772675*^9, 
   3.795367703934533*^9}, {3.795367798589916*^9, 3.795367799688236*^9}, {
   3.795368450775002*^9, 3.795368453116263*^9}, {3.795368533051334*^9, 
   3.7953685424691133`*^9}, {3.7953686370247593`*^9, 
   3.7953686445600853`*^9}, {3.795368716569531*^9, 3.795368719505321*^9}, {
   3.795368828567979*^9, 3.795368840749836*^9}, {3.795368882524926*^9, 
   3.795368913272985*^9}, {3.795368944711976*^9, 3.7953689914953203`*^9}, {
   3.795369131359613*^9, 3.795369175416033*^9}, {3.795369450504478*^9, 
   3.7953696873082027`*^9}, {3.795369729822093*^9, 3.795369752312851*^9}, {
   3.795370826491104*^9, 3.7953708449068947`*^9}, {3.795370930347865*^9, 
   3.795370933150839*^9}, {3.795371042358863*^9, 3.795371066192101*^9}, {
   3.795372325388735*^9, 3.795372325622861*^9}, {3.795372831700984*^9, 
   3.795372832456367*^9}, {3.79537286918379*^9, 3.7953728715827923`*^9}, {
   3.795372945203246*^9, 3.795372955412878*^9}, {3.795373327997246*^9, 
   3.795373328299612*^9}, {3.795373493797024*^9, 3.7953734948675137`*^9}, {
   3.79537355429729*^9, 3.795373554400275*^9}, {3.795373720388839*^9, 
   3.795373758974391*^9}, {3.7953737995597*^9, 3.795373984708187*^9}, {
   3.7953741528194532`*^9, 3.795374184490809*^9}, {3.7953742659843483`*^9, 
   3.795374266413781*^9}, 3.795374307353084*^9, {3.7953744451424*^9, 
   3.795374447954384*^9}, 3.795376200465973*^9, {3.795376251923592*^9, 
   3.7953762530724363`*^9}, {3.7953768487116823`*^9, 3.795376866369493*^9}, 
   3.795377546508039*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"b0ec245d-2f0b-499d-8966-e17ce4572475"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export", "Section",
 CellChangeTimes->{{3.795380772263019*^9, 
  3.795380775588015*^9}},ExpressionUUID->"d3912785-7607-43f1-81ae-\
dd6f5b849001"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"freqs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"steps", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"1", ";;", "t"}]}], "]"}], "]"}], "//", "Flatten"}], ",",
          "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "migration", "]"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "Map", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
    "countryName", "=", 
     "\"\<S\[ATilde]o Tom\[EAcute] and Pr\[IAcute]ncipe\>\""}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"map", "=", 
     RowBox[{"MapProcess", "[", 
      RowBox[{
      "freqs", ",", " ", "pops", ",", " ", "latLon", ",", "max", ",", 
       "countryName"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"hst", "=", 
     RowBox[{"HistProcess", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"steps", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", ";;", "t"}]}], "]"}], "]"}], "//", "Flatten"}], ",", 
       "migration", ",", "maxTwo"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"out", "=", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "hst", "}"}], ",", 
        RowBox[{"{", "map", "}"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<./img/map\>\"", "<>", 
       RowBox[{"StringPadLeft", "[", 
        RowBox[{
         RowBox[{"t", "//", "ToString"}], ",", "4", ",", "\"\<0\>\""}], "]"}],
        "<>", "\"\<.png\>\""}], ",", "out"}], "]"}]}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", "sp"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7953739365909367`*^9, 3.795373995594677*^9}, {
  3.795374132690297*^9, 3.795374133267991*^9}, {3.795374195254418*^9, 
  3.7953741954864683`*^9}, {3.795374670556163*^9, 3.7953746706809473`*^9}, {
  3.795375456639065*^9, 3.795375481934751*^9}, {3.795375553596468*^9, 
  3.795375556554677*^9}, {3.795375876179626*^9, 3.795375878624943*^9}, {
  3.795376869944372*^9, 3.795376985622775*^9}, {3.795377091449502*^9, 
  3.7953771057037067`*^9}, {3.795377166832988*^9, 3.795377184392929*^9}, {
  3.795377259521751*^9, 3.795377260109775*^9}, {3.795377523888048*^9, 
  3.795377526854053*^9}, {3.795378089671671*^9, 3.795378091649781*^9}, {
  3.795380747284708*^9, 3.79538074909931*^9}, {3.795394105482449*^9, 
  3.79539410691617*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"53e1836b-2f75-4ff7-9daa-952c41f6ebaf"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.795374057437147*^9, 3.795374192652492*^9, 3.7953742505499477`*^9, 
   3.795374421838641*^9, 3.795374566232402*^9, 3.795374646636635*^9, 
   3.7953752801989603`*^9, 3.795375464254064*^9, 3.795375523287322*^9, {
   3.7953755660538063`*^9, 3.7953756075111017`*^9}, {3.795375836439826*^9, 
   3.795375861668373*^9}, 3.795376195250099*^9, 3.795376249629848*^9, 
   3.795376372321802*^9, {3.7953769392930813`*^9, 3.795376987495488*^9}, 
   3.795377096359475*^9, {3.795377179033382*^9, 3.7953771891890287`*^9}, 
   3.795377253193768*^9, {3.7953775209835567`*^9, 3.795377558409931*^9}, 
   3.795377720323208*^9, 3.79537776281178*^9, 3.795377822134222*^9, {
   3.795377875757395*^9, 3.795377910410301*^9}, 3.795377940870496*^9, {
   3.795378004234139*^9, 3.795378028995656*^9}, 3.7953780701889*^9, 
   3.795378113796195*^9, 3.795378170469514*^9, 3.795378235137507*^9, {
   3.795378276158724*^9, 3.795378339137436*^9}, 3.795378382568149*^9, {
   3.79537842654602*^9, 3.795378469820766*^9}, 3.795379166419567*^9, 
   3.795394160576508*^9, {3.7953942301173573`*^9, 3.795394257494433*^9}, 
   3.795394296253664*^9, 3.7953944126253347`*^9, 3.795394953261405*^9, 
   3.795395005640109*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"e538a462-5854-41e9-bf88-63e26ffab046"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.795380756552993*^9, 
  3.795380759847559*^9}},ExpressionUUID->"862c8e6c-bbd1-478f-b604-\
265eaef15a24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{
    RowBox[{"ReplaceDiagonal", "[", "migration", "]"}], "\[IndentingNewLine]",
     ",", 
    RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Thick"}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameTicks", "\[Rule]", "None"}], "\[IndentingNewLine]", ",", 
    RowBox[{"ImagePadding", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.795360374624839*^9, 3.795360379539544*^9}, {
   3.795363682887294*^9, 3.7953636883197937`*^9}, {3.795363746344557*^9, 
   3.79536376412002*^9}, {3.795363802188279*^9, 3.795363850739324*^9}, {
   3.7953639409512663`*^9, 3.795363958293548*^9}, 3.795364652103305*^9, 
   3.7953667906531153`*^9},
 CellLabel->
  "In[800]:=",ExpressionUUID->"b5316ab7-6cb0-4354-9980-d6bc27fa8e07"]
}, Closed]]
},
WindowSize->{1311, 827},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.75 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 154, 3, 51, "Section",ExpressionUUID->"b852c9ed-45db-4036-9364-e2e73134bb82"],
Cell[737, 27, 12505, 304, 757, "Input",ExpressionUUID->"3cd9284b-8809-416a-9918-e16787c084da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13279, 336, 154, 3, 51, "Section",ExpressionUUID->"e0e0fe40-c61e-4d1f-810d-fb18d5e7570f"],
Cell[13436, 341, 1514, 40, 121, "Input",ExpressionUUID->"f619571b-c8a7-4707-b736-0bf5e8251a3a"]
}, Closed]],
Cell[CellGroupData[{
Cell[14987, 386, 161, 3, 41, "Section",ExpressionUUID->"7d0a4ee2-5fa2-46c6-9918-92389b686312"],
Cell[15151, 391, 3731, 89, 195, "Input",ExpressionUUID->"b0ec245d-2f0b-499d-8966-e17ce4572475"]
}, Closed]],
Cell[CellGroupData[{
Cell[18919, 485, 151, 3, 41, "Section",ExpressionUUID->"d3912785-7607-43f1-81ae-dd6f5b849001"],
Cell[CellGroupData[{
Cell[19095, 492, 2772, 67, 169, "Input",ExpressionUUID->"53e1836b-2f75-4ff7-9daa-952c41f6ebaf"],
Cell[21870, 561, 1313, 19, 61, "Output",ExpressionUUID->"e538a462-5854-41e9-bf88-63e26ffab046"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23232, 586, 150, 3, 51, "Section",ExpressionUUID->"862c8e6c-bbd1-478f-b604-265eaef15a24"],
Cell[23385, 591, 984, 20, 121, "Input",ExpressionUUID->"b5316ab7-6cb0-4354-9980-d6bc27fa8e07"]
}, Closed]]
}
]
*)

