(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    120022,       2898]
NotebookOptionsPosition[    116700,       2831]
NotebookOutlinePosition[    117087,       2848]
CellTagsIndexPosition[    117044,       2845]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Network Map Animation Routines", "Title",
 CellChangeTimes->{{3.711972549137986*^9, 3.711972559684214*^9}, 
   3.72841750724235*^9},ExpressionUUID->"2ff85094-177f-4203-aeef-\
ae3a7082f034"],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.71205745505372*^9, 3.7120574595945044`*^9}, {
   3.728567273851347*^9, 3.728567295416803*^9}, 
   3.7286746260100727`*^9},ExpressionUUID->"245eba7d-e03d-4aa2-a830-\
5a1f00392c1f"],

Cell[BoxData[{
 RowBox[{"<<", "PajaroLocoPublic`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImportAndReshapeMosquitoDatasets", "[", 
   RowBox[{"dataPath_", ",", 
    RowBox[{"{", 
     RowBox[{"maleFilenamePattern_", ",", "femaleFilenamePattern_"}], "}"}]}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "names", ",", "dataSets", ",", "maleFilenames", ",", "femaleFilenames", 
      ",", "maleDatasets", ",", "femaleDatasets", ",", "genotypes", ",", 
      "ticksMax", ",", "maleMax", ",", "femaleMax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maleFilenames", "=", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"maleFilenamePattern", "<>", "\"\<_*.csv\>\""}], ",", 
         "dataPath"}], "]"}], "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"femaleFilenames", "=", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"femaleFilenamePattern", "<>", "\"\<_Aggregate*.csv\>\""}], 
         ",", "dataPath"}], "]"}], "//", "Sort"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maleDatasets", "=", 
      RowBox[{"AddTotalPopulationToDataset", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", "#", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", ";;", "All"}], ",", 
             RowBox[{"2", ";;", "All"}]}], "]"}], "]"}], "&"}], ",", 
         "maleFilenames"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"femaleDatasets", "=", 
      RowBox[{"AddTotalPopulationToDataset", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Import", "[", "#", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", ";;", "All"}], ",", 
             RowBox[{"2", ";;", "All"}]}], "]"}], "]"}], "&"}], ",", 
         "maleFilenames"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genotypes", "=", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"maleFilenames", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;", "All"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticksMax", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"maleDatasets", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maleMax", ",", "femaleMax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "maleDatasets", "]"}], "//", "Max"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", "femaleDatasets", "]"}], "//", "Max"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "Output", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"maleDatasets", ",", "femaleDatasets"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"genotypes", ",", "ticksMax", ",", 
         RowBox[{"{", 
          RowBox[{"maleMax", ",", "femaleMax"}], "}"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateColorPalette", "[", 
   RowBox[{"genotypes_", ",", "colorScheme_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"steps", ",", "colors"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"steps", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"genotypes", "//", "Length"}], ")"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"colors", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"colorScheme", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", 
            RowBox[{"1", "/", "steps"}]}], "]"}]}], ",", "Black"}], "}"}], "//",
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"genotypes", ",", "\"\<Total\>\""}], "]"}], ",", "colors"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImportGeoCoordinatesAndKernel", "[", 
   RowBox[{"coordinatesFilePath_", ",", "kernelFilePath_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cities", ",", "transitionsMatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cities", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Import", "[", "coordinatesFilePath", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transitionsMatrix", "=", 
      RowBox[{
       RowBox[{"Import", "[", "kernelFilePath", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "All"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"cities", ",", "transitionsMatrix"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddTotalPopulationToDataset", "[", "dataset_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Total", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"dataset", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "dataset", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AggregatePopulationByGenotypeIndices", "[", 
   RowBox[{"populationDatasets_", ",", "genotypesIndicesToAggregate_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"popsDatasets", ",", "geneLabels"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"popsDatasets", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "/@", 
            RowBox[{"populationDatasets", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "All", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "&"}], "/@",
           "genotypesIndicesToAggregate"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "populationDatasets", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"geneLabels", "=", 
      RowBox[{"genotypesIndicesToAggregate", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"geneLabels", ",", 
       RowBox[{"AddTotalPopulationToDataset", "[", "popsDatasets", "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "AggregatePopulationAcrossNodes", "[", "aggregatedPopulations_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Total", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"aggregatedPopulations", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}], "//", "Transpose"}], 
      ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"aggregatedPopulations", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubsetPopulations", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "aggregatedPopulations_", ",", "aggregatedPopulationsAcrossNodes_"}], 
     "}"}], ",", "dataRange_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"aggregatedPopulations", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;", 
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], "//", 
     "Transpose"}], ",", 
    RowBox[{"aggregatedPopulationsAcrossNodes", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"dataRange", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ";;", 
       RowBox[{"dataRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeneratePopCountsFrames", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"labels_", ",", "colors_"}], "}"}], ",", 
    "subsetPopulationsAccrossNodes_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"styledLabels", ",", "styledNumbers", ",", "gridFrames"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"styledLabels", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "30"}], "]"}], "&"}], "/@", "labels"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"styledNumbers", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Round", "[", "#", "]"}], ",", "30", ",", "Black"}], 
           "]"}], "&"}], "/@", 
         RowBox[{"Threshold", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Hard\>\"", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "subsetPopulationsAccrossNodes"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gridFrames", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"styledLabels", ",", 
             RowBox[{"styledNumbers", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "//", "Transpose"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameStyle", "\[Rule]", "Thick"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ItemSize", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Opacity", "[", 
                RowBox[{".25", ",", "#"}], "]"}], "&"}], "/@", "colors"}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]",
          "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"subsetPopulationsAccrossNodes", "//", "Length"}]}], 
         "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChartPopCountsFrames", "[", 
   RowBox[{"subsetPopulations_", ",", 
    RowBox[{"{", 
     RowBox[{"colors_", ",", "maxPop_", ",", "frameDimensions_"}], "}"}]}], 
   "]"}], ":=", 
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{"subsetPopulations", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"1", ";;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "labels", "]"}], "-", "1"}], ")"}]}]}], 
      "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "1", "]"}], ",", "#"}], "]"}], "&"}], "/@",
          "colors"}], " ", ")"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".5", ",", 
         RowBox[{
          RowBox[{"Length", "[", "subsetPopulations", "]"}], "+", ".5"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "maxPop"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"BarSpacing", "\[Rule]", ".2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImagePadding", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "10"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"BarOrigin", "\[Rule]", "Top"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"frameDimensions", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChartPopDynamicsFrames", "[", 
   RowBox[{"tick_", ",", "aggregatedPopulationsAcrossNodes_", ",", 
    RowBox[{"{", 
     RowBox[{
     "colors_", ",", "maxPop_", ",", "ticksMax_", ",", "frameDimensions_", 
      ",", "labels_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dataUntilTick", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataUntilTick", "=", 
      RowBox[{
       RowBox[{"aggregatedPopulationsAcrossNodes", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "tick"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "labels", "]"}], "-", "1"}], ")"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"BarChart", "[", 
      RowBox[{"dataUntilTick", ",", "\[IndentingNewLine]", 
       RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ChartStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Opacity", "[", "1", "]"}], ",", "#"}], "]"}], "&"}], "/@",
             "colors"}], " ", ")"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "ticksMax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "maxPop"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BarSpacing", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BarOrigin", "\[Rule]", "Bottom"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"frameDimensions", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportFrames", "[", 
   RowBox[{"plots_", ",", "dataRange_", ",", 
    RowBox[{"{", 
     RowBox[{"outputBasePath_", ",", "outputFolder_", ",", "filesBaseName_"}],
      "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"namesStrings", ",", "pathsStrings"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"namesStrings", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"filesBaseName", "<>", 
          RowBox[{"StringPadLeft", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], ",", "6", ",", "\"\<0\>\""}],
            "]"}], "<>", "\"\<.png\>\""}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pathsStrings", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"outputBasePath", "<>", "outputFolder", "<>", "#"}], ")"}], 
        "&"}], "/@", "namesStrings"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"pathsStrings", ",", "plots"}], "}"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChartPopDynamicsMaskFrames", "[", 
   RowBox[{"fullRaster_", ",", 
    RowBox[{"{", 
     RowBox[{"tick_", ",", "ticksMax_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rasterDimensions", ",", "stepSize", ",", "composedImage", ",", 
      RowBox[{"day", "=", "tick"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rasterDimensions", "=", 
      RowBox[{"ImageDimensions", "[", "fullRaster", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stepSize", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"rasterDimensions", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "ticksMax"}], "//", "N"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"composedImage", "=", 
      RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
       RowBox[{"fullRaster", ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"White", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"day", "*", "stepSize"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"day", "*", "stepSize"}], "+", 
                 RowBox[{"1", "*", "stepSize"}]}], ",", 
                RowBox[{"rasterDimensions", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "White", ",", 
            RowBox[{"Opacity", "[", ".75", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"day", "*", "stepSize"}], "+", 
                 RowBox[{"1", "*", "stepSize", "*", "stepSize"}]}], ",", 
                "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rasterDimensions", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"rasterDimensions", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "Black", ",", 
            RowBox[{"Opacity", "[", "0", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rasterDimensions", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"rasterDimensions", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"rasterDimensions", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "5"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesStyleList2", "[", 
   RowBox[{"vertexSyllableList_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"OptionValue", "[", "VariableStyle", "]"}], ",", 
    "\[IndentingNewLine]", "\"\<LineColor\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", 
          RowBox[{
           RowBox[{"1", "*", 
            RowBox[{
             RowBox[{"vertexSyllableList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", ".01"}], "]"}], ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{"OptionValue", "[", "LineThickness", "]"}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\"\<LineWidth\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", ".5", "]"}], ",", "Blue", ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"vertexSyllableList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\"\<Both\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", 
          RowBox[{
           RowBox[{".75", "*", 
            RowBox[{
             RowBox[{"vertexSyllableList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", ".05"}], "]"}], ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"vertexSyllableList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "_", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thickness", "[", 
         RowBox[{"OptionValue", "[", "LineThickness", "]"}], "]"}], "}"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeshape", "[", 
   RowBox[{"e_", ",", "___"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Arrowheads", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{".0001", ",", ".5"}], "}"}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", "e", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "GraphTransitionsFrequenciesWithMax", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}], ",", 
    RowBox[{"VertexStyle", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"LineThickness", "\[Rule]", ".0005"}], ",", 
    RowBox[{"VariableStyle", "\[Rule]", "\"\<Both\>\""}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"VertexSize", "\[Rule]", ".5"}], ",", 
    RowBox[{"EdgeShapeFunction", "\[Rule]", "edgeshape"}], ",", 
    RowBox[{"VertexLabelStyle", "\[Rule]", 
     RowBox[{"{", "Italic", "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"VertexShape", "\[Rule]", "Automatic"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"GraphTransitionsFrequenciesWithMax", "[", 
   RowBox[{"frequenciesOutput_", ",", "max_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "frequencies", ",", "syllables", ",", "edges", ",", "fixedEdgesList", 
      ",", "vertexSyllableList", ",", "normalizedVertexSyllableList", ",", 
      "edgesStyleList", ",", "links"}], "}"}], ",", 
    RowBox[{
     RowBox[{"frequencies", "=", 
      RowBox[{"frequenciesOutput", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"syllables", "=", 
      RowBox[{"frequenciesOutput", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DirectedEdge", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "\[Rule]", 
          RowBox[{"frequencies", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "syllables", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "syllables", "]"}]}], "}"}]}], "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fixedEdgesList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"edges", ",", 
        RowBox[{
         RowBox[{"DirectedEdge", "[", 
          RowBox[{"_", ",", "_"}], "]"}], "\[Rule]", "0"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vertexSyllableList", "=", 
      RowBox[{"VertexNumberToVertexSyllable", "[", 
       RowBox[{
        RowBox[{"frequenciesOutput", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "fixedEdgesList"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"normalizedVertexSyllableList", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DirectedEdge", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "max"}]}], "&"}], ")"}], "/@",
        "vertexSyllableList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgesStyleList", "=", 
      RowBox[{"EdgesStyleList2", "[", 
       RowBox[{"normalizedVertexSyllableList", ",", 
        RowBox[{"LineThickness", "\[Rule]", 
         RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], ",", 
        RowBox[{"VariableStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VariableStyle", "]"}]}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"links", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DirectedEdge", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "vertexSyllableList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Graph", "[", 
      RowBox[{"syllables", ",", "links", ",", "\[IndentingNewLine]", 
       RowBox[{"EdgeWeight", "\[Rule]", 
        RowBox[{"vertexSyllableList", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "VertexStyle", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"EdgeStyle", "\[Rule]", "edgesStyleList"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexCoordinates", "\[Rule]", 
        RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"GraphLayout", "\[Rule]", 
        RowBox[{"OptionValue", "[", "GraphLayout", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"EdgeShapeFunction", "\[Rule]", 
        RowBox[{"OptionValue", "[", "EdgeShapeFunction", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexShape", "\[Rule]", 
        RowBox[{"OptionValue", "[", "VertexShape", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexSize", "\[Rule]", 
        RowBox[{"OptionValue", "[", "VertexSize", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VertexLabelStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "VertexLabelStyle", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexLabels", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"EdgeLabels", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"links", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fixedEdgesList", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "Tooltip"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "links", "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Prolog", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Prolog", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Epilog", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"OptionValue", "[", "ImagePadding", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateNetworkParameters", "[", 
   RowBox[{"cities_", ",", "transitionsMatrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "range", ",", "transitionsMatrix2", ",", "vertexCoordinates", ",", 
      "transMatrix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"range", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"cities", "//", "Length"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transitionsMatrix2", "=", 
      RowBox[{"{", 
       RowBox[{"transitionsMatrix", ",", 
        RowBox[{"ToString", "/@", "range"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vertexCoordinates", "=", "cities"}], ";", "\[IndentingNewLine]", 
     RowBox[{"transMatrix", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"transitionsMatrix2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "UpperTriangularize"}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "0"}]}], "]"}], ",", 
        
        RowBox[{"transitionsMatrix2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"range", ",", "transMatrix", ",", "vertexCoordinates"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateVertexScalers", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"range_", ",", "nodeScaler_"}], "}"}], ",", 
    "scaledSizesPieChartFramesAtFrame_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vertexShapes", ",", "vertexSizes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertexShapes", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"range", ",", "scaledSizesPieChartFramesAtFrame"}], "}"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertexSizes", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "\[Rule]", 
           RowBox[{"nodeScaler", "*", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"range", ",", "scaledSizesPieChartFramesAtFrame"}], "}"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"vertexShapes", ",", "vertexSizes"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateNetworkFrames", "[", 
   RowBox[{"vertexShapeAndSizeFrames_", ",", 
    RowBox[{"{", 
     RowBox[{"vertexCoordinates_", ",", "networkMatrix_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "edgeThreshold_", ",", "lineThickness_", ",", "frameDimensions_"}], 
     "}"}], ",", "countryMap_", ",", "colorPalette_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"GraphTransitionsFrequenciesWithMax", "[", 
     RowBox[{
     "networkMatrix", ",", "edgeThreshold", ",", "\[IndentingNewLine]", 
      RowBox[{"VertexCoordinates", "\[Rule]", "vertexCoordinates"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LineThickness", "\[Rule]", "lineThickness"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VertexShape", "\[Rule]", 
       RowBox[{"vertexShapeAndSizeFrames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"VertexSize", "\[Rule]", 
       RowBox[{"vertexShapeAndSizeFrames", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"VariableStyle", "\[Rule]", "\"\<LineColor\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VertexLabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", "Italic", ",", 
         RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"frameDimensions", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Prolog", "\[Rule]", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "1.0", "]"}], ",", 
            RowBox[{"Thickness", "[", ".065", "]"}], ",", 
            RowBox[{"Darker", "[", 
             RowBox[{
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "5", "]"}], "]"}], ",", ".125"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Opacity", "[", "0", "]"}], ",", 
         RowBox[{"colorPalette", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"countryMap", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "1.0", "]"}], ",", 
            RowBox[{"Thickness", "[", ".025", "]"}], ",", 
            RowBox[{"colorPalette", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0", "]"}], ",", 
         RowBox[{"colorPalette", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"countryMap", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.6", "]"}], ",", 
            RowBox[{"Thickness", "[", ".045", "]"}], ",", 
            RowBox[{"Lighter", "[", 
             RowBox[{
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", ".5"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Opacity", "[", "0", "]"}], ",", 
         RowBox[{"colorPalette", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"countryMap", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseFilenames", "[", 
    RowBox[{"tick_", ",", 
     RowBox[{"{", 
      RowBox[{"outputFolder_", ",", 
       RowBox[{"{", 
        RowBox[{
        "outputPopCounts_", ",", "outputBarCharts_", ",", "outputFlow_", ",", 
         "outputNetworks_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "baseCounts_", ",", "baseDays_", ",", "baseBarCharts_", ",", 
         "basePopDyn_", ",", "baseNetworks_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paddedNumber", ",", "rastersFolders", ",", "rastersNames"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paddedNumber", "=", 
       RowBox[{"StringPadLeft", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "tick", "]"}], ",", "6", ",", "\"\<0\>\""}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rastersFolders", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"outputFolder", "<>", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "outputPopCounts", ",", "outputBarCharts", ",", "outputFlow", ",", 
          "outputNetworks"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rastersNames", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "<>", "paddedNumber", "<>", "\"\<.png\>\""}], ")"}], 
         "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "baseCounts", ",", "baseDays", ",", "baseBarCharts", ",", 
          "basePopDyn", ",", "baseNetworks"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"rastersFolders", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<>", 
         RowBox[{"rastersNames", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rastersFolders", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<>", 
         RowBox[{"rastersNames", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rastersFolders", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", 
         RowBox[{"rastersNames", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rastersFolders", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<>", 
         RowBox[{"rastersNames", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rastersFolders", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "<>", 
         RowBox[{"rastersNames", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeneratePieChartsAtTick", "[", 
   RowBox[{"subsetPopulation_", ",", "labels_", ",", "maxPop_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "chartAndPop", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"chartAndPop", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PieChart", "[", 
           RowBox[{"#", ",", 
            RowBox[{"ChartStyle", "\[Rule]", "colors"}], ",", 
            RowBox[{"BaseStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Thickness", "[", ".07", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Black", "]"}], "&"}], ")"}]}], ",", 
            RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Total", "[", "#", "]"}]}], "\[IndentingNewLine]", "}"}], 
        "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"subsetPopulation", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", ";;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "labels", "]"}], "-", "1"}], ")"}]}]}], 
          "]"}], "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "maxPop"}], "]"}]}], "}"}], 
       "&"}], "/@", "chartAndPop"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.728326943204558*^9, 3.728327114790044*^9}, {
   3.7283272648424253`*^9, 3.7283272803599157`*^9}, {3.728329176816496*^9, 
   3.728329186251896*^9}, {3.7283292309477243`*^9, 3.72832928121644*^9}, {
   3.728332687448422*^9, 3.728332755146597*^9}, {3.728332968811112*^9, 
   3.728333053636868*^9}, {3.728333341955595*^9, 3.7283333775064583`*^9}, {
   3.7283334846160717`*^9, 3.72833355756535*^9}, {3.72833372522782*^9, 
   3.72833377344144*^9}, {3.728333815149301*^9, 3.728333853811116*^9}, {
   3.7283342766942673`*^9, 3.7283342813990593`*^9}, {3.7283343120592318`*^9, 
   3.728334335988242*^9}, {3.72833437345467*^9, 3.72833443150733*^9}, {
   3.7283344957065897`*^9, 3.728334508239711*^9}, {3.728336807601453*^9, 
   3.728336807824024*^9}, {3.728392175955579*^9, 3.728392181500003*^9}, {
   3.728392650641917*^9, 3.728392744336775*^9}, {3.728393502036488*^9, 
   3.728393516231666*^9}, {3.7283936790112333`*^9, 3.728393687052297*^9}, {
   3.728393923795252*^9, 3.728393927629265*^9}, {3.728394308030793*^9, 
   3.728394309900206*^9}, {3.7283955451991863`*^9, 3.7283955639357862`*^9}, {
   3.728395634531886*^9, 3.728395644298649*^9}, {3.728395690875722*^9, 
   3.7283957323207617`*^9}, {3.728397191053947*^9, 3.728397191226152*^9}, {
   3.7284175449422293`*^9, 3.72841755694671*^9}, {3.7284176804122553`*^9, 
   3.728417695614478*^9}, {3.728490669498444*^9, 3.728490669658291*^9}, {
   3.728490724021783*^9, 3.7284907263816977`*^9}, {3.728491377190771*^9, 
   3.7284913818604918`*^9}, {3.728492374620162*^9, 3.72849237609617*^9}, {
   3.728492418329426*^9, 3.728492432190857*^9}, {3.728492463991137*^9, 
   3.728492504602594*^9}, 3.728492560225277*^9, {3.728494412114482*^9, 
   3.728494432060635*^9}, {3.728495684623972*^9, 3.7284956847924843`*^9}, {
   3.728495951775135*^9, 3.72849596304009*^9}, {3.7284959992402687`*^9, 
   3.7284960085779448`*^9}, {3.7284962381122227`*^9, 3.728496239144088*^9}, {
   3.728496355700532*^9, 3.7284963583269377`*^9}, {3.728496679578823*^9, 
   3.728496681236289*^9}, {3.728496749267359*^9, 3.728496816877953*^9}, {
   3.72849691521812*^9, 3.728496945731598*^9}, {3.72849702332996*^9, 
   3.728497040161008*^9}, {3.72849707484895*^9, 3.728497095804656*^9}, {
   3.728497243282737*^9, 3.728497269620007*^9}, {3.7284973370763617`*^9, 
   3.728497375480856*^9}, {3.728497484749133*^9, 3.728497525078752*^9}, {
   3.7284975765972*^9, 3.728497577468898*^9}, {3.728497614382655*^9, 
   3.728497617700654*^9}, {3.728497657301201*^9, 3.72849782285634*^9}, {
   3.728566744644655*^9, 3.728566751641177*^9}, {3.7285668117011843`*^9, 
   3.728566815731133*^9}, {3.7285668697570353`*^9, 3.728566879919052*^9}, {
   3.728567210423546*^9, 3.7285672106223297`*^9}, {3.728567410136145*^9, 
   3.728567412270812*^9}, {3.728567444867428*^9, 3.728567447531365*^9}, {
   3.728567569323874*^9, 3.728567570882004*^9}, {3.728569338028398*^9, 
   3.7285693382509823`*^9}, {3.728601447986496*^9, 3.728601448210157*^9}, 
   3.728603740698246*^9, {3.728604051762437*^9, 3.728604059042494*^9}, {
   3.728604297228775*^9, 3.728604298531534*^9}, {3.72860469179161*^9, 
   3.728604697668621*^9}, {3.728604975321335*^9, 3.7286049760403967`*^9}, {
   3.728651715581881*^9, 3.728651721171255*^9}, {3.7286517707693377`*^9, 
   3.728651770939734*^9}, {3.7286518350080748`*^9, 3.728651836807536*^9}, {
   3.7286519961653748`*^9, 3.728652000785906*^9}, {3.7286520701302156`*^9, 
   3.728652072298835*^9}, {3.728652227671226*^9, 3.728652230625249*^9}, 
   3.728653064870328*^9, {3.7286541867581043`*^9, 3.72865419838766*^9}, {
   3.728654233333618*^9, 3.72865423658466*^9}, {3.728654328940135*^9, 
   3.728654331538333*^9}, {3.728656002469954*^9, 3.728656007521349*^9}, 
   3.728656424952304*^9, {3.728656780441863*^9, 3.7286567807531776`*^9}, {
   3.728658844391471*^9, 3.728658844600339*^9}, {3.728659462314067*^9, 
   3.7286594646801777`*^9}, {3.7286603949425583`*^9, 
   3.7286604149524727`*^9}, {3.7286627130644693`*^9, 3.728662713331821*^9}, {
   3.7286635997952547`*^9, 3.7286636048331957`*^9}, {3.7286649876409388`*^9, 
   3.728664990180373*^9}, {3.7286652977094517`*^9, 3.728665297922164*^9}, 
   3.728665349414633*^9, {3.728670388941141*^9, 3.728670389189889*^9}, {
   3.728672579472892*^9, 3.728672591205332*^9}, {3.728672937387883*^9, 
   3.728672942438286*^9}, {3.72867351022372*^9, 3.728673510488492*^9}, {
   3.7286751563643627`*^9, 3.728675156711937*^9}, {3.728749784180561*^9, 
   3.7287497947086906`*^9}, {3.728941219700539*^9, 3.7289412487710543`*^9}, {
   3.7289413709049397`*^9, 3.72894137108816*^9}, {3.7289957307726994`*^9, 
   3.728995750258235*^9}, {3.7289957921062593`*^9, 3.728995796482744*^9}, {
   3.728995864388196*^9, 3.728995865244946*^9}, {3.7289960117366457`*^9, 
   3.7289960135400553`*^9}, {3.728996091179722*^9, 3.728996092351349*^9}, {
   3.728996203812408*^9, 3.7289962346649103`*^9}, {3.728996353423512*^9, 
   3.728996353946418*^9}, {3.7289964313965178`*^9, 3.72899649377738*^9}, {
   3.728996589424657*^9, 3.72899659191605*^9}, {3.72900473321946*^9, 
   3.7290047402593937`*^9}, {3.731950454239332*^9, 3.7319504544385233`*^9}, {
   3.731950500895763*^9, 3.731950501033145*^9}, {3.732020770101081*^9, 
   3.732020770842703*^9}, {3.732021630375461*^9, 3.732021630997154*^9}, {
   3.743449162512767*^9, 3.74344916912396*^9}, 3.7434498367959547`*^9, {
   3.743449872830611*^9, 3.743449873371833*^9}, {3.743450370700624*^9, 
   3.743450371756484*^9}, {3.743451260850581*^9, 3.743451271870798*^9}, {
   3.743451333154169*^9, 3.743451334625948*^9}, 3.743508811180038*^9, {
   3.743524838304216*^9, 3.743524838589142*^9}, {3.74352641381022*^9, 
   3.743526427937607*^9}, {3.7437673027091417`*^9, 3.743767324633358*^9}, {
   3.7437673836146297`*^9, 3.74376738697307*^9}, {3.743767513579831*^9, 
   3.743767561285763*^9}, {3.743767654407014*^9, 3.743767656037682*^9}, {
   3.743767746950049*^9, 3.743767778767014*^9}, {3.743767841365075*^9, 
   3.7437678446273327`*^9}, {3.743768087487336*^9, 3.7437681563385973`*^9}, {
   3.743768361236506*^9, 3.7437683624019747`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"6bef33b5-033f-4d8b-aed7-63185bbfb214"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportGeoCoordinatesAndKernel", "[", 
   RowBox[{"coordinatesFilePath_", ",", "kernelFilePath_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cities", ",", "transitionsMatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cities", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "50"}], "}"}], 
        "&"}], "/@", 
       RowBox[{"Import", "[", "coordinatesFilePath", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transitionsMatrix", "=", 
      RowBox[{
       RowBox[{"Import", "[", "kernelFilePath", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "All"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"cities", ",", "transitionsMatrix"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.732016759615427*^9, 3.7320167597015333`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"06aed437-5f2e-4d33-9c6a-647f7bfab012"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rgbColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ColorData", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<LakeColors\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "[", "1", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ColorData", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<LakeColors\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "[", "0", "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateBlendSetting", "[", "color_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "levels", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"levels", "=", 
      RowBox[{"Level", "[", 
       RowBox[{"color", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"levels", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "0"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"levels", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateBlendSettingCMYK", "[", "color_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "levels", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"levels", "=", 
      RowBox[{"Level", "[", 
       RowBox[{"color", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"levels", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "0"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"levels", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"levels", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexifyColor", "[", "color_RGBColor", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<#\>\"", ",", 
    RowBox[{"IntegerString", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Level", "[", 
         RowBox[{"color", ",", "1"}], "]"}], "*", "255"}], "]"}], ",", "16", 
      ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexToRGB", "=", 
   RowBox[{
    RowBox[{"RGBColor", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IntegerDigits", "[", 
        RowBox[{
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<#\>\"", "\[Rule]", "\"\<16^^\>\""}]}], "]"}]}], ",", 
         "256", ",", "3"}], "]"}], "/", "255."}], ")"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sigmoid", "[", "x_", "]"}], ":=", 
  FractionBox["1", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "5"}], "x"}], "+", "1.75"}]]}]]}]}], "Input",
 CellChangeTimes->{{3.743447233029208*^9, 3.7434472333133907`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"f1231eb3-2fb4-4431-9c9c-319b98434269"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateAnimationFrameFromFiles", "[", "fileNameTuple_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "popCount", ",", "dayCount", ",", "barChart", ",", "flow", ",", 
      "network", ",", "row"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "popCount", ",", "dayCount", ",", "barChart", ",", "flow", ",", 
        "network"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", "#", "]"}], "&"}], "/@", "fileNameTuple"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"row", "=", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ImageRotate", "[", 
            RowBox[{"barChart", ",", 
             RowBox[{"90", "Degree"}]}], "]"}], "//", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"#", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ImageDimensions", "[", "barChart", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ImageDimensions", "[", "barChart", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "1.75"}]}], "}"}]}]}],
              "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"dayCount", "//", 
             RowBox[{
              RowBox[{"ImageRotate", "[", 
               RowBox[{
                RowBox[{"Show", "[", "#", "]"}], ",", 
                RowBox[{"90", "Degree"}]}], "]"}], "&"}]}], ","}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"network", "//", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"#", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"ImageDimensions", "[", "#", "]"}], ")"}]}]}], "]"}], 
            "&"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"popCount", "//", 
            RowBox[{
             RowBox[{"Show", "[", "#", "]"}], "&"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ImageRotate", "[", 
            RowBox[{"flow", ",", 
             RowBox[{"90", "Degree"}]}], "]"}], "//", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"#", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ImageDimensions", "[", "barChart", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ImageDimensions", "[", "barChart", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "1.75"}]}], "}"}]}]}],
              "]"}], "&"}]}]}], "\[IndentingNewLine]", "}"}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Rasterize", "[", "row", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7437681649439077`*^9, 3.74376816725194*^9}, {
  3.743768206853505*^9, 3.743768291302664*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"897ccaad-15a8-45d9-95c1-9a16873cc209"]
}, Closed]],

Cell[CellGroupData[{

Cell["Load Data", "Chapter",
 CellChangeTimes->{{3.728567265596026*^9, 
  3.7285672694841337`*^9}},ExpressionUUID->"82785af7-1316-4a9c-b0ab-\
a724d40fb99f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Subset", " ", "datasets", " ", "to", " ", "export", " ", "a", " ", 
    "specific", " ", "set", " ", "of", " ", "frames"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"framesRange", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"User", "-", 
      RowBox[{
      "Defined", " ", "data", " ", "range", " ", "for", " ", "frames"}]}], 
     ",", " ", 
     RowBox[{"and", " ", "aesthetic", " ", "parameters"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genotypesIndicesToAggregate", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<W\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<H\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "5", ",", "5", ",", "6", ",", "7"}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<R+B\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "6", ",", "8", ",", "8", ",", "9"}], 
          RowBox[{"(*", 
           RowBox[{",", "4", ",", "7", ",", "9", ",", "10", ",", "10"}], 
           "*)"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "frameDimensions", ",", "scaler", ",", "resolution", ",", "colorScheme",
        ",", "nodeScaler"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2560", ",", "1440"}], "}"}], ",", "3.5", ",", "500", ",", 
       "\"\<LakeColors\>\"", ",", "1.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Import", " ", "data", " ", "and", " ", "calculate", " ", "necessary", 
     " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"maleDatasets", ",", "femaleDatasets"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"genotypes", ",", "ticksMax", ",", 
         RowBox[{"{", 
          RowBox[{"maleMax", ",", "femaleMax"}], "}"}]}], "}"}]}], "}"}], "=", 
     RowBox[{"ImportAndReshapeMosquitoDatasets", "[", 
      RowBox[{"\"\<./Homing/E_01_01_0001_1000/\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<ADM_Mean\>\"", ",", "\"\<AF1_Mean\>\""}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cities", ",", "transitionsMatrix"}], "}"}], "=", 
      RowBox[{"ImportGeoCoordinatesAndKernel", "[", 
       RowBox[{
       "\"\<./ATaleOfTwoCitiesScaled_Coordinates.csv\>\"", ",", 
        "\"\<./ATaleOfTwoCitiesScaled_Kernel.csv\>\""}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "outputFolder", ",", "outputBarCharts", ",", "outputFlow", ",", 
       "outputNetworks", ",", "outputPopCounts", ",", "outputFullFrames"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<./frames\>\"", ",", "\"\</BarCharts/\>\"", ",", "\"\</Flow/\>\"", 
       ",", "\"\</Networks/\>\"", ",", "\"\</PopCounts/\>\"", ",", 
       "\"\</FullFrames/\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "baseCounts", ",", "baseDays", ",", "baseBarCharts", ",", "basePopDyn", 
       ",", "baseNetworks", ",", "baseFullFrames"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PopCount\>\"", ",", "\"\<DayCount\>\"", ",", "\"\<BarCharts\>\"", 
       ",", "\"\<Flow\>\"", ",", "\"\<Networks\>\"", ",", 
       "\"\<FullFrame\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "genotypes", "]"}], "]"}], ",", "genotypes"}], 
     "}"}], "//", "Transpose"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Aggregate", " ", "dataset"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalPopulationDatasets", "=", 
     RowBox[{"(", 
      RowBox[{"maleDatasets", "+", "femaleDatasets"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aggregatedLabels", ",", "aggregatedPopulations"}], "}"}], "=", 
     
     RowBox[{"AggregatePopulationByGenotypeIndices", "[", 
      RowBox[{"totalPopulationDatasets", ",", "genotypesIndicesToAggregate"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aggregatedPopulationsAcrossNodes", "=", 
     RowBox[{
     "AggregatePopulationAcrossNodes", "[", "aggregatedPopulations", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"labels", ",", "colors"}], "}"}], "=", 
     RowBox[{"GenerateColorPalette", "[", 
      RowBox[{"aggregatedLabels", ",", "colorScheme"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxPop", "=", 
     RowBox[{
      RowBox[{"aggregatedPopulationsAcrossNodes", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"Length", "[", "labels", "]"}]}], "]"}], "]"}], "//", 
      "Max"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.728327116636553*^9, 3.7283271552881823`*^9}, {
   3.7283272512471857`*^9, 3.728327255969289*^9}, {3.728329188329093*^9, 
   3.728329194008501*^9}, {3.728329305643834*^9, 3.728329319008731*^9}, 
   3.728329379102147*^9, {3.728332513706379*^9, 3.72833257962569*^9}, {
   3.7283327252458677`*^9, 3.728332729227261*^9}, {3.72833301730451*^9, 
   3.728333061195413*^9}, {3.728333228776382*^9, 3.728333275515081*^9}, {
   3.728333595498876*^9, 3.728333661192999*^9}, {3.728333716568172*^9, 
   3.728333723769451*^9}, {3.728333782006322*^9, 3.728333803182967*^9}, {
   3.728333878826664*^9, 3.728333885323452*^9}, {3.728334043653051*^9, 
   3.728334132378693*^9}, {3.72833428731177*^9, 3.728334288160462*^9}, {
   3.728334538162325*^9, 3.7283346102210197`*^9}, {3.728334831663128*^9, 
   3.728334885502347*^9}, {3.728336522312674*^9, 3.7283365225428553`*^9}, {
   3.7283368806208563`*^9, 3.728336929292889*^9}, {3.728336980191895*^9, 
   3.728336994391659*^9}, {3.728337027649765*^9, 3.7283370885146713`*^9}, {
   3.728337546621557*^9, 3.7283375469932823`*^9}, {3.7283377480304193`*^9, 
   3.728337820410749*^9}, {3.728337949843012*^9, 3.7283379599843693`*^9}, {
   3.728392198870007*^9, 3.728392199223555*^9}, {3.728392572540414*^9, 
   3.728392637142479*^9}, {3.728392796305211*^9, 3.7283928264515953`*^9}, {
   3.72839337459499*^9, 3.7283934209025106`*^9}, 3.728393465960044*^9, {
   3.728393790339261*^9, 3.728393791083682*^9}, 3.728393826311481*^9, {
   3.72839427116885*^9, 3.728394271753118*^9}, {3.7283946000196943`*^9, 
   3.728394622632185*^9}, {3.7283948241385517`*^9, 3.7283948325171022`*^9}, {
   3.7283948689795237`*^9, 3.7283948750359583`*^9}, {3.728395551762005*^9, 
   3.728395628918524*^9}, {3.7283956609441547`*^9, 3.728395667265305*^9}, {
   3.7283957513463297`*^9, 3.728395765904841*^9}, {3.7283967150665073`*^9, 
   3.7283967159069633`*^9}, {3.728396767748198*^9, 3.7283967696942577`*^9}, {
   3.7284129193236103`*^9, 3.728412919435519*^9}, {3.728413886074443*^9, 
   3.72841388615361*^9}, {3.728416373446579*^9, 3.728416373518409*^9}, {
   3.728416753904146*^9, 3.728416762841936*^9}, {3.7284168608700743`*^9, 
   3.728416861091811*^9}, {3.728416947552759*^9, 3.728416949861349*^9}, {
   3.7284170123474073`*^9, 3.728417031636009*^9}, {3.728417149713258*^9, 
   3.728417166533058*^9}, {3.7284176386605453`*^9, 3.728417646578332*^9}, {
   3.7284177027008047`*^9, 3.72841770500952*^9}, {3.7284177609543047`*^9, 
   3.7284177706955338`*^9}, {3.72841799346981*^9, 3.728417995767967*^9}, {
   3.728418041375952*^9, 3.728418045348707*^9}, {3.728418097369568*^9, 
   3.72841809762062*^9}, {3.728418131117367*^9, 3.728418132166346*^9}, {
   3.7284182240103407`*^9, 3.728418225677614*^9}, {3.728490522244253*^9, 
   3.7284905445192833`*^9}, {3.728490619399111*^9, 3.728490622820477*^9}, {
   3.728490747195004*^9, 3.728490786664576*^9}, {3.728490851811453*^9, 
   3.7284908605922832`*^9}, {3.728492623272765*^9, 3.72849263467437*^9}, {
   3.72849546808438*^9, 3.72849548157856*^9}, {3.728496408837493*^9, 
   3.728496412269315*^9}, {3.7284978605425386`*^9, 3.728497864002405*^9}, {
   3.7284979858638163`*^9, 3.728497991953371*^9}, {3.728566983613159*^9, 
   3.728566983711122*^9}, {3.728568515754961*^9, 3.7285685277053623`*^9}, {
   3.728568581920233*^9, 3.728568630293599*^9}, {3.7285686812208138`*^9, 
   3.7285686878736*^9}, {3.7285782002809*^9, 3.728578202950485*^9}, {
   3.7285784601083393`*^9, 3.728578461843445*^9}, {3.728578751714657*^9, 
   3.7285787534486628`*^9}, {3.728579164220951*^9, 3.728579167276547*^9}, {
   3.728580479428567*^9, 3.7285804828101797`*^9}, {3.72858939480801*^9, 
   3.728589397957958*^9}, {3.728603024290613*^9, 3.728603026431715*^9}, {
   3.728603750181342*^9, 3.728603752979291*^9}, {3.7286045005412693`*^9, 
   3.728604501754023*^9}, {3.728604963066873*^9, 3.728604963417745*^9}, {
   3.728605540767499*^9, 3.7286055444914923`*^9}, {3.728605959176421*^9, 
   3.728605962876178*^9}, {3.728606955127194*^9, 3.728606961451954*^9}, {
   3.728651388045189*^9, 3.728651390744772*^9}, 3.72865172672084*^9, {
   3.7286518588715563`*^9, 3.728651859217589*^9}, {3.72865223445007*^9, 
   3.7286522345357943`*^9}, {3.728653236029973*^9, 3.7286532400257177`*^9}, {
   3.7286538737187757`*^9, 3.7286538831419287`*^9}, {3.728662601169487*^9, 
   3.728662601269418*^9}, {3.728662664312787*^9, 3.728662699021627*^9}, {
   3.728662752868222*^9, 3.728662754043086*^9}, {3.7286640399021473`*^9, 
   3.7286640505750847`*^9}, {3.728669802728712*^9, 3.728669863290009*^9}, {
   3.728669893439988*^9, 3.728669914088904*^9}, {3.7286731364990273`*^9, 
   3.728673177841728*^9}, {3.728673538677856*^9, 3.728673538903665*^9}, {
   3.728742473759261*^9, 3.7287424740624523`*^9}, {3.728853152791553*^9, 
   3.7288531532448797`*^9}, {3.728853653431014*^9, 3.728853653510724*^9}, {
   3.728853949483267*^9, 3.7288539500123873`*^9}, {3.728854137060046*^9, 
   3.728854144345894*^9}, {3.728855006164719*^9, 3.728855009916059*^9}, {
   3.728910412822548*^9, 3.7289104158502913`*^9}, {3.728927053388077*^9, 
   3.728927068665525*^9}, {3.728927133136668*^9, 3.728927143154904*^9}, {
   3.728927179676564*^9, 3.728927201070212*^9}, {3.728927401242181*^9, 
   3.728927429938491*^9}, {3.7289276769813223`*^9, 3.728927705707827*^9}, {
   3.728928081613021*^9, 3.7289280861595716`*^9}, {3.72892846854987*^9, 
   3.728928468617538*^9}, {3.728939599675844*^9, 3.728939600623076*^9}, {
   3.728939708339991*^9, 3.728939725720945*^9}, 3.728939772649695*^9, {
   3.7289398374697227`*^9, 3.728939839901567*^9}, {3.728939901319989*^9, 
   3.72893990319783*^9}, {3.728939989298233*^9, 3.728939989372077*^9}, {
   3.7289400201981173`*^9, 3.728940144245357*^9}, {3.728940331719266*^9, 
   3.728940386076963*^9}, {3.728940838198268*^9, 3.7289408382670116`*^9}, {
   3.728941019088278*^9, 3.728941024293159*^9}, {3.7289410598094883`*^9, 
   3.728941077339478*^9}, {3.7289411119424667`*^9, 3.728941118671929*^9}, {
   3.72894115401201*^9, 3.728941177447361*^9}, {3.728941311086001*^9, 
   3.7289413494532146`*^9}, {3.7289414930079117`*^9, 3.728941494989101*^9}, {
   3.728941529832205*^9, 3.728941586336563*^9}, {3.728941674815852*^9, 
   3.728941735003621*^9}, {3.728941911338529*^9, 3.728941971818348*^9}, {
   3.728942033737039*^9, 3.72894207803237*^9}, {3.728942110384225*^9, 
   3.72894211063419*^9}, {3.728942156953137*^9, 3.728942157381406*^9}, {
   3.728942187577836*^9, 3.728942189157645*^9}, {3.728942225910606*^9, 
   3.728942228567069*^9}, {3.728942768160615*^9, 3.728942784935046*^9}, {
   3.728942891932707*^9, 3.728942903458653*^9}, {3.728943072628469*^9, 
   3.728943072732839*^9}, {3.7289432455462914`*^9, 3.72894325187066*^9}, {
   3.7289433486348267`*^9, 3.728943350432177*^9}, 3.728995111025558*^9, {
   3.728995835198359*^9, 3.728995836621003*^9}, 3.728996107145178*^9, {
   3.728996167146985*^9, 3.728996167482102*^9}, {3.728997867428652*^9, 
   3.728997872290917*^9}, {3.728998850474172*^9, 3.728998854098871*^9}, {
   3.7289999183943787`*^9, 3.728999924192894*^9}, {3.729001403744197*^9, 
   3.729001407011921*^9}, {3.7290034984956837`*^9, 3.729003505338266*^9}, {
   3.72900360288481*^9, 3.729003605308737*^9}, {3.729004628487089*^9, 
   3.729004655548914*^9}, {3.729004696500369*^9, 3.729004697773459*^9}, {
   3.7290047510509987`*^9, 3.729004752802956*^9}, {3.7290052497519217`*^9, 
   3.7290052504248257`*^9}, {3.729011399279541*^9, 3.729011406308004*^9}, {
   3.7290195443982897`*^9, 3.729019558932803*^9}, {3.7290195906094217`*^9, 
   3.729019598842108*^9}, {3.7319494635765867`*^9, 3.7319494781004543`*^9}, {
   3.73194952847068*^9, 3.731949550130602*^9}, {3.731949686018641*^9, 
   3.731949726196533*^9}, {3.731949771598097*^9, 3.7319497930941143`*^9}, {
   3.731949902027809*^9, 3.731949913925137*^9}, {3.731950063472251*^9, 
   3.731950069922592*^9}, {3.732021496217141*^9, 3.732021496591384*^9}, {
   3.732021613101583*^9, 3.7320216160707893`*^9}, {3.7320399789612494`*^9, 
   3.73203998004963*^9}, {3.7320486556877117`*^9, 3.732048661972107*^9}, {
   3.7330591416998253`*^9, 3.733059174106283*^9}, {3.733059486826733*^9, 
   3.733059487805318*^9}, {3.733061215438151*^9, 3.733061234345891*^9}, {
   3.733061298181223*^9, 3.733061372997555*^9}, {3.733061403331702*^9, 
   3.7330614140634727`*^9}, {3.733061512440838*^9, 3.733061513818021*^9}, 
   3.733063556790379*^9, {3.7330777567011547`*^9, 3.733077757601923*^9}, {
   3.733077863048442*^9, 3.733077864356694*^9}, {3.733084167046123*^9, 
   3.733084170154888*^9}, {3.733138779186311*^9, 3.73313879532489*^9}, {
   3.733139122279965*^9, 3.733139122975759*^9}, {3.7331532556394567`*^9, 
   3.733153270470751*^9}, {3.7331557201908407`*^9, 3.733155720248185*^9}, {
   3.733170044632695*^9, 3.733170051305859*^9}, {3.7332273496716413`*^9, 
   3.7332273503033247`*^9}, {3.743434279554957*^9, 3.743434338442376*^9}, {
   3.7434344607310057`*^9, 3.743434520772249*^9}, {3.743434587900352*^9, 
   3.7434345908057623`*^9}, {3.743434633714203*^9, 3.743434634705658*^9}, 
   3.743434862909264*^9, {3.7434456782570267`*^9, 3.743445683023303*^9}, {
   3.743446129950437*^9, 3.743446153751321*^9}, {3.743446667724533*^9, 
   3.743446668075317*^9}, {3.743446923697526*^9, 3.743446927687819*^9}, {
   3.743448691527338*^9, 3.7434486924922943`*^9}, {3.743449485856381*^9, 
   3.743449489161366*^9}, {3.743449567299077*^9, 3.743449572780051*^9}, {
   3.74351608077527*^9, 3.7435160809492693`*^9}, {3.7435203621596727`*^9, 
   3.743520362744465*^9}, {3.743520786738616*^9, 3.7435207877865334`*^9}, {
   3.743521129252367*^9, 3.74352113061662*^9}, 3.743521200437257*^9, {
   3.743521577615828*^9, 3.743521577998612*^9}, {3.7435219709459553`*^9, 
   3.743521971474833*^9}, {3.7435223020789213`*^9, 3.743522302741057*^9}, {
   3.743523107348979*^9, 3.743523108144347*^9}, 3.743524362487443*^9, {
   3.743529917299967*^9, 3.743529925177062*^9}, {3.74353013766234*^9, 
   3.74353014613684*^9}, {3.743532736382259*^9, 3.7435327365289383`*^9}, {
   3.743535826079383*^9, 3.743535826311715*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"eaf3faab-5169-4026-bc61-e73ab018b0be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"WW\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"WH\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"WR\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"WB\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "\<\"HH\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "\<\"HR\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "\<\"HB\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "\<\"RR\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "\<\"RB\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "\<\"BB\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.731949908519899*^9, 3.731949919924473*^9}, {
   3.731950066011544*^9, 3.73195007568429*^9}, 3.732016707107842*^9, 
   3.732016829511526*^9, 3.7320215076092978`*^9, {3.7320215945801287`*^9, 
   3.7320216227571907`*^9}, 3.732039986965172*^9, {3.732048649117865*^9, 
   3.73204866741428*^9}, 3.732048745207204*^9, 3.73305922740722*^9, 
   3.733059496184737*^9, {3.7330612219630833`*^9, 3.733061251743126*^9}, {
   3.73306130533823*^9, 3.7330613795451393`*^9}, {3.7330614104886827`*^9, 
   3.733061420535983*^9}, 3.7330615250009212`*^9, 3.733063563701796*^9, 
   3.7330777635693817`*^9, 3.733077871167375*^9, 3.733084181702898*^9, 
   3.733138801569242*^9, 3.733139129268951*^9, 3.733153280828781*^9, 
   3.7331545530683327`*^9, 3.733170084493287*^9, 3.733170392403522*^9, 
   3.743434468286324*^9, 3.743434503309884*^9, 3.7434345629780188`*^9, 
   3.743434632578133*^9, 3.743434774390492*^9, 3.743434906596271*^9, 
   3.7434450021325893`*^9, 3.743445137587182*^9, 3.7434457317260313`*^9, 
   3.7434461572268763`*^9, 3.7434462079275913`*^9, 3.7434467199873962`*^9, 
   3.743448736612627*^9, 3.743449217762225*^9, 3.74344953530648*^9, 
   3.74344961756359*^9, 3.743508871739112*^9, 3.743516129037014*^9, 
   3.743520405979774*^9, 3.7435208363195763`*^9, 3.743521178519884*^9, 
   3.743521249908106*^9, 3.743521625885313*^9, 3.743522018700171*^9, 
   3.743522349643475*^9, 3.743523157867591*^9, 3.743524606248163*^9, 
   3.743526490869301*^9, 3.743527515119009*^9, 3.743529969092465*^9, 
   3.743530054674067*^9, 3.7435301525*^9, 3.743531138165102*^9, 
   3.743532794885598*^9, 3.743535900720553*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"58a005b6-b9c6-4bb8-be5d-3d22acb1ad49"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"originalColorsValues", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"70", ",", "50", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100", ",", "70", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"50", ",", "100", ",", "0", ",", "0"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmykColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"CMYKColor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "100"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/", "100"}]}], "]"}], "&"}], "/@", 
    "originalColorsValues"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"rgbColors", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ColorConvert", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<CMYK\>\"", "\[Rule]", "\"\<RGB\>\""}]}], "]"}], "&"}], "/@",
      "cmykColors"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rgbaColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"GenerateBlendSetting", "[", "#", "]"}], "&"}], "/@", 
    "rgbColors"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"rgbColors", ",", 
      RowBox[{"genotypesIndicesToAggregate", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "//", 
   "Grid"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxPopSize", "=", 
   RowBox[{
    RowBox[{"aggregatedPopulationsAcrossNodes", "//", "Flatten"}], "//", 
    "Max"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swatch", "=", 
    RowBox[{"SwatchLegend", "[", 
     RowBox[{"rgbColors", ",", 
      RowBox[{"genotypesIndicesToAggregate", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"LabelStyle", "\[Rule]", "30"}], "\[IndentingNewLine]", ",", 
      RowBox[{"LegendMarkerSize", "\[Rule]", "25"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Manual", " ", "Palette", " ", "Extension"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"rgbColors", ",", "Black"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<./frames/\>\"", "<>", "\"\<swatch.png\>\""}], ",", "swatch", 
    ",", 
    RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.743434970440453*^9, 3.743435038874452*^9}, {
  3.743435093426879*^9, 3.743435107519332*^9}, {3.743445271917816*^9, 
  3.74344529102946*^9}, {3.7434465827820873`*^9, 3.743446583851012*^9}, {
  3.743446930563159*^9, 3.7434469340236063`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"7847b229-7467-4064-bf62-b01ecd2991cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"citiesNumber", "=", 
   RowBox[{"maleDatasets", "//", "Length"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transitionsMatrix", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"citiesNumber", ",", "citiesNumber"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scaledTransitionsMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"1000", "#"}]], "-", "1"}], ")"}]}], "&"}], "/@", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"transitionsMatrix", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "0"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanTransitions", "=", 
   RowBox[{
    RowBox[{"scaledTransitionsMatrix", "//", "Flatten"}], "//", "Mean"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"networkMatrix", "=", 
   RowBox[{"Chop", "/@", 
    RowBox[{"UpperTriangularize", "[", "scaledTransitionsMatrix", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"networkMatrixThreshold", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", 
          RowBox[{"meanTransitions", "/", "1.25"}]}], ",", "#", ",", "0"}], 
        "]"}], "&"}], "/@", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "networkMatrix"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7434350540770082`*^9, 3.7434350911331797`*^9}, {
  3.74344499399164*^9, 3.7434450102448473`*^9}, {3.743445329806409*^9, 
  3.74344533850559*^9}, {3.74352747548839*^9, 3.743527478995783*^9}, {
  3.743527534960516*^9, 3.7435275403302603`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"6c0cd70d-728c-4b5c-a170-b2a6ff80c554"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Rasters", "Chapter",
 CellChangeTimes->{{3.728567301012096*^9, 
  3.728567305122032*^9}},ExpressionUUID->"45127e10-12ed-4ded-8bb2-\
4057397293ab"],

Cell[CellGroupData[{

Cell["Flow Chart (only needs to be run once)", "Subchapter",
 CellChangeTimes->{{3.728675447425973*^9, 3.7286754521154757`*^9}, {
  3.728675530035922*^9, 
  3.728675537794833*^9}},ExpressionUUID->"4b5b5dcb-6dc9-44a8-9a36-\
494a5a02d1fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"barChartPopDynFrames", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BarChartPopDynamicsFrames", "[", 
       RowBox[{"#", ",", "aggregatedPopulationsAcrossNodes", ",", 
        RowBox[{"{", 
         RowBox[{"colors", ",", "maxPopSize", ",", 
          RowBox[{"framesRange", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "frameDimensions", ",", 
          "labels"}], "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "outputFolder", "<>", "\"\</Flow/\>\"", "<>", "\"\<FlowFull.png\>\""}], 
   ",", "barChartPopDynFrames", ",", 
   RowBox[{"ImageResolution", "\[Rule]", "300"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"frameDimensions", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.7289408522984543`*^9, {3.72894091887602*^9, 3.7289409194919863`*^9}, {
   3.743446547232717*^9, 3.743446551918749*^9}, {3.7435211847550497`*^9, 
   3.743521197384865*^9}, 3.743766364848805*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"342d9da7-35ba-4524-ae4f-d6162ef07f84"],

Cell[BoxData["\<\"./frames/Flow/FlowFull.png\"\>"], "Output",
 CellChangeTimes->{3.729019727400256*^9, 3.731949993269022*^9, 
  3.73195022424916*^9, 3.733059406338182*^9, 3.743445565695559*^9, 
  3.743445995820323*^9, 3.743446664150771*^9, 3.7434490716382637`*^9, 
  3.743449470263795*^9, 3.743520652547346*^9, 3.743521092298464*^9, 
  3.743521554236279*^9, 3.7435219598009357`*^9, 3.743522283132009*^9, 
  3.743522615700824*^9, 3.7437663903040657`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"07ace88a-7397-44e9-9c43-0463e064cb5a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Population Counts", "Subchapter",
 CellChangeTimes->{{3.7285673203455*^9, 
  3.728567326837945*^9}},ExpressionUUID->"211a5e2e-7f1a-4027-9073-\
d5f8139bee5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepSize", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Subset", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dataRange", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "+", "stepSize"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subsetPopulations", ",", "subsetPopulationsAccrossNodes"}], 
       "}"}], "=", 
      RowBox[{"SubsetPopulations", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "aggregatedPopulations", ",", "aggregatedPopulationsAcrossNodes"}], 
         "}"}], ",", "dataRange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Export", " ", "Frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"popCountsFrames", "=", 
      RowBox[{"GeneratePopCountsFrames", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"labels", ",", "colors"}], "}"}], ",", 
        "subsetPopulationsAccrossNodes"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"popCountGridFrames", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"dayCounter", ",", "popCountsFrames"}], "}"}], "]"}]}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{"popCountsFrames", ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{"outputFolder", ",", "outputPopCounts", ",", "baseCounts"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dayCounterFrames", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<Day: \>\"", "<>", 
            RowBox[{"StringPadLeft", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], ",", "5", ",", 
              "\"\<0\>\""}], "]"}]}], ")"}], ",", "50"}], "]"}], "&"}], "/@", 
       
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{"dayCounterFrames", ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{"outputFolder", ",", "outputPopCounts", ",", "baseDays"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Clear", " ", "Memory"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "dataRange", ",", "subsetPopulations", ",", 
       "subsetPopulationsAccrossNodes", ",", "dayCounterFrames", ",", 
       "popCountsFrames"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"framesRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "stepSize"}], ",", "stepSize"}], 
     "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728567318057585*^9, 3.7285673185762033`*^9}, {
   3.7286640572535343`*^9, 3.728664084164392*^9}, {3.728664348959845*^9, 
   3.728664374724943*^9}, {3.728664414521009*^9, 3.728664615863657*^9}, {
   3.728665437187715*^9, 3.728665440241418*^9}, {3.728665504174272*^9, 
   3.7286655114764957`*^9}, {3.7286698720076027`*^9, 3.728669874792714*^9}, {
   3.728853331152421*^9, 3.728853397193881*^9}, {3.728853526570937*^9, 
   3.728853526713423*^9}, {3.728853567467815*^9, 3.728853572713142*^9}, 
   3.7289313977739763`*^9, {3.731950356625753*^9, 3.731950371143985*^9}},
 CellLabel->
  "In[594]:=",ExpressionUUID->"ebbe4fd9-7958-48ef-851c-cfaad5883c7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bar Charts", "Subchapter",
 CellChangeTimes->{{3.72856736339316*^9, 
  3.7285673705202417`*^9}},ExpressionUUID->"4830739a-4c06-4add-bf62-\
c008ad9cb10b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepSize", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Subset", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dataRange", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "+", "stepSize"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subsetPopulations", ",", "subsetPopulationsAccrossNodes"}], 
       "}"}], "=", 
      RowBox[{"SubsetPopulations", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "aggregatedPopulations", ",", "aggregatedPopulationsAcrossNodes"}], 
         "}"}], ",", "dataRange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Export", " ", "Frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"barChartFrames", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BarChartPopCountsFrames", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"colors", ",", 
             RowBox[{"Ceiling", "[", 
              RowBox[{"maleMax", "+", "femaleMax"}], "]"}], ",", 
             "frameDimensions"}], "}"}]}], "]"}], "&"}], ",", 
        "\[IndentingNewLine]", "subsetPopulations"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{"barChartFrames", ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{
        "outputFolder", ",", "outputBarCharts", ",", "baseBarCharts"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Clear", " ", "Memory"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "dataRange", ",", "subsetPopulations", ",", 
       "subsetPopulationsAccrossNodes", ",", "days", ",", "barChartFrames"}], 
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"framesRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "stepSize"}], ",", "stepSize"}], 
     "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728651844520816*^9, 3.728651844769874*^9}, {
   3.7286699357304373`*^9, 3.728669936685807*^9}, {3.728853291655842*^9, 
   3.728853306434112*^9}, 3.72893136728538*^9},
 CellLabel->
  "In[274]:=",ExpressionUUID->"08c719b5-3d7b-4620-88d7-93cbf336cb70"]
}, Closed]],

Cell[CellGroupData[{

Cell["Population Dynamics", "Subchapter",
 CellChangeTimes->{{3.728567375656878*^9, 
  3.728567382465563*^9}},ExpressionUUID->"2c88bc1c-b0f5-4663-8b04-\
04b16997ea2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepSize", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Subset", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dataRange", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "+", "stepSize"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subsetPopulations", ",", "subsetPopulationsAccrossNodes"}], 
       "}"}], "=", 
      RowBox[{"SubsetPopulations", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "aggregatedPopulations", ",", "aggregatedPopulationsAcrossNodes"}], 
         "}"}], ",", "dataRange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Export", " ", "Frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullRaster", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
       "outputFolder", "<>", "outputFlow", "<>", "\"\<FlowFull.png\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"days", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"dataRange", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"dataRange", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"barChartPopDynMaskedFrames", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"BarChartPopDynamicsMaskFrames", "[", 
          RowBox[{"fullRaster", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"framesRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], ",", 
        "days"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{"barChartPopDynMaskedFrames", ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{"outputFolder", ",", "outputFlow", ",", "basePopDyn"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Clear", " ", "Memory"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "dataRange", ",", "subsetPopulations", ",", 
       "subsetPopulationsAccrossNodes", ",", "days", ",", 
       "barChartPopDynMaskedFrames"}], "]"}], ";"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"framesRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "stepSize"}], ",", "stepSize"}], 
     "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7286014613559647`*^9, 3.7286015475327587`*^9}, 
   3.728601582173761*^9, {3.7286030091212053`*^9, 3.728603018310872*^9}, {
   3.7286545710685253`*^9, 3.728654584732645*^9}, 3.728655002102021*^9, {
   3.7286699215875473`*^9, 3.728669923627376*^9}, {3.728853174204969*^9, 
   3.728853192297105*^9}, {3.728853269471661*^9, 3.728853274210744*^9}, {
   3.728931355848033*^9, 3.728931357666996*^9}, 3.728931453477345*^9, 
   3.7289402466039143`*^9, {3.733062936701846*^9, 3.7330629393211317`*^9}, {
   3.733063469070876*^9, 3.733063476939909*^9}, 3.733063516543962*^9, {
   3.7434347571446533`*^9, 3.743434759298176*^9}, {3.743434837199154*^9, 
   3.743434839582062*^9}, {3.7435298178187733`*^9, 3.743529819760552*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"34597c70-9839-4123-846c-6d313032e21a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Map", "Subchapter",
 CellChangeTimes->{{3.743447085492078*^9, 
  3.7434470885048313`*^9}},ExpressionUUID->"f9e09ecf-a57d-420b-8ca9-\
67ee35e5e626"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"latLongs", "=", "sampledPoints"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minMaxes", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "#", "]"}], ",", 
       RowBox[{"Max", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"latLongs", "//", "Transpose"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"center", "=", 
   RowBox[{"Mean", "/@", "minMaxes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populations", "=", 
    RowBox[{"Total", "/@", 
     RowBox[{"totalPopulationDatasets", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sizes", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Rescale", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", "populations", "]"}], "//", "Min"}], ",", 
           RowBox[{
            RowBox[{"Log", "[", "populations", "]"}], "//", "Max"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{".05", ",", "2"}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Log", "[", "populations", "]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizes", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rescale", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"populations", "//", "Min"}], ",", 
         RowBox[{"populations", "//", "Max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
    "populations"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridSize", "=", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
       "minMaxes"}], "]"}], "*", ".75"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"originalColorsValuesMap", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"70", ",", "100", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"40", ",", "60", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"50", ",", "100", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100", ",", "100", ",", "100"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorPaletteMap", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Lighter", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CMYKColor", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "100"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "100"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "100"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "/", "100"}]}], "]"}], "&"}], "/@",
        "originalColorsValuesMap"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"citiesNumber", "=", 
   RowBox[{"Length", "[", "maleDatasets", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curve", "=", 
   RowBox[{"PeanoCurve", "[", 
    RowBox[{"3", ",", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"frameDimensions", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"frameDimensions", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graphic", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Thickness", "[", ".01", "]"}], ",", "LightGray", ",", 
      RowBox[{"Opacity", "[", ".75", "]"}], ",", 
      RowBox[{"Dashing", "[", "0", "]"}], ",", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{
        RowBox[{"curve", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"SplineDegree", "\[Rule]", "1"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Thickness", "[", ".001", "]"}], ",", "White", ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Dashing", "[", "0", "]"}], ",", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{
        RowBox[{"curve", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"SplineDegree", "\[Rule]", "1"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsNumber", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"curve", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampledPoints", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"curve", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "//", "DeleteDuplicates"}], ")"}], 
     "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "pointsNumber", ",", 
        RowBox[{"Round", "[", 
         RowBox[{"pointsNumber", "/", "citiesNumber"}], "]"}]}], "]"}], "]"}],
      "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "citiesNumber"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"graphic", ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"sampledPoints", ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"PointSize", "[", ".015", "]"}]}]}], "]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "1500"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.74344717305707*^9, 3.7434471827766657`*^9}, {
   3.743510119363867*^9, 3.743510122305901*^9}, {3.743510159489099*^9, 
   3.743510180979195*^9}, 3.743516173128848*^9, {3.743535548888941*^9, 
   3.74353555791292*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"d00f8634-3e6a-4302-9812-0bac6bca63f6"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"sampledPoints\\\", \\\",\\\", \\\"sampledPoints\\\"}], \
\\\"}\\\"}]\\) cannot be transposed.\"",2,60,1,18664945126650855108,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.743535947013269*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"0ce568fb-7eef-46eb-8b62-274d5852d565"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepSize", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Subset", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dataRange", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "+", "stepSize"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subsetPopulations", "=", 
      RowBox[{"SubsetPopulations", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "aggregatedPopulations", ",", "aggregatedPopulationsAcrossNodes"}], 
         "}"}], ",", "dataRange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pieChartFrames", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GeneratePieChartsAtTick", "[", 
          RowBox[{"#", ",", "labels", ",", 
           RowBox[{"maleMax", "+", "femaleMax"}]}], "]"}], "&"}], ",", 
        RowBox[{"subsetPopulations", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pieChartFrames", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Sigmoid", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "pieChartFrames"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"range", ",", "networkMatrix", ",", "vertexCoordinates"}], 
       "}"}], "=", 
      RowBox[{"CalculateNetworkParameters", "[", 
       RowBox[{"sampledPoints", ",", "transitionsMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vertexShapeAndSizeFrames", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CalculateVertexScalers", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"range", ",", 
             RowBox[{"nodeScaler", "*", ".775"}]}], "}"}], ",", "#"}], "]"}], 
         "&"}], ",", "pieChartFrames"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"networkFrames", "=", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GenerateNetworkFrames", "[", 
         RowBox[{
          RowBox[{"vertexShapeAndSizeFrames", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"vertexCoordinates", ",", "networkMatrix"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", ".0001", ",", "frameDimensions"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"curve", ",", "curve"}], "}"}], ",", "colorPaletteMap"}], 
         "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"stepSize", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"graphic", ",", "#", ",", 
           RowBox[{"ImageSize", "\[Rule]", "frameDimensions"}]}], "]"}], 
         "&"}], "/@", "networkFrames"}], ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{"outputFolder", ",", "outputNetworks", ",", "baseNetworks"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Clear", " ", "Memory"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "dataRange", ",", "subsetPopulations", ",", "pieChartFrames", ",", 
       "vertexShapeAndSizeFrames", ",", "networkFrames", ",", "range", ",", 
       "networkMatrix", ",", "vertexCoordinates"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"framesRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "stepSize"}], ",", "stepSize"}], 
     "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7434507356860523`*^9, 3.7434507419213743`*^9}, {
   3.743508950214737*^9, 3.743509077621285*^9}, {3.743509122625929*^9, 
   3.743509123219736*^9}, {3.7435097261747503`*^9, 3.7435097645523367`*^9}, {
   3.743509811752145*^9, 3.7435098559038687`*^9}, {3.743509886204467*^9, 
   3.743509891448102*^9}, {3.7435099426291447`*^9, 3.743509943012885*^9}, {
   3.743509989978115*^9, 3.743510011311017*^9}, 3.7435100517827806`*^9, {
   3.743510139991192*^9, 3.743510154959526*^9}, {3.743510200115829*^9, 
   3.743510201389842*^9}, {3.7435162010147047`*^9, 3.743516222703967*^9}, {
   3.743516782029614*^9, 3.743516842336578*^9}, {3.743516872614749*^9, 
   3.743516904849637*^9}, {3.743517069894758*^9, 3.7435171130785017`*^9}, {
   3.743517143939283*^9, 3.743517174600155*^9}, 3.743517205572303*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"b2a0d74e-9edb-4dd4-86c8-9500f20a04ed"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Frames", "Chapter",
 CellChangeTimes->{{3.7285676167386093`*^9, 3.728567624129726*^9}, {
  3.728604656437027*^9, 3.728604659363276*^9}, {3.728752269495276*^9, 
  3.7287522749613657`*^9}, {3.728847773730139*^9, 3.728847775204405*^9}, {
  3.728853201633174*^9, 
  3.728853201809606*^9}},ExpressionUUID->"0d6b19d6-74de-481f-8344-\
e3550bb74bb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepSize", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Subset", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dataRange", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "+", "stepSize"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subsetPopulations", ",", "subsetPopulationsAccrossNodes"}], 
       "}"}], "=", 
      RowBox[{"SubsetPopulations", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "aggregatedPopulations", ",", "aggregatedPopulationsAcrossNodes"}], 
         "}"}], ",", "dataRange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Export", " ", "Frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fileNames", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParseFilenames", "[", 
         RowBox[{"#", ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"outputFolder", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "outputPopCounts", ",", "outputBarCharts", ",", "outputFlow", 
              ",", "outputNetworks"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "baseCounts", ",", "baseDays", ",", "baseBarCharts", ",", 
              "basePopDyn", ",", "baseNetworks"}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"dataRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fullFrames", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GenerateAnimationFrameFromFiles", "[", "#", "]"}], "&"}], 
        ",", "fileNames"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ExportFrames", "[", 
      RowBox[{"fullFrames", ",", "dataRange", ",", 
       RowBox[{"{", 
        RowBox[{
        "outputFolder", ",", "outputFullFrames", ",", "baseFullFrames"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Clear", " ", "Memory"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{
      "dataRange", ",", "subsetPopulations", ",", 
       "subsetPopulationsAccrossNodes", ",", "fileNames", ",", "fullFrames"}],
       "]"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"framesRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"framesRange", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "stepSize"}], ",", "stepSize"}], 
     "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728672908729183*^9, 3.7286729273401537`*^9}, {
   3.728672975994256*^9, 3.7286730204703617`*^9}, {3.728673091450292*^9, 
   3.728673118549974*^9}, {3.72867315609939*^9, 3.7286732120538893`*^9}, {
   3.728673494574224*^9, 3.728673499606791*^9}, {3.728847795436438*^9, 
   3.728847906088168*^9}, {3.728847965973672*^9, 3.728847986928347*^9}, {
   3.728848083272726*^9, 3.728848085390316*^9}, {3.728848115654953*^9, 
   3.728848143937195*^9}, {3.72884854459722*^9, 3.728848551923593*^9}, {
   3.728849202844892*^9, 3.728849203517215*^9}, {3.728849643063548*^9, 
   3.728849643192348*^9}, {3.728849677680154*^9, 3.728849677831018*^9}, {
   3.728851039827561*^9, 3.728851067774704*^9}, {3.728851427388193*^9, 
   3.728851456176692*^9}, {3.728851876353674*^9, 3.728851878316287*^9}, 
   3.728852525186387*^9, {3.7288526424931*^9, 3.728852653071982*^9}, {
   3.728852954636705*^9, 3.7288529731596203`*^9}, {3.728910118825944*^9, 
   3.7289101202725687`*^9}, {3.72900362861559*^9, 3.7290036347359343`*^9}, {
   3.729026789414238*^9, 3.729026789435341*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"1e873da9-668a-4057-8aa4-f3287192a010"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1602, 1366},
WindowMargins->{{Automatic, 253}, {Automatic, 0}},
Magnification:>0.75 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 195, 3, 75, "Title",ExpressionUUID->"2ff85094-177f-4203-aeef-ae3a7082f034"],
Cell[CellGroupData[{
Cell[800, 29, 230, 4, 52, "Chapter",ExpressionUUID->"245eba7d-e03d-4aa2-a830-5a1f00392c1f"],
Cell[1033, 35, 52529, 1266, 1698, "Input",ExpressionUUID->"6bef33b5-033f-4d8b-aed7-63185bbfb214"],
Cell[53565, 1303, 1274, 35, 50, "Input",ExpressionUUID->"06aed437-5f2e-4d33-9c6a-647f7bfab012"],
Cell[54842, 1340, 4130, 114, 201, "Input",ExpressionUUID->"f1231eb3-2fb4-4431-9c9c-319b98434269"],
Cell[58975, 1456, 3484, 88, 104, "Input",ExpressionUUID->"897ccaad-15a8-45d9-95c1-9a16873cc209"]
}, Closed]],
Cell[CellGroupData[{
Cell[62496, 1549, 156, 3, 45, "Chapter",ExpressionUUID->"82785af7-1316-4a9c-b0ab-a724d40fb99f"],
Cell[CellGroupData[{
Cell[62677, 1556, 15471, 282, 345, "Input",ExpressionUUID->"eaf3faab-5169-4026-bc61-e73ab018b0be"],
Cell[78151, 1840, 2430, 46, 27, "Output",ExpressionUUID->"58a005b6-b9c6-4bb8-be5d-3d22acb1ad49"]
}, Open  ]],
Cell[80596, 1889, 3323, 91, 281, "Input",ExpressionUUID->"7847b229-7467-4064-bf62-b01ecd2991cf"],
Cell[83922, 1982, 1927, 54, 106, "Input",ExpressionUUID->"6c0cd70d-728c-4b5c-a170-b2a6ff80c554"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85886, 2041, 161, 3, 52, "Chapter",ExpressionUUID->"45127e10-12ed-4ded-8bb2-4057397293ab"],
Cell[CellGroupData[{
Cell[86072, 2048, 237, 4, 49, "Subchapter",ExpressionUUID->"4b5b5dcb-6dc9-44a8-9a36-494a5a02d1fd"],
Cell[CellGroupData[{
Cell[86334, 2056, 1331, 30, 50, "Input",ExpressionUUID->"342d9da7-35ba-4524-ae4f-d6162ef07f84"],
Cell[87668, 2088, 532, 7, 15, "Output",ExpressionUUID->"07ace88a-7397-44e9-9c43-0463e064cb5a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[88249, 2101, 163, 3, 38, "Subchapter",ExpressionUUID->"211a5e2e-7f1a-4027-9073-d5f8139bee5d"],
Cell[88415, 2106, 4385, 106, 78, "Input",ExpressionUUID->"ebbe4fd9-7958-48ef-851c-cfaad5883c7c"]
}, Closed]],
Cell[CellGroupData[{
Cell[92837, 2217, 159, 3, 38, "Subchapter",ExpressionUUID->"4830739a-4c06-4add-bf62-c008ad9cb10b"],
Cell[92999, 2222, 2654, 64, 140, "Input",ExpressionUUID->"08c719b5-3d7b-4620-88d7-93cbf336cb70"]
}, Closed]],
Cell[CellGroupData[{
Cell[95690, 2291, 167, 3, 38, "Subchapter",ExpressionUUID->"2c88bc1c-b0f5-4663-8b04-04b16997ea2c"],
Cell[95860, 2296, 3570, 81, 131, "Input",ExpressionUUID->"34597c70-9839-4123-846c-6d313032e21a"]
}, Closed]],
Cell[CellGroupData[{
Cell[99467, 2382, 153, 3, 38, "Subchapter",ExpressionUUID->"f9e09ecf-a57d-420b-8ca9-67ee35e5e626"],
Cell[CellGroupData[{
Cell[99645, 2389, 6765, 196, 425, "Input",ExpressionUUID->"d00f8634-3e6a-4302-9812-0bac6bca63f6"],
Cell[106413, 2587, 445, 10, 18, "Message",ExpressionUUID->"0ce568fb-7eef-46eb-8b62-274d5852d565"]
}, Open  ]],
Cell[106873, 2600, 5206, 121, 281, "Input",ExpressionUUID->"b2a0d74e-9edb-4dd4-86c8-9500f20a04ed"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112128, 2727, 354, 6, 52, "Chapter",ExpressionUUID->"0d6b19d6-74de-481f-8344-e3550bb74bb1"],
Cell[112485, 2735, 4187, 92, 297, "Input",ExpressionUUID->"1e873da9-668a-4057-8aa4-f3287192a010"]
}, Open  ]]
}, Open  ]]
}
]
*)

