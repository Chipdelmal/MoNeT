(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    346513,       8047]
NotebookOptionsPosition[    328857,       7745]
NotebookOutlinePosition[    329215,       7761]
CellTagsIndexPosition[    329172,       7758]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Calculating Vectorial Capacity", "Title",
 CellChangeTimes->{{3.734102626358283*^9, 3.734102655645698*^9}, 
   3.73410269688698*^9},ExpressionUUID->"b93f26bf-ec86-4921-8932-\
5b7bc7451b44"],

Cell[CellGroupData[{

Cell["Introductory discussion", "Section",
 CellChangeTimes->{{3.734103279225021*^9, 
  3.734103293415881*^9}},ExpressionUUID->"84bafdf8-9794-4195-8c61-\
15f5fa49c2ce"],

Cell["\<\
Vectorial Capacity is defined as \[OpenCurlyDoubleQuote]the number of \
infectious bites that arise from all the mosquitoes that are infected by a \
single infectious person on a single day.\[CloseCurlyDoubleQuote]  That is to \
say, we pick a single infectious person and look at all of the mosquitoes who \
bite that person on one day.  We then follow each of those mosquitoes and \
count the number of infectious bites that occur between the time when the \
mosquito becomes infectious (after the incubation period) and the time when \
the mosquito dies.

When it comes to our simplified model of mosquito movement, we will consider \
all of the infectious biting events to result in the transmission of a \
parasite from the host to the vector and from the vector to the host.  
\t\[Bullet] We have no hosts in our model so we can\[CloseCurlyQuote]t say \
how likely each host is to be infected.  
\t\[Bullet] We could of course add some assumptions about the efficiency of \
transfer from hosts to vectors, but those would only add some multiplicative \
constants to each infection event

We will also consider every single infection to be independent, such that \
every vector may be infected by an unbounded number of independent parasite \
strains.  This allows us to simply count the number of infectious bites that \
arise from *each* biting event

We will assume that each mosquito\[CloseCurlyQuote]s biological needs require \
it to fly between egg laying/resting sites and blood feeding sites.  (There \
are of course other types of sites where the mosquito might visit, but for \
now we will ignore these)

We will assume that every visit to a blood feeding site results in 1 bite of \
a host, and will treat each bite as transferring parasite from the host to \
the vector.  (Whether or not the bite results in transferring parasite from \
the infectious vector to the host is not relevant to how vectorial capacity \
is defined - only biting conditioning on being infectious, no biting \
conditioning on successful transmission.)\
\>", "Text",
 CellChangeTimes->{{3.734102659587995*^9, 3.734102771342453*^9}, {
  3.734102804310978*^9, 
  3.7341032732103453`*^9}},ExpressionUUID->"1a53b065-2d0a-4340-b45b-\
7858aed2d5b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creating a landscape, defining transition matrix", "Section",
 CellChangeTimes->{{3.734103279225021*^9, 
  3.734103322060953*^9}},ExpressionUUID->"3a2a1455-9005-4fae-9827-\
0ad611b1e804"],

Cell["\<\
The landscape will allow us to define a transition matrix which we can use as \
a Markov transitions matrix.

All of this is borrowed from Hector\[CloseCurlyQuote]s Walking Dead Malaria \
scripts\
\>", "Text",
 CellChangeTimes->{{3.7341033118024406`*^9, 
  3.734103374205538*^9}},ExpressionUUID->"8216e951-8bec-487b-b1c9-\
35f14ff3924a"],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.733489462833503*^9, 
  3.733489465911516*^9}},ExpressionUUID->"f9de247d-6670-4550-9532-\
01cac2cb9dfe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Movement", " ", "Kernels"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateEuclideanDistances", "[", "coordinatesSet_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{
          RowBox[{"coordinatesSet", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "]"}], "&"}], "/@",
       "coordinatesSet"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"coordinatesSet", "//", "Length"}]}], " ", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "one", " ", "is", " ", "out", " ", "of", " ", "date"}], ";", 
    " ", 
    RowBox[{
     RowBox[{"use", " ", "the", " ", "exponential", " ", "one", " ", 
      RowBox[{"instead", ":", "\[IndentingNewLine]", 
       RowBox[{"CalculateInverseLinearKernelMigrationProbabilities", "[", 
        RowBox[{"distancesMatrix_", ",", "nonMigratoryForce_"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"(", 
         FractionBox["#", 
          RowBox[{"Total", "[", "#", "]"}]], ")"}], "]"}], "&"}], "/@", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "distancesMatrix"}], "//", "Quiet"}], ",", 
        RowBox[{"ComplexInfinity", "\[Rule]", "nonMigratoryForce"}]}], 
       "]"}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExponentialKernel", "[", 
    RowBox[{"\[Lambda]_", ",", "distance_"}], "]"}], ":=", 
   RowBox[{"\[Lambda]", "*", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], "*", "distance"}]]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Markov", " ", "-", " ", 
     RowBox[{
     "Calculates", " ", "fraction", " ", "of", " ", "time", " ", "mosquitoes",
       " ", "spend", " ", "at", " ", "each", " ", "network", " ", "node"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{
     "given", " ", "a", " ", "Markov", " ", "process", "\[IndentingNewLine]", 
      "migrationProbabilities"}], " ", "=", " ", 
     RowBox[{"transitions", " ", "probability", " ", "matrix"}]}], ",", " ", 
    RowBox[{
    "calculated", " ", "using", " ", "Euclidean", " ", "distances", " ", 
     "and", " ", "a", " ", "Kernel"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "CalculateMarkovSteadyState", "[", "migrationProbabilities_", "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initialState", ",", "markov", ",", "markovPDF"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"initialState", "=", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"migrationProbabilities", "//", "Length"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"#", ",", 
           RowBox[{"1", "\[Rule]", "1"}]}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"markov", "=", 
       RowBox[{"DiscreteMarkovProcess", "[", 
        RowBox[{"initialState", ",", "migrationProbabilities"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"markovPDF", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"PDF", "[", 
          RowBox[{
           RowBox[{"StationaryDistribution", "[", "markov", "]"}], ",", "#"}],
           "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"markov", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "markovPDF"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Networks", " ", "Plot"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeshape", "[", 
   RowBox[{"e_", ",", "___"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Arrowheads", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{".0075", ",", ".5"}], "}"}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", "e", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "EdgesStyleList", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"LineThickness", "\[Rule]", ".004"}], ",", 
    RowBox[{"VariableStyle", "\[Rule]", "\"\<Both\>\""}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesStyleList", "[", 
   RowBox[{"vertexSyllableList_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"OptionValue", "[", "VariableStyle", "]"}], ",", 
    "\[IndentingNewLine]", "\"\<LineColor\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", 
          RowBox[{
           RowBox[{"1", "*", 
            RowBox[{
             RowBox[{"vertexSyllableList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", ".025"}], "]"}], ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{"OptionValue", "[", "LineThickness", "]"}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\"\<LineWidth\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", ".5", "]"}], ",", "Blue", ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"vertexSyllableList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\"\<Both\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", 
          RowBox[{
           RowBox[{".75", "*", 
            RowBox[{
             RowBox[{"vertexSyllableList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", ".05"}], "]"}], ",", 
         RowBox[{"Thickness", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"vertexSyllableList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], "]"}], 
    ",", "_", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexSyllableList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thickness", "[", 
         RowBox[{"OptionValue", "[", "LineThickness", "]"}], "]"}], "}"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vertexSyllableList", "]"}]}], "}"}]}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"VertexNumberToVertexSyllable", "[", 
   RowBox[{"syllables_", ",", "fixedEdgesList_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectedEdge", "[", 
      RowBox[{
       RowBox[{"syllables", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"fixedEdgesList", "[", 
            RowBox[{"[", "index", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"syllables", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"fixedEdgesList", "[", 
             RowBox[{"[", "index", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"fixedEdgesList", "[", 
          RowBox[{"[", "index", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "//", "N"}], ",", 
    RowBox[{"{", 
     RowBox[{"index", ",", "1", ",", 
      RowBox[{"Length", "[", "fixedEdgesList", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "GraphTransitionsFrequenciesWithMax", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}], ",", 
    RowBox[{"VertexStyle", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"LineThickness", "\[Rule]", ".0005"}], ",", 
    RowBox[{"VariableStyle", "\[Rule]", "\"\<Both\>\""}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Thick"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"VertexSize", "\[Rule]", ".5"}], ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<LakeNetwork\>\""}], ",", 
    RowBox[{"EdgeShapeFunction", "\[Rule]", "edgeshape"}], ",", 
    RowBox[{"VertexLabelStyle", "\[Rule]", 
     RowBox[{"{", "Italic", "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"VertexShape", "\[Rule]", "Automatic"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GraphTransitionsFrequenciesWithMax", "[", 
    RowBox[{"frequenciesOutput_", ",", "max_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "frequencies", ",", "syllables", ",", "edges", ",", "fixedEdgesList", 
       ",", "vertexSyllableList", ",", "normalizedVertexSyllableList", ",", 
       "edgesStyleList", ",", "links"}], "}"}], ",", 
     RowBox[{
      RowBox[{"frequencies", "=", 
       RowBox[{"frequenciesOutput", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"syllables", "=", 
       RowBox[{"frequenciesOutput", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DirectedEdge", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "\[Rule]", 
           RowBox[{"frequencies", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "syllables", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "syllables", "]"}]}], "}"}]}], "]"}], "//",
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixedEdgesList", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"edges", ",", 
         RowBox[{
          RowBox[{"DirectedEdge", "[", 
           RowBox[{"_", ",", "_"}], "]"}], "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vertexSyllableList", "=", 
       RowBox[{"VertexNumberToVertexSyllable", "[", 
        RowBox[{
         RowBox[{"frequenciesOutput", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "fixedEdgesList"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"normalizedVertexSyllableList", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"DirectedEdge", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", "max"}]}], "&"}], ")"}], "/@",
         "vertexSyllableList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgesStyleList", "=", 
       RowBox[{"EdgesStyleList", "[", 
        RowBox[{"normalizedVertexSyllableList", ",", 
         RowBox[{"LineThickness", "\[Rule]", 
          RowBox[{"OptionValue", "[", "LineThickness", "]"}]}], ",", 
         RowBox[{"VariableStyle", "\[Rule]", 
          RowBox[{"OptionValue", "[", "VariableStyle", "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"links", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DirectedEdge", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
        "vertexSyllableList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graph", "[", 
       RowBox[{"syllables", ",", "links", ",", "\[IndentingNewLine]", 
        RowBox[{"EdgeWeight", "\[Rule]", 
         RowBox[{"vertexSyllableList", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VertexStyle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgeStyle", "\[Rule]", "edgesStyleList"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexCoordinates", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"OptionValue", "[", "GraphLayout", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgeShapeFunction", "\[Rule]", 
         RowBox[{"OptionValue", "[", "EdgeShapeFunction", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexShape", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VertexShape", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSize", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VertexSize", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Frame", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FrameStyle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "VertexLabelStyle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgeLabels", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"links", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fixedEdgesList", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Tooltip"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "links", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Prolog", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Prolog", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Epilog", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ImagePadding", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plots", " ", "Styles"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Themes`AddThemeRules", "[", 
  RowBox[{"\"\<LakeMatrixPlot\>\"", "\[IndentingNewLine]", ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], "\[IndentingNewLine]", ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Gray", ",", 
      RowBox[{"Opacity", "[", ".5", "]"}], ",", "Dashed"}], "]"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"ColorData", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<LakeColors\>\"", ",", "\"\<Reverse\>\""}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Gray", ",", "Thick"}], "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"FrameTicks", "\[Rule]", "False"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ImageSize", "\[Rule]", "250"}], "\[IndentingNewLine]", ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Themes`AddThemeRules", "[", 
   RowBox[{"\"\<LakeNetwork\>\"", ",", "\[IndentingNewLine]", ",", 
    RowBox[{"EdgeShapeFunction", "\[Rule]", "edgeshape2"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", "1", "]"}], ",", 
           RowBox[{"Lighter", "[", 
            RowBox[{"Purple", ",", ".45"}], "]"}], ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Opacity", "[", ".75", "]"}], ",", 
              RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"sampledCoordinates", "//", "Length"}]}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Disk", "[", 
           RowBox[{"#", ",", ".25"}], "]"}], "&"}], "/@", 
         "sampledCoordinates"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", " ", "\[Rule]", " ", "500"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"ImagePadding", "\[Rule]", "25"}], "\[IndentingNewLine]", ",", 
    RowBox[{"LineThickness", " ", "\[Rule]", " ", ".0075"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VariableStyle", "\[Rule]", "\"\<Both\>\""}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VertexCoordinates", " ", "\[Rule]", "sampledCoordinates"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VertexSize", " ", "\[Rule]", ".01"}], "\[IndentingNewLine]", ",", 
    RowBox[{"VertexLabelStyle", "\[Rule]", ".001"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"USES", " ", 
    RowBox[{"GLOBALS", "!"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphPlotWrapper", "[", 
   RowBox[{
   "migrationMatrix_", ",", "max_", ",", "vertexSize_", ",", "vertexStyle_"}],
    "]"}], ":=", " ", 
  RowBox[{"GraphTransitionsFrequenciesWithMax", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"migrationMatrix", ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", " ", "/@", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "migrationMatrix", "]"}], "]"}]}]}], "\n", 
     "   ", "}"}], ",", " ", "max", "\[IndentingNewLine]", ",", 
    RowBox[{"EdgeShapeFunction", "\[Rule]", "edgeshape2"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"ImagePadding", "\[Rule]", "0"}], "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSize"}], "\[IndentingNewLine]", ",", 
    RowBox[{"LineThickness", "\[Rule]", "lineThickness"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VariableStyle", "\[Rule]", "\"\<Both\>\""}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "sampledCoordinates"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VertexSize", " ", "\[Rule]", " ", "vertexSize"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"VertexStyle", "\[Rule]", "vertexStyle"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"VertexLabelStyle", "\[Rule]", ".0001"}]}], "\n", "  ", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.733492888322465*^9, 3.733492899351317*^9}, {
   3.733493614622417*^9, 3.733493673483724*^9}, {3.733494396971568*^9, 
   3.733494405168109*^9}, {3.7334947332423286`*^9, 3.73349474495896*^9}, {
   3.733494881730085*^9, 3.733494926559219*^9}, {3.7334985576792603`*^9, 
   3.733498588372547*^9}, {3.733498961570775*^9, 3.733498964782604*^9}, {
   3.7334999007757072`*^9, 3.733499941363491*^9}, {3.733500029570478*^9, 
   3.7335000490695267`*^9}, {3.733500770675809*^9, 3.7335007792971067`*^9}, 
   3.7335010906761837`*^9, {3.7335038108848753`*^9, 3.733503824401737*^9}, {
   3.7335077037294292`*^9, 3.733507736868623*^9}, {3.7335078137131042`*^9, 
   3.733507875616576*^9}, {3.733507910517308*^9, 3.733507918970315*^9}, {
   3.733507968408305*^9, 3.733507971184463*^9}, {3.733508032709569*^9, 
   3.7335080345361223`*^9}, {3.733508093372265*^9, 3.733508098606555*^9}, {
   3.7335126599134693`*^9, 3.733512667012965*^9}, {3.7335166659918127`*^9, 
   3.733516666168283*^9}, {3.7337552306766863`*^9, 3.7337552482548113`*^9}, {
   3.7337555071286907`*^9, 3.7337555496228647`*^9}, {3.7337556629053*^9, 
   3.733755668946903*^9}, {3.734105994400755*^9, 
   3.73410599529561*^9}},ExpressionUUID->"e7410658-f0ce-416d-8652-\
8d0c1c6f5eb3"],

Cell[BoxData["\<\"/Users/dtcitron/Documents/MosPopDyn/MoNeT/MoNeT/Dev/\
DanielCitron\"\>"], "Output",
 CellChangeTimes->{
  3.733489547642559*^9, 3.733492900215695*^9, 3.733493643602984*^9, 
   3.7334936742414207`*^9, 3.733494405575164*^9, {3.7334947344929943`*^9, 
   3.733494745354725*^9}, 3.733494882469976*^9, 3.733494932602929*^9, {
   3.7334985738083897`*^9, 3.733498588802565*^9}, 3.733498965660696*^9, 
   3.73349990835655*^9, 3.733499942675618*^9, 3.733500780108841*^9, 
   3.73350109148522*^9, 3.7335038248195133`*^9, 3.73350493325349*^9, 
   3.733505040429936*^9, 3.733505166921867*^9, 3.733505285122671*^9, 
   3.7335054254663553`*^9, 3.733507031647429*^9, 3.733507318861826*^9, 
   3.733507704440083*^9, 3.733507737405398*^9, {3.733507832567699*^9, 
   3.7335078778632917`*^9}, {3.733507957587358*^9, 3.733507972058652*^9}, 
   3.7335080352033033`*^9, 3.73350810006538*^9, 3.7335085252060823`*^9, 
   3.7335088908770847`*^9, {3.7335126353157167`*^9, 3.7335126676609983`*^9}, 
   3.733513006387869*^9, 3.733577298052198*^9, 3.7335773281693487`*^9, 
   3.733577388762061*^9, 3.733578981705469*^9, 3.7335809543014183`*^9, 
   3.733581321714787*^9, 3.733581836275881*^9, 3.733582147038725*^9, 
   3.733582304666748*^9, {3.7335824890257*^9, 3.7335824972698717`*^9}, 
   3.73358269543843*^9, 3.733582912880033*^9, 3.733583947822092*^9, 
   3.733584354859133*^9, 3.733584696847633*^9, 3.733586414472082*^9, 
   3.73358675691918*^9, 3.733587130062375*^9, 3.733587502230776*^9, 
   3.7335879371756563`*^9, 3.733588334404893*^9, 3.733592205631144*^9, 
   3.7335927005499*^9, 3.7335928791878757`*^9, 3.733593524976356*^9, 
   3.733594157600662*^9, 3.733594484430377*^9, 3.733594564456873*^9, 
   3.733594636236528*^9, 3.733594691654696*^9, 3.733594860684416*^9, 
   3.733594938851735*^9, 3.73359526523295*^9, 3.7335955603079157`*^9, 
   3.733596230910182*^9, 3.733596606810688*^9, 3.7335970071334953`*^9, {
   3.7337533806469927`*^9, 3.733753384831987*^9}, 3.733755866750153*^9, 
   3.734103876805148*^9, 3.73410599570645*^9, 
   3.734201869027052*^9},ExpressionUUID->"d8a87927-15bf-44c9-968a-\
0137e500b503"],

Cell[BoxData["\<\"LakeMatrixPlot\"\>"], "Output",
 CellChangeTimes->{
  3.733489547642559*^9, 3.733492900215695*^9, 3.733493643602984*^9, 
   3.7334936742414207`*^9, 3.733494405575164*^9, {3.7334947344929943`*^9, 
   3.733494745354725*^9}, 3.733494882469976*^9, 3.733494932602929*^9, {
   3.7334985738083897`*^9, 3.733498588802565*^9}, 3.733498965660696*^9, 
   3.73349990835655*^9, 3.733499942675618*^9, 3.733500780108841*^9, 
   3.73350109148522*^9, 3.7335038248195133`*^9, 3.73350493325349*^9, 
   3.733505040429936*^9, 3.733505166921867*^9, 3.733505285122671*^9, 
   3.7335054254663553`*^9, 3.733507031647429*^9, 3.733507318861826*^9, 
   3.733507704440083*^9, 3.733507737405398*^9, {3.733507832567699*^9, 
   3.7335078778632917`*^9}, {3.733507957587358*^9, 3.733507972058652*^9}, 
   3.7335080352033033`*^9, 3.73350810006538*^9, 3.7335085252060823`*^9, 
   3.7335088908770847`*^9, {3.7335126353157167`*^9, 3.7335126676609983`*^9}, 
   3.733513006387869*^9, 3.733577298052198*^9, 3.7335773281693487`*^9, 
   3.733577388762061*^9, 3.733578981705469*^9, 3.7335809543014183`*^9, 
   3.733581321714787*^9, 3.733581836275881*^9, 3.733582147038725*^9, 
   3.733582304666748*^9, {3.7335824890257*^9, 3.7335824972698717`*^9}, 
   3.73358269543843*^9, 3.733582912880033*^9, 3.733583947822092*^9, 
   3.733584354859133*^9, 3.733584696847633*^9, 3.733586414472082*^9, 
   3.73358675691918*^9, 3.733587130062375*^9, 3.733587502230776*^9, 
   3.7335879371756563`*^9, 3.733588334404893*^9, 3.733592205631144*^9, 
   3.7335927005499*^9, 3.7335928791878757`*^9, 3.733593524976356*^9, 
   3.733594157600662*^9, 3.733594484430377*^9, 3.733594564456873*^9, 
   3.733594636236528*^9, 3.733594691654696*^9, 3.733594860684416*^9, 
   3.733594938851735*^9, 3.73359526523295*^9, 3.7335955603079157`*^9, 
   3.733596230910182*^9, 3.733596606810688*^9, 3.7335970071334953`*^9, {
   3.7337533806469927`*^9, 3.733753384831987*^9}, 3.733755866750153*^9, 
   3.734103876805148*^9, 3.73410599570645*^9, 
   3.7342018690846033`*^9},ExpressionUUID->"86dacd1c-0eac-414c-8e82-\
3d1c5721eb7f"],

Cell[BoxData["\<\"LakeNetwork\"\>"], "Output",
 CellChangeTimes->{
  3.733489547642559*^9, 3.733492900215695*^9, 3.733493643602984*^9, 
   3.7334936742414207`*^9, 3.733494405575164*^9, {3.7334947344929943`*^9, 
   3.733494745354725*^9}, 3.733494882469976*^9, 3.733494932602929*^9, {
   3.7334985738083897`*^9, 3.733498588802565*^9}, 3.733498965660696*^9, 
   3.73349990835655*^9, 3.733499942675618*^9, 3.733500780108841*^9, 
   3.73350109148522*^9, 3.7335038248195133`*^9, 3.73350493325349*^9, 
   3.733505040429936*^9, 3.733505166921867*^9, 3.733505285122671*^9, 
   3.7335054254663553`*^9, 3.733507031647429*^9, 3.733507318861826*^9, 
   3.733507704440083*^9, 3.733507737405398*^9, {3.733507832567699*^9, 
   3.7335078778632917`*^9}, {3.733507957587358*^9, 3.733507972058652*^9}, 
   3.7335080352033033`*^9, 3.73350810006538*^9, 3.7335085252060823`*^9, 
   3.7335088908770847`*^9, {3.7335126353157167`*^9, 3.7335126676609983`*^9}, 
   3.733513006387869*^9, 3.733577298052198*^9, 3.7335773281693487`*^9, 
   3.733577388762061*^9, 3.733578981705469*^9, 3.7335809543014183`*^9, 
   3.733581321714787*^9, 3.733581836275881*^9, 3.733582147038725*^9, 
   3.733582304666748*^9, {3.7335824890257*^9, 3.7335824972698717`*^9}, 
   3.73358269543843*^9, 3.733582912880033*^9, 3.733583947822092*^9, 
   3.733584354859133*^9, 3.733584696847633*^9, 3.733586414472082*^9, 
   3.73358675691918*^9, 3.733587130062375*^9, 3.733587502230776*^9, 
   3.7335879371756563`*^9, 3.733588334404893*^9, 3.733592205631144*^9, 
   3.7335927005499*^9, 3.7335928791878757`*^9, 3.733593524976356*^9, 
   3.733594157600662*^9, 3.733594484430377*^9, 3.733594564456873*^9, 
   3.733594636236528*^9, 3.733594691654696*^9, 3.733594860684416*^9, 
   3.733594938851735*^9, 3.73359526523295*^9, 3.7335955603079157`*^9, 
   3.733596230910182*^9, 3.733596606810688*^9, 3.7335970071334953`*^9, {
   3.7337533806469927`*^9, 3.733753384831987*^9}, 3.733755866750153*^9, 
   3.734103876805148*^9, 3.73410599570645*^9, 
   3.7342018690934753`*^9},ExpressionUUID->"9fa38f15-3125-4c58-825a-\
0f82b29cdc13"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Inputs", "Subsection",
 CellChangeTimes->{{3.7334895415195436`*^9, 
  3.733489544184792*^9}},ExpressionUUID->"d8a35b3a-798d-4eed-ab20-\
d4671c74d004"],

Cell[CellGroupData[{

Cell["Style", "Subsubsection",
 CellChangeTimes->{{3.7334895568584433`*^9, 
  3.7334895593163548`*^9}},ExpressionUUID->"22066219-5034-4548-9426-\
eb6176f0c1c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeChopThreshold", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "1.5"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeshape2", "[", 
   RowBox[{"e_", ",", "___"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Arrowheads", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{".000000001", ",", "1"}], "}"}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", "e", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineThickness", "=", ".0005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imageSize", "=", "250"}], ";"}]}], "Input",
 CellChangeTimes->{{3.733499288762631*^9, 3.733499302066166*^9}, {
   3.733499946740657*^9, 3.733499946953438*^9}, {3.733507797995409*^9, 
   3.7335078090903797`*^9}, {3.733507882578946*^9, 3.733507944227194*^9}, {
   3.7335943427445383`*^9, 3.733594343360859*^9}, 3.733594464592503*^9, {
   3.733594633599244*^9, 3.733594634230753*^9}, {3.7335946893984947`*^9, 
   3.733594689797418*^9}, {3.733594931062623*^9, 3.733594933078239*^9}, 
   3.733596202710865*^9, {3.733768038136444*^9, 
   3.7337680389582653`*^9}},ExpressionUUID->"a25402cb-58e1-4e9b-912d-\
52e45c50bf85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters for generating landscape", "Subsubsection",
 CellChangeTimes->{{3.7334895568584433`*^9, 3.7334895593163548`*^9}, {
  3.734103496335826*^9, 3.7341035235018597`*^9}, {3.734103674520687*^9, 
  3.734103729094585*^9}, {3.734103807734953*^9, 
  3.734103808654852*^9}},ExpressionUUID->"bc1b8081-6095-4c89-8258-\
568a5ae7c658"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Define", ":", "\[IndentingNewLine]", 
     RowBox[{"nodesNumber", " ", "-", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"size", " ", "of", " ", "grid"}], ",", " ", 
        RowBox[{"distance", " ", "between", " ", "nodes"}]}], "}"}]}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "used", " ", "as", " ", "a", " ", "way", " ", "of", " ", "generating", 
      " ", "all", " ", "the", " ", "different", " ", "nodes", " ", "on", " ", 
      "a", " ", "grid"}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"networkDimension", " ", "-", " ", 
      RowBox[{"number", " ", "of", " ", "node", " ", "types"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"distance", " ", "-", " ", 
      RowBox[{"distance", " ", "between", " ", "cities"}]}], ";"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nodesNumber", ",", "networkDimension", ",", "distance"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "50"}], "}"}], ",", "2", ",", "50"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"movementProbabilitiesVector", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"networkDimension", ">", "1"}], ",", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "networkDimension"}], "]"}], "//", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "\[Rule]", "1"}], ",", 
             RowBox[{"3", "\[Rule]", "0"}]}], "}"}]}], "]"}], "&"}]}], ",", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "networkDimension"}], "]"}], "//", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"1", "\[Rule]", "1"}], "}"}]}], "]"}], "&"}]}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"penalizationsMatrix", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RotateRight", "[", 
        RowBox[{"movementProbabilitiesVector", ",", 
         RowBox[{"i", "-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "networkDimension"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "penalizationsMatrix", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.733489612914857*^9, 3.733489614614286*^9}, {
   3.733489704485525*^9, 3.73348974834232*^9}, {3.733489791728853*^9, 
   3.7334898301738777`*^9}, {3.733489861385303*^9, 3.7334898740026207`*^9}, {
   3.733490338065981*^9, 3.733490346153921*^9}, {3.733492197632779*^9, 
   3.733492203888082*^9}, {3.733492276271537*^9, 3.73349229520935*^9}, {
   3.733496253671631*^9, 3.7334962735891237`*^9}, {3.7334963303118753`*^9, 
   3.7334963339858007`*^9}, {3.733499027759161*^9, 3.73349903221343*^9}, {
   3.7335014598262033`*^9, 3.733501460813051*^9}, {3.733504395307025*^9, 
   3.7335043965106993`*^9}, {3.733504928531987*^9, 3.733504929016882*^9}, {
   3.733577292686747*^9, 3.7335773244337053`*^9}, {3.733577383398572*^9, 
   3.733577383843224*^9}, {3.733580384597115*^9, 3.733580385540896*^9}, {
   3.733581304474493*^9, 3.733581306149434*^9}, {3.733581771251039*^9, 
   3.733581826987586*^9}, {3.733582302374753*^9, 3.73358230265522*^9}, {
   3.733582476968616*^9, 3.733582477268673*^9}, {3.733582686597617*^9, 
   3.733582686817432*^9}, {3.7335829023746147`*^9, 3.733582902710506*^9}, {
   3.7335839155921707`*^9, 3.733583937526305*^9}, {3.7335843532010193`*^9, 
   3.73358435337913*^9}, {3.7335846942379932`*^9, 3.7335846944694633`*^9}, {
   3.7335859541793127`*^9, 3.7335859543753967`*^9}, {3.733586750929887*^9, 
   3.733586751045618*^9}, {3.733587127642046*^9, 3.733587127742697*^9}, {
   3.7335874960940943`*^9, 3.733587496229163*^9}, {3.733587881722274*^9, 
   3.733587881802157*^9}, {3.7335883220821*^9, 3.733588327559134*^9}, {
   3.733592200696826*^9, 3.733592215368381*^9}, {3.733592330168948*^9, 
   3.733592330237748*^9}, {3.733592808742837*^9, 3.73359285635815*^9}, {
   3.733594480309514*^9, 3.733594483443573*^9}, {3.733594936079865*^9, 
   3.733594936339353*^9}, {3.733595254179689*^9, 3.733595254380775*^9}, {
   3.733595546904402*^9, 3.733595547159334*^9}, {3.73359621902565*^9, 
   3.733596219292017*^9}, {3.733596556846273*^9, 3.7335965573278646`*^9}, {
   3.733597003885284*^9, 3.7335970047152033`*^9}, {3.733604066287364*^9, 
   3.733604066348184*^9}, {3.733756957302189*^9, 3.733757070079009*^9}, {
   3.734103695400982*^9, 3.734103695647922*^9}, {3.734103733687806*^9, 
   3.7341037542912483`*^9}, {3.73420765642773*^9, 3.734207656846158*^9}, {
   3.734208027053751*^9, 3.734208027367763*^9}, {3.734372553334199*^9, 
   3.734372553485742*^9}, {3.734372824655257*^9, 3.734372825575441*^9}, 
   3.73447050156606*^9},ExpressionUUID->"cba831cb-c146-4a1d-a318-\
1333fdef0f6a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7334897446248217`*^9, 3.733489797682537*^9, {3.7334898696976557`*^9, 
   3.7334898748183126`*^9}, 3.733490367254923*^9, {3.733492198250347*^9, 
   3.733492204262237*^9}, {3.733492291578959*^9, 3.733492295691128*^9}, {
   3.733496257314816*^9, 3.733496273959394*^9}, 3.733496334398624*^9, 
   3.7334990324813747`*^9, 3.733503781570354*^9, 3.733504397252511*^9, {
   3.733504929456738*^9, 3.733504933388624*^9}, 3.733505040568482*^9, 
   3.7335051670075817`*^9, 3.733505285439824*^9, 3.733505425699399*^9, 
   3.733507035797367*^9, 3.733507318977845*^9, 3.733508525367218*^9, 
   3.7335088910203657`*^9, {3.733512635517997*^9, 3.7335126519327183`*^9}, 
   3.733513006499412*^9, 3.7335772981723757`*^9, 3.733577328296445*^9, 
   3.733577388883401*^9, 3.733578981819961*^9, 3.7335809545692883`*^9, 
   3.733581321804204*^9, {3.7335817867284107`*^9, 3.733581836394409*^9}, 
   3.733582147148665*^9, 3.733582304795663*^9, {3.73358248915374*^9, 
   3.733582497408799*^9}, 3.7335826955668364`*^9, 3.733582912982242*^9, 
   3.733583916340431*^9, 3.733583947952005*^9, 3.733584354956482*^9, 
   3.733584696945468*^9, 3.733586414700761*^9, 3.7335867570771637`*^9, 
   3.7335871301925507`*^9, 3.7335875023416357`*^9, 3.733587937433536*^9, 
   3.733588334534374*^9, {3.733592202057642*^9, 3.733592215811363*^9}, 
   3.7335923306479816`*^9, 3.733592700701314*^9, {3.733592870283082*^9, 
   3.733592879304481*^9}, 3.7335935250955133`*^9, 3.7335941578651743`*^9, 
   3.733594484581401*^9, 3.7335945646617203`*^9, 3.733594636378511*^9, 
   3.7335946917617073`*^9, 3.73359486087954*^9, 3.7335949390187273`*^9, 
   3.7335952653602247`*^9, 3.733595560488048*^9, 3.733596231056385*^9, 
   3.733596606955111*^9, 3.733597007294168*^9, 3.7337563244171467`*^9, 
   3.733757070631021*^9, 3.734103757656748*^9, 3.734106003874412*^9, 
   3.734201871686325*^9, 3.734207657742806*^9, 3.734208028296899*^9, 
   3.734372554038025*^9, 3.734372826284388*^9, 
   3.7344705132057667`*^9},ExpressionUUID->"1c617976-4492-4ae3-a855-\
fed6f4de7e64"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random Walks", "Subsubsection",
 CellChangeTimes->{{3.7334895568584433`*^9, 3.7334895593163548`*^9}, {
  3.734103496335826*^9, 3.7341035235018597`*^9}, {3.734103674520687*^9, 
  3.734103714750505*^9}},ExpressionUUID->"3a2d7d1b-537d-4bf3-acf0-\
db159c3ccf9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chainsSteps", ",", "chainsNumber"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"20", ",", "30"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.733516618584094*^9, 3.733516626020912*^9}, {
  3.733516731169373*^9, 
  3.733516743784321*^9}},ExpressionUUID->"d6c8d334-155f-4b31-a117-\
4932cc78bf23"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Landscape", "Subsection",
 CellChangeTimes->{{3.7334895415195436`*^9, 3.733489544184792*^9}, {
  3.7341038036329403`*^9, 
  3.7341038057349*^9}},ExpressionUUID->"7053704c-0f87-4dd3-9334-ae41c01f4a8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"citiesSqrt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"nodesNumber", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"nodesNumber", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampledCoordinates", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"citiesSqrt", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clusteredCoordinates", "=", 
   RowBox[{"FindClusters", "[", 
    RowBox[{"sampledCoordinates", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<NeighborhoodContraction\>\""}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"euclideanDistances", "=", 
   RowBox[{"CalculateEuclideanDistances", "[", "sampledCoordinates", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.734103843267576*^9, 
  3.7341038511759987`*^9}},ExpressionUUID->"97d229b1-6290-423c-8314-\
b8c40906d425"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Visualize", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"colors", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"\"\<BrightBands\>\"", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"Length", "[", "clusteredCoordinates", "]"}], ")"}]}]}], 
          "]"}]}], "]"}], "//", "Flatten"}], "//", "RandomSample"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gridCoordinatesPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"clusteredCoordinates", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], "\[IndentingNewLine]", ",", 
       RowBox[{"AxesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", ".5", "]"}], ",", "Dashed"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"GridLines", "\[Rule]", "None"}], "\[IndentingNewLine]", ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", ".5", "]"}], ",", "Dashed"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "250"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", ".5"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Purple", ",", 
          RowBox[{"EdgeStyle", "[", "Black", "]"}], ",", 
          RowBox[{"Opacity", "[", ".75", "]"}], ",", 
          RowBox[{"PointSize", "[", ".02", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Thick"}], "]"}]}], "\[IndentingNewLine]", ",", 
       
       RowBox[{"FrameTicks", "\[Rule]", "False"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameTicksStyle", "\[Rule]", "15"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matrixDistancesPlot", "=", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", "euclideanDistances"}], ",", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<LakeMatrixPlot\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"gridCoordinatesPlot", ",", "matrixDistancesPlot"}], "}"}], 
     "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.734103862401539*^9, 
  3.734103866912223*^9}},ExpressionUUID->"cc4ece86-d3d8-4758-ac3c-\
fee7beeb33de"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[{{}, {{}, 
        {RGBColor[0.5, 0, 0.5], PointSize[0.02], AbsoluteThickness[1.6], 
         Opacity[0.75], 
         PointBox[{{0., 0.}, {0., 50.}, {0., 100.}, {50., 0.}, {50., 50.}, {
          50., 100.}, {100., 0.}, {100., 50.}, {100., 
          100.}}]}, {}}, {}, {}, {}, {}},
      AspectRatio->1,
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      AxesStyle->Directive[
        GrayLevel[0.5], 
        Opacity[0.5], 
        Dashing[{Small, Small}]],
      DisplayFunction->Identity,
      Frame->{{True, True}, {True, True}},
      FrameLabel->{{None, None}, {None, None}},
      FrameStyle->Directive[
        GrayLevel[0.5], 
        Thickness[Large]],
      FrameTicks->{{False, False}, {False, False}},
      FrameTicksStyle->15,
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5], 
        Opacity[0.5], 
        Dashing[{Small, Small}]],
      ImagePadding->All,
      ImageSize->250,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{0, 100.}, {0, 100.}},
      PlotRangeClipping->True,
      PlotRangePadding->{{0.5, 0.5}, {0.5, 0.5}},
      Ticks->{Automatic, Automatic}], 
     GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQe2N29W5Vy6f2M1ZtOWr676n9y1SR07q6b+35l0/+
/WfKI3urepGn5/Y/tJdaXPDxsCxucTsNDVft9gf2YYbXZ02pv2Nv80BUZufP
V/asbP5KC4/etjc5tmz/NP/L9muzv+WxOT/HKT4j8dXvg+I37BlOBbXeuXzS
ftfeG2GCa5/gFC97yP48+Pgl+1gmb06ZlLX2u1qc8z9+eGBPLX+R6l9Sw4FU
/47G18iML1r7l1Tx0fgazV+j8UW7+AIASM31yA==
       "], {{0, 0}, {9, 9}}, {0, 1}],
      
      AspectRatio->1,
      AxesStyle->Directive[
        GrayLevel[0.5], 
        Opacity[0.5], 
        Dashing[{Small, Small}]],
      Frame->True,
      FrameLabel->{None, None},
      FrameStyle->Directive[
        GrayLevel[0.5], 
        Thickness[Large]],
      FrameTicks->{{False, False}, {False, False}},
      ImageSize->250,
      Method->{},
      PlotRangePadding->0]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.734103867464321*^9, 3.7341038806683826`*^9}, 
   3.7341060205860147`*^9, 3.734201880533896*^9, 3.734207662098227*^9, 
   3.7342080312278547`*^9, 3.734372578887991*^9, 3.7343728307837963`*^9, 
   3.73447051840948*^9},ExpressionUUID->"e982fbd2-0f13-4f2f-bc4f-\
d94863adf516"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Movement Kernel", "Subsection",
 CellChangeTimes->{{3.7334895415195436`*^9, 3.733489544184792*^9}, {
  3.7341038036329403`*^9, 3.7341038057349*^9}, {3.7341039003132057`*^9, 
  3.7341039024791927`*^9}},ExpressionUUID->"99f6d9b1-b686-4af0-8a93-\
8963a917bbf3"],

Cell["Use an exponential Kernel", "Text",
 CellChangeTimes->{{3.73410390828891*^9, 
  3.734103913735067*^9}},ExpressionUUID->"fd18c51a-13c8-44a5-a4fa-\
50498d95e437"],

Cell[BoxData[
 RowBox[{
  RowBox[{"migrationProbabilities", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "/", 
       RowBox[{"Total", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ExponentialKernel", "[", 
         RowBox[{"0.01848777", ",", "#"}], "]"}], "&"}], "/@", 
       "euclideanDistances"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "0"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7335932638907127`*^9, 3.733593325054928*^9}, {
   3.733593382373336*^9, 3.733593482122973*^9}, {3.7335948458826427`*^9, 
   3.733594856342824*^9}, 3.733756749519144*^9, {3.734103923317396*^9, 
   3.734103923825547*^9}},ExpressionUUID->"5909f107-794e-41b3-840b-\
c9f75e05d982"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Visualize", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"matrixMigrationPlot", "=", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", "migrationProbabilities"}], ",", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<LakeMatrixPlot\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colorsType", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<LakeColors\>\"", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "1", ",", 
         RowBox[{"1", "/", "networkDimension"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesSwatchType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"Lighter", "[", 
          RowBox[{"Purple", ",", ".45"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", ".75", "]"}], ",", 
            RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", "networkDimension", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesListType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"stylesSwatchType", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"migrationProbabilities", "//", "Length"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"originalMap", "=", 
    RowBox[{"GraphPlotWrapper", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"migrationProbabilities", "//", "LowerTriangularize"}], ",", 
        RowBox[{".05", "*", "edgeChopThreshold"}]}], "]"}], ",", ".1", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", ".5"}], ")"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"ToString", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"migrationProbabilities", "//", "Length"}], "]"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", "stylesListType"}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7341039275603333`*^9, 
  3.734103929472438*^9}},ExpressionUUID->"79fb1f70-5016-448b-8f9d-\
64b6d719d1f2"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "1", "2", "3", "4", "5", "6", "7", "8", "9"}, {{{2, 1}, {3, 1}, {3, 
       2}, {4, 1}, {4, 2}, {4, 3}, {5, 1}, {5, 2}, {5, 3}, {5, 4}, {6, 1}, {6,
        2}, {6, 3}, {6, 4}, {6, 5}, {7, 1}, {7, 2}, {7, 3}, {7, 4}, {7, 5}, {
       7, 6}, {8, 1}, {8, 2}, {8, 3}, {8, 4}, {8, 5}, {8, 6}, {8, 7}, {9, 
       1}, {9, 2}, {9, 3}, {9, 4}, {9, 5}, {9, 6}, {9, 7}, {9, 8}}, Null}, {
      Background -> GrayLevel[1], 
       EdgeLabels -> {
        DirectedEdge["3", "1"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["4", "3"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["3", "2"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["7", "4"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["8", "2"] -> Placed[0.07349685081816656, Tooltip], 
         DirectedEdge["6", "1"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["6", "3"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["5", "3"] -> Placed[0.10135725709563842`, Tooltip], 
         DirectedEdge["4", "2"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["7", "6"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["9", "8"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["6", "5"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["9", "6"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["8", "1"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["2", "1"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["9", "2"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["7", "1"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["5", "2"] -> Placed[0.1486427429043616, Tooltip], 
         DirectedEdge["4", "1"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["6", "2"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["7", "5"] -> Placed[0.15865566812617113`, Tooltip], 
         DirectedEdge["8", "6"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["8", "3"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["8", "4"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["9", "4"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["8", "7"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["5", "4"] -> Placed[0.1486427429043616, Tooltip], 
         DirectedEdge["9", "7"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["7", "2"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["9", "3"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["9", "1"] -> Placed[0.042924960691143356`, Tooltip], 
         DirectedEdge["5", "1"] -> Placed[0.10135725709563842`, Tooltip], 
         DirectedEdge["8", "5"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["7", "3"] -> Placed[0.042924960691143356`, Tooltip], 
         DirectedEdge["6", "4"] -> Placed[0.07349685081816656, Tooltip], 
         DirectedEdge["9", "5"] -> Placed[0.15865566812617113`, Tooltip]}, 
       EdgeShapeFunction -> {$CellContext`edgeshape2}, 
       EdgeStyle -> {DirectedEdge["8", "2"] -> {
           Opacity[0.6012263811362493], 
           Thickness[0.00036748425409083285`]}, DirectedEdge["5", "2"] -> {
           Opacity[1.1648205717827123`], 
           Thickness[0.0007432137145218081]}, DirectedEdge["9", "2"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["7", "3"] -> {
           Opacity[0.37193720518357515`], 
           Thickness[0.0002146248034557168]}, DirectedEdge["9", "7"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "5"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["5", "1"] -> {
           Opacity[0.8101794282172883], 
           Thickness[0.0005067862854781921]}, DirectedEdge["7", "1"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "1"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["7", "4"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["7", "6"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["9", "3"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["9", "5"] -> {
           Opacity[1.2399175109462834`], 
           Thickness[0.0007932783406308557]}, DirectedEdge["5", "3"] -> {
           Opacity[0.8101794282172883], 
           Thickness[0.0005067862854781921]}, DirectedEdge["7", "2"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["9", "6"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["8", "7"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["3", "2"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["2", "1"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["9", "4"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["8", "6"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["8", "3"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["9", "1"] -> {
           Opacity[0.37193720518357515`], 
           Thickness[0.0002146248034557168]}, DirectedEdge["4", "1"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["3", "1"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "2"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["4", "3"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["8", "5"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["6", "3"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["6", "4"] -> {
           Opacity[0.6012263811362493], 
           Thickness[0.00036748425409083285`]}, DirectedEdge["9", "8"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["5", "4"] -> {
           Opacity[1.1648205717827123`], 
           Thickness[0.0007432137145218081]}, DirectedEdge["4", "2"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["8", "4"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["7", "5"] -> {
           Opacity[1.2399175109462834`], 
           Thickness[0.0007932783406308557]}, DirectedEdge["8", "1"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}}, 
       EdgeWeight -> {0.18523606881859905`, 0.09231826398211916, 
        0.23267217724080452`, 0.18523606881859905`, 0.1263096972229056, 
        0.05908777414011252, 0.10135725709563842`, 0.1486427429043616, 
        0.10135725709563842`, 0.1486427429043616, 0.05908777414011252, 
        0.1263096972229056, 0.18523606881859905`, 0.07349685081816656, 
        0.18523606881859905`, 0.09231826398211916, 0.07421924436841902, 
        0.042924960691143356`, 0.23267217724080452`, 0.15865566812617113`, 
        0.07421924436841902, 0.05908777414011252, 0.07349685081816656, 
        0.05908777414011252, 0.1263096972229056, 0.18523606881859905`, 
        0.1263096972229056, 0.18523606881859905`, 0.042924960691143356`, 
        0.07421924436841902, 0.09231826398211916, 0.07421924436841902, 
        0.15865566812617113`, 0.23267217724080452`, 0.09231826398211916, 
        0.23267217724080452`}, Epilog -> {}, Frame -> False, FrameStyle -> 
       Thickness[Large], GraphLayout -> Automatic, ImagePadding -> 0, 
       ImageSize -> 250, PerformanceGoal -> "Speed", Prolog -> {}, 
       VertexCoordinates -> {{0, 0}, {0, 50}, {0, 100}, {50, 0}, {50, 50}, {
        50, 100}, {100, 0}, {100, 50}, {100, 100}}, VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {0.0001}, 
       VertexSize -> {
        "7" -> 0.5, "2" -> 0.5, "8" -> 0.5, "9" -> 0.5, "6" -> 0.5, "5" -> 
         0.5, "3" -> 0.5, "4" -> 0.5, "1" -> 0.5}, 
       VertexStyle -> {"5" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "8" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "9" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "7" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "2" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "1" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "4" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "3" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "6" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 50.}, {0., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 0.}}]}},
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 50.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 50.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 100.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005067862854781921], Opacity[0.8101794282172883], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 0.}}]}},
          "0.10135725709563842`"],
         Annotation[#, 0.10135725709563842`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007432137145218081], Opacity[1.1648205717827123`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 50.}}]}},
          "0.1486427429043616`"],
         Annotation[#, 0.1486427429043616, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005067862854781921], Opacity[0.8101794282172883], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 100.}}]}},
          "0.10135725709563842`"],
         Annotation[#, 0.10135725709563842`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007432137145218081], Opacity[1.1648205717827123`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {50., 0.}}]}},
          "0.1486427429043616`"],
         Annotation[#, 0.1486427429043616, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 0.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 50.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 100.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00036748425409083285`], Opacity[0.6012263811362493], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 0.}}]}},
          "0.07349685081816656`"],
         Annotation[#, 0.07349685081816656, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 50.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 0.}}]}},
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 50.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002146248034557168], Opacity[0.37193720518357515`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 100.}}]}},
          "0.042924960691143356`"],
         Annotation[#, 0.042924960691143356`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 0.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007932783406308557], Opacity[1.2399175109462834`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 50.}}]}},
          "0.15865566812617113`"],
         Annotation[#, 0.15865566812617113`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 100.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 0.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00036748425409083285`], Opacity[0.6012263811362493], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 50.}}]}},
          "0.07349685081816656`"],
         Annotation[#, 0.07349685081816656, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 100.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 0.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 50.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 100.}}]}},
          
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {100., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002146248034557168], Opacity[0.37193720518357515`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 0.}}]}},
          "0.042924960691143356`"],
         Annotation[#, 0.042924960691143356`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 50.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 100.}}]}},
          
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 0.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007932783406308557], Opacity[1.2399175109462834`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 50.}}]}},
          
          "0.15865566812617113`"],
         Annotation[#, 0.15865566812617113`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 100.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 0.}}]}},
          
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 50.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 0.}, 12.5]}, InsetBox[
          StyleBox["\<\"1\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 50.}, 12.5]}, InsetBox[
          StyleBox["\<\"2\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 100.}, 12.5]}, InsetBox[
          StyleBox["\<\"3\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 0.}, 12.5]}, InsetBox[
          StyleBox["\<\"4\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 50.}, 12.5]}, InsetBox[
          StyleBox["\<\"5\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 100.}, 12.5]}, InsetBox[
          StyleBox["\<\"6\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 0.}, 12.5]}, InsetBox[
          StyleBox["\<\"7\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 50.}, 12.5]}, InsetBox[
          StyleBox["\<\"8\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 100.}, 12.5]}, InsetBox[
          StyleBox["\<\"9\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 100.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  Background->GrayLevel[1],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->Thickness[Large],
  FrameTicks->None,
  ImagePadding->0,
  ImageSize->250]], "Output",
 CellChangeTimes->{3.7341039299380827`*^9, 3.7341060354218903`*^9, 
  3.734201883837511*^9, 3.734207666470825*^9, 3.73420803480431*^9, 
  3.7343725818339033`*^9, 3.734372839054455*^9, 
  3.734470522028964*^9},ExpressionUUID->"e91b7bfb-0400-470c-8d19-\
e34ade2dc5f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Markov Baseline", "Subsection",
 CellChangeTimes->{{3.7334895415195436`*^9, 3.733489544184792*^9}, {
  3.7341038036329403`*^9, 3.7341038057349*^9}, {3.7341039003132057`*^9, 
  3.7341039024791927`*^9}, {3.734103969825611*^9, 
  3.734103972631535*^9}},ExpressionUUID->"4b38f5f4-de95-4343-abf1-\
dd268ce6c1f3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"baselineMarkovSS", "=", 
    RowBox[{
    "CalculateMarkovSteadyState", "[", "migrationProbabilities", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Visualize", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorsType", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ColorData", "[", 
       RowBox[{"\"\<LakeColors\>\"", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"1", "/", "networkDimension"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stylesSwatchType", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Purple", ",", ".45"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", ".75", "]"}], ",", 
          RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", "networkDimension", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stylesListType", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ToString", "[", "#", "]"}], "\[Rule]", 
       RowBox[{"stylesSwatchType", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"migrationProbabilities", "//", "Length"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"markovBaseline", "=", 
  RowBox[{"GraphPlotWrapper", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"migrationProbabilities", "//", "LowerTriangularize"}], ",", 
      RowBox[{".05", "*", "edgeChopThreshold"}]}], "]"}], ",", ".1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"VertexList", "[", "originalMap", " ", "]"}], "\[Rule]", 
      RowBox[{".25", "*", 
       RowBox[{"Log", "[", 
        RowBox[{".5", "+", 
         RowBox[{"7.5", "*", 
          RowBox[{"Rescale", "[", "baselineMarkovSS", "]"}]}]}], "]"}]}]}], 
     "]"}], ",", "\[IndentingNewLine]", "stylesListType"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7341039776003447`*^9, 
  3.7341039786963997`*^9}},ExpressionUUID->"190880cb-5db9-4dfd-a641-\
c8f839dd193b"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "1", "2", "3", "4", "5", "6", "7", "8", "9"}, {{{2, 1}, {3, 1}, {3, 
       2}, {4, 1}, {4, 2}, {4, 3}, {5, 1}, {5, 2}, {5, 3}, {5, 4}, {6, 1}, {6,
        2}, {6, 3}, {6, 4}, {6, 5}, {7, 1}, {7, 2}, {7, 3}, {7, 4}, {7, 5}, {
       7, 6}, {8, 1}, {8, 2}, {8, 3}, {8, 4}, {8, 5}, {8, 6}, {8, 7}, {9, 
       1}, {9, 2}, {9, 3}, {9, 4}, {9, 5}, {9, 6}, {9, 7}, {9, 8}}, Null}, {
      Background -> GrayLevel[1], 
       EdgeLabels -> {
        DirectedEdge["3", "1"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["4", "3"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["3", "2"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["7", "4"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["8", "2"] -> Placed[0.07349685081816656, Tooltip], 
         DirectedEdge["6", "1"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["6", "3"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["5", "3"] -> Placed[0.10135725709563842`, Tooltip], 
         DirectedEdge["4", "2"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["7", "6"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["9", "8"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["6", "5"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["9", "6"] -> Placed[0.23267217724080452`, Tooltip], 
         DirectedEdge["8", "1"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["2", "1"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["9", "2"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["7", "1"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["5", "2"] -> Placed[0.1486427429043616, Tooltip], 
         DirectedEdge["4", "1"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["6", "2"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["7", "5"] -> Placed[0.15865566812617113`, Tooltip], 
         DirectedEdge["8", "6"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["8", "3"] -> Placed[0.05908777414011252, Tooltip], 
         DirectedEdge["8", "4"] -> Placed[0.1263096972229056, Tooltip], 
         DirectedEdge["9", "4"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["8", "7"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["5", "4"] -> Placed[0.1486427429043616, Tooltip], 
         DirectedEdge["9", "7"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["7", "2"] -> Placed[0.07421924436841902, Tooltip], 
         DirectedEdge["9", "3"] -> Placed[0.09231826398211916, Tooltip], 
         DirectedEdge["9", "1"] -> Placed[0.042924960691143356`, Tooltip], 
         DirectedEdge["5", "1"] -> Placed[0.10135725709563842`, Tooltip], 
         DirectedEdge["8", "5"] -> Placed[0.18523606881859905`, Tooltip], 
         DirectedEdge["7", "3"] -> Placed[0.042924960691143356`, Tooltip], 
         DirectedEdge["6", "4"] -> Placed[0.07349685081816656, Tooltip], 
         DirectedEdge["9", "5"] -> Placed[0.15865566812617113`, Tooltip]}, 
       EdgeShapeFunction -> {$CellContext`edgeshape2}, 
       EdgeStyle -> {DirectedEdge["8", "2"] -> {
           Opacity[0.6012263811362493], 
           Thickness[0.00036748425409083285`]}, DirectedEdge["5", "2"] -> {
           Opacity[1.1648205717827123`], 
           Thickness[0.0007432137145218081]}, DirectedEdge["9", "2"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["7", "3"] -> {
           Opacity[0.37193720518357515`], 
           Thickness[0.0002146248034557168]}, DirectedEdge["9", "7"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "5"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["5", "1"] -> {
           Opacity[0.8101794282172883], 
           Thickness[0.0005067862854781921]}, DirectedEdge["7", "1"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "1"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["7", "4"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["7", "6"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["9", "3"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["9", "5"] -> {
           Opacity[1.2399175109462834`], 
           Thickness[0.0007932783406308557]}, DirectedEdge["5", "3"] -> {
           Opacity[0.8101794282172883], 
           Thickness[0.0005067862854781921]}, DirectedEdge["7", "2"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["9", "6"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["8", "7"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["3", "2"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["2", "1"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["9", "4"] -> {
           Opacity[0.6066443327631428], 
           Thickness[0.0003710962218420951]}, DirectedEdge["8", "6"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["8", "3"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["9", "1"] -> {
           Opacity[0.37193720518357515`], 
           Thickness[0.0002146248034557168]}, DirectedEdge["4", "1"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["3", "1"] -> {
           Opacity[0.7423869798658937], 
           Thickness[0.0004615913199105958]}, DirectedEdge["6", "2"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["4", "3"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}, DirectedEdge["8", "5"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["6", "3"] -> {
           Opacity[1.4392705161394928`], 
           Thickness[0.0009261803440929953]}, DirectedEdge["6", "4"] -> {
           Opacity[0.6012263811362493], 
           Thickness[0.00036748425409083285`]}, DirectedEdge["9", "8"] -> {
           Opacity[1.7950413293060339`], 
           Thickness[0.0011633608862040225`]}, DirectedEdge["5", "4"] -> {
           Opacity[1.1648205717827123`], 
           Thickness[0.0007432137145218081]}, DirectedEdge["4", "2"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["8", "4"] -> {
           Opacity[0.9973227291717921], 
           Thickness[0.0006315484861145281]}, DirectedEdge["7", "5"] -> {
           Opacity[1.2399175109462834`], 
           Thickness[0.0007932783406308557]}, DirectedEdge["8", "1"] -> {
           Opacity[0.49315830605084393`], 
           Thickness[0.0002954388707005626]}}, 
       EdgeWeight -> {0.18523606881859905`, 0.09231826398211916, 
        0.23267217724080452`, 0.18523606881859905`, 0.1263096972229056, 
        0.05908777414011252, 0.10135725709563842`, 0.1486427429043616, 
        0.10135725709563842`, 0.1486427429043616, 0.05908777414011252, 
        0.1263096972229056, 0.18523606881859905`, 0.07349685081816656, 
        0.18523606881859905`, 0.09231826398211916, 0.07421924436841902, 
        0.042924960691143356`, 0.23267217724080452`, 0.15865566812617113`, 
        0.07421924436841902, 0.05908777414011252, 0.07349685081816656, 
        0.05908777414011252, 0.1263096972229056, 0.18523606881859905`, 
        0.1263096972229056, 0.18523606881859905`, 0.042924960691143356`, 
        0.07421924436841902, 0.09231826398211916, 0.07421924436841902, 
        0.15865566812617113`, 0.23267217724080452`, 0.09231826398211916, 
        0.23267217724080452`}, Epilog -> {}, Frame -> False, FrameStyle -> 
       Thickness[Large], GraphLayout -> Automatic, ImagePadding -> 0, 
       ImageSize -> 250, PerformanceGoal -> "Speed", Prolog -> {}, 
       VertexCoordinates -> {{0, 0}, {0, 50}, {0, 100}, {50, 0}, {50, 50}, {
        50, 100}, {100, 0}, {100, 50}, {100, 100}}, VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {0.0001}, 
       VertexSize -> {
        "7" -> -0.17328679513998632`, "2" -> 0.3400826092108158, "8" -> 
         0.3400826092108158, "9" -> -0.17328679513998632`, "6" -> 
         0.34008260921081535`, "5" -> 0.5198603854199589, 
         "3" -> -0.17328679513998632`, "4" -> 0.3400826092108158, 
         "1" -> -0.17328679513998632`}, VertexStyle -> {"5" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "8" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "9" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "7" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "2" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "1" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "4" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "3" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "6" -> Directive[
           Opacity[1], 
           RGBColor[0.725, 0.45, 0.725], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 50.}, {0., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 0.}}]}},
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 50.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 50.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 100.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005067862854781921], Opacity[0.8101794282172883], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 0.}}]}},
          "0.10135725709563842`"],
         Annotation[#, 0.10135725709563842`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007432137145218081], Opacity[1.1648205717827123`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 50.}}]}},
          "0.1486427429043616`"],
         Annotation[#, 0.1486427429043616, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005067862854781921], Opacity[0.8101794282172883], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 100.}}]}},
          "0.10135725709563842`"],
         Annotation[#, 0.10135725709563842`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007432137145218081], Opacity[1.1648205717827123`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {50., 0.}}]}},
          "0.1486427429043616`"],
         Annotation[#, 0.1486427429043616, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 0.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 50.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 100.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00036748425409083285`], Opacity[0.6012263811362493], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 0.}}]}},
          "0.07349685081816656`"],
         Annotation[#, 0.07349685081816656, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 50.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 0.}}]}},
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 50.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002146248034557168], Opacity[0.37193720518357515`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 100.}}]}},
          "0.042924960691143356`"],
         Annotation[#, 0.042924960691143356`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 0.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007932783406308557], Opacity[1.2399175109462834`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 50.}}]}},
          "0.15865566812617113`"],
         Annotation[#, 0.15865566812617113`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 100.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 0.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00036748425409083285`], Opacity[0.6012263811362493], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 50.}}]}},
          "0.07349685081816656`"],
         Annotation[#, 0.07349685081816656, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002954388707005626], Opacity[0.49315830605084393`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 100.}}]}},
          "0.05908777414011252`"],
         Annotation[#, 0.05908777414011252, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 0.}}]}},
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 50.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006315484861145281], Opacity[0.9973227291717921], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 100.}}]}},
          
          "0.1263096972229056`"],
         Annotation[#, 0.1263096972229056, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009261803440929953], Opacity[1.4392705161394928`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {100., 0.}}]}},
          "0.18523606881859905`"],
         Annotation[#, 0.18523606881859905`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0002146248034557168], Opacity[0.37193720518357515`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 0.}}]}},
          "0.042924960691143356`"],
         Annotation[#, 0.042924960691143356`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 50.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 100.}}]}},
          
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003710962218420951], Opacity[0.6066443327631428], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 0.}}]}},
          "0.07421924436841902`"],
         Annotation[#, 0.07421924436841902, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007932783406308557], Opacity[1.2399175109462834`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 50.}}]}},
          
          "0.15865566812617113`"],
         Annotation[#, 0.15865566812617113`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 100.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004615913199105958], Opacity[0.7423869798658937], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 0.}}]}},
          
          "0.09231826398211916`"],
         Annotation[#, 0.09231826398211916, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011633608862040225`], Opacity[1.7950413293060339`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 50.}}]}},
          "0.23267217724080452`"],
         Annotation[#, 0.23267217724080452`, "Tooltip"]& ]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 0.}, 0.1324098504837291]}, InsetBox[
          StyleBox["\<\"1\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 50.}, 8.502065230270395]}, InsetBox[
          StyleBox["\<\"2\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{0., 100.}, 0.1324098504837291]}, 
         InsetBox[
          StyleBox["\<\"3\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 0.}, 8.502065230270395]}, InsetBox[
          StyleBox["\<\"4\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 50.}, 12.996509635498974]}, 
         InsetBox[
          StyleBox["\<\"5\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{50., 100.}, 8.502065230270384]}, 
         InsetBox[
          StyleBox["\<\"6\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 0.}, 0.1324098504837291]}, 
         InsetBox[
          StyleBox["\<\"7\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 50.}, 8.502065230270395]}, 
         InsetBox[
          StyleBox["\<\"8\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.725, 0.45, 0.725], Opacity[1], EdgeForm[{Opacity[0.75], 
          Thickness[0.005]}], DiskBox[{100., 100.}, 0.1324098504837291]}, 
         InsetBox[
          StyleBox["\<\"9\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 100.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  Background->GrayLevel[1],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->Thickness[Large],
  FrameTicks->None,
  ImagePadding->0,
  ImageSize->250]], "Output",
 CellChangeTimes->{3.7341039794936533`*^9, 3.734106044406515*^9, 
  3.734201884715021*^9, 3.7342076673756943`*^9, 3.7342080357436438`*^9, 
  3.7343725829925203`*^9, 3.734372839911072*^9, 
  3.734470524198848*^9},ExpressionUUID->"daa01908-1736-44cc-8881-\
f6fcd44cd318"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Network Dimensionality (aka n-partite-ness)", "Subsection",
 CellChangeTimes->{{3.7334895415195436`*^9, 3.733489544184792*^9}, {
  3.7341038036329403`*^9, 3.7341038057349*^9}, {3.7341039003132057`*^9, 
  3.7341039024791927`*^9}, {3.734103969825611*^9, 
  3.734104006535654*^9}},ExpressionUUID->"17fef265-a841-4939-b2bb-\
4823b6a08504"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Vector", " ", "of", " ", "node", " ", "types"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"nodeType", "=", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"Range", "[", "networkDimension", "]"}], ",", 
      RowBox[{"sampledCoordinates", "//", "Length"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"dimensionalPenalizationsMask", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"penalizationsMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "#"}], "]"}], "]"}], "&"}], "/@", "nodeType"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nodeType"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Very", " ", "elegant", " ", "way", " ", "of", " ", "generating", " ", 
       "full", " ", "matrix", " ", "of", " ", "how", " ", 
       RowBox[{"we", "'"}], "re", " ", "re"}], "-", 
      RowBox[{
      "weighting", " ", "all", " ", "edges", " ", "according", " ", "to", " ",
        "the", " ", "movement", " ", 
       RowBox[{"Kernel", ".", "  ", "This"}], " ", "includes", " ", "both", 
       " ", "the", " ", "multitype", " ", "transition", " ", "Penalization", 
       " ", "Mask", " ", "and", " ", "the", " ", "baseline", " ", "Markov", 
       " ", "connectivity"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"migrationDimensionalMatrix", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/", 
         RowBox[{"Total", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
       "dimensionalPenalizationsMask", "*", "migrationProbabilities"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matrixPenalizationsPlot", "=", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", "dimensionalPenalizationsMask"}], ",", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<LakeMatrixPlot\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matrixDimensionalPlot", "=", 
     RowBox[{"MatrixPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", "migrationDimensionalMatrix"}], ",", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<LakeMatrixPlot\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"matrixPenalizationsPlot", ",", "matrixDimensionalPlot"}], 
      "}"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.7334961130679207`*^9, {3.73349618488966*^9, 3.7334962145754957`*^9}, 
   3.733496284673765*^9, {3.7334963445994797`*^9, 3.733496355095358*^9}, {
   3.7334964397030993`*^9, 3.733496573195249*^9}, {3.733496957269012*^9, 
   3.73349699706815*^9}, {3.733498674655448*^9, 3.733498689207314*^9}, {
   3.733498791216434*^9, 3.733498799928874*^9}, 3.733498836007331*^9, {
   3.7335043367363443`*^9, 3.733504386999243*^9}, {3.733586383251542*^9, 
   3.7335863838853188`*^9}, {3.7337571158239*^9, 3.733757116855465*^9}, {
   3.733766431976995*^9, 3.733766459394134*^9}, {3.7341040362465467`*^9, 
   3.73410405959284*^9}, {3.734104557980364*^9, 3.734104606034333*^9}, {
   3.734104643013064*^9, 3.734104666838574*^9}, {3.734106055467239*^9, 
   3.734106061857123*^9}, {3.734106117013823*^9, 3.734106118032999*^9}, 
   3.734106244428914*^9, {3.7348115235270233`*^9, 
   3.734811524110642*^9}},ExpressionUUID->"30825443-0650-4127-8ca5-\
f6ed12d07464"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", 
   ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.734104016774036*^9, 3.734104037276719*^9}, {
   3.734104586282093*^9, 3.734104606349337*^9}, {3.73410464467035*^9, 
   3.734104671140977*^9}, 3.734105396622241*^9, 3.734106062743919*^9, 
   3.73410611870089*^9, 3.734106181018381*^9, 3.7341062119582043`*^9, {
   3.734106255194704*^9, 3.7341062693159227`*^9}, 3.734201886951111*^9, 
   3.734207668722144*^9, 3.734208036649472*^9, 3.734372584184003*^9, 
   3.73437284097583*^9, 
   3.734470525343676*^9},ExpressionUUID->"8e5d096c-2ba3-4151-825b-\
e94bfb5f5b5f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQe2N29W5Vy6f2M1ZtOWr676n9y1SR07q6b+0HSrzs
Ifvz4OOX7GOZvDllUtba72pxzv/44QHJ4oPNPYPNX4MtfAabewabvwZb+Iz6
a9Rfw8lfg63cAAA99taw
       "], {{0, 0}, {9, 9}}, {0, 1}],
      AspectRatio->1,
      AxesStyle->Directive[
        GrayLevel[0.5], 
        Opacity[0.5], 
        Dashing[{Small, Small}]],
      Frame->True,
      FrameLabel->{None, None},
      FrameStyle->Directive[
        GrayLevel[0.5], 
        Thickness[Large]],
      FrameTicks->{{False, False}, {False, False}},
      ImageSize->250,
      Method->{},
      PlotRangePadding->0], 
     GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQe2N29W5Vy6f2M1ZtOWr676n9y1SR07q6b+0HSjxl
eSXvpD2P7T3mOHrsmvXYfuYu8XsNKm/t7Vgj8qoZr9trSdxeqc1zzD7tO59i
3cvHOMWp5Z70HXY+GZJP7C/+D5N6ov/EvjgvctE8tbf2wSVRTXNzHtsv+6Hy
zUnqsX0No67bOqW39sY/5V6zxD6y/5G4ZdHD1If2NxZlBNfKvLV3FWJJsbJ+
YH8xY8Gl+vLb9q/PfZzxq+8VyeKDLb5qXma8ij720L534omgY1kP7BtfvVRK
2vXG/hXbcpe7y+/br+q4e9NL4Jb9Bhb/jSf+vrQve8j+PPj4JftYJm9OmZS1
9rtanPM/fngwGl90Ep/k80JFIeeevUF9A4f/6+v2vpeXKzyUf2lvdZEvVGre
Tfs5qzhvuiietw88Np8rY/9TnOKDzV/O8bunzvn/wF5ltZFgltI9++sBvEKs
i1/bL3uqWO0Rdtv+8KkPb/70XrL/HrOS/+iXZ/beTxz6WI5ctf8W3HjbeM9B
+1M7tkskcFGv3Biu+Wu4xpfEXYknS7qf2L9I9pEveP7EfoZco4el5lv7g4ZF
9xYzPbZv52cS/5v/yF7rjNk1ZwXc4qWzlaa8y3hoLxWTp79ywn171XtLsvnN
39j3rl+TGu1+1/7TzfnTnN9dtZ8hOClKLugFTnEAh6Hskg==
       "], {{0, 0}, {9, 
       9}}, {0, 1}],
      AspectRatio->1,
      AxesStyle->Directive[
        GrayLevel[0.5], 
        Opacity[0.5], 
        Dashing[{Small, Small}]],
      Frame->True,
      FrameLabel->{None, None},
      FrameStyle->Directive[
        GrayLevel[0.5], 
        Thickness[Large]],
      FrameTicks->{{False, False}, {False, False}},
      ImageSize->250,
      Method->{},
      PlotRangePadding->0]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.734104016774036*^9, 3.734104037276719*^9}, {
   3.734104586282093*^9, 3.734104606349337*^9}, {3.73410464467035*^9, 
   3.734104671140977*^9}, 3.734105396622241*^9, 3.734106062743919*^9, 
   3.73410611870089*^9, 3.734106181018381*^9, 3.7341062119582043`*^9, {
   3.734106255194704*^9, 3.7341062693159227`*^9}, 3.734201886951111*^9, 
   3.734207668722144*^9, 3.734208036649472*^9, 3.734372584184003*^9, 
   3.73437284097583*^9, 
   3.734470525363624*^9},ExpressionUUID->"3fc675f5-a3fb-4fa9-bbf1-\
d300c3231637"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synthesizing : Markov Dimensional Network", "Section",
 CellChangeTimes->{{3.734104689042914*^9, 
  3.734104704171797*^9}},ExpressionUUID->"be222b10-4087-496d-a6f2-\
5aca1e2ab1c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculate", " ", "the", " ", "steady", " ", "state", " ", "for", " ", 
    "our", " ", "transitions", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"markovPDF", "=", 
     RowBox[{
     "CalculateMarkovSteadyState", "[", "migrationDimensionalMatrix", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Show", " ", "the", " ", "Markov", " ", "transition", " ", "matrix"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "migrationDimensionalMatrix", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Visualization", ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "1.", " ", "Node", " ", "type", " ", "is", " ", "represented", " ", "by",
       " ", 
      RowBox[{"color", ".", "\[IndentingNewLine]", "2."}], " ", "Frequency", 
      " ", "of", " ", "visit", " ", "in", " ", "markov", " ", "steady", " ", 
      "state", " ", "represented", " ", "by", " ", "node", " ", 
      RowBox[{"diameter", ".", " ", "\[IndentingNewLine]", "3."}], " ", 
      "Probability", " ", "of", " ", "transition", " ", "represented", " ", 
      "by", " ", "edge", " ", "thickness"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colorsType", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<LakeColors\>\"", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "1", ",", 
         RowBox[{"1", "/", "networkDimension"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesSwatchType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"colorsType", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", ".75", "]"}], ",", 
            RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", "networkDimension", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesListType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"stylesSwatchType", "[", 
          RowBox[{"[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"nodeType", "//", "Length"}], "]"}], ",", "nodeType"}], 
        "}"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"markovDimensional", "=", 
    RowBox[{"GraphPlotWrapper", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"migrationDimensionalMatrix", "//", "LowerTriangularize"}], 
        ",", "edgeChopThreshold"}], "]"}], ",", ".1", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"VertexList", "[", "originalMap", " ", "]"}], "\[Rule]", 
        RowBox[{".25", "*", 
         RowBox[{"Log", "[", 
          RowBox[{"5", "+", 
           RowBox[{"7.5", "*", 
            RowBox[{"Rescale", "[", "markovPDF", "]"}]}]}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", "stylesListType"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.733498486627488*^9, 3.733498494997241*^9}, {
   3.7334987487321863`*^9, 3.7334987582075443`*^9}, {3.733498917701419*^9, 
   3.733498942236116*^9}, {3.733498991909058*^9, 3.733499004891054*^9}, {
   3.7334990582690153`*^9, 3.73349906096111*^9}, {3.733499342167316*^9, 
   3.733499342985183*^9}, {3.733499443736457*^9, 3.733499448034316*^9}, {
   3.73349951409383*^9, 3.733499541320364*^9}, {3.733499836693687*^9, 
   3.733499837579356*^9}, 3.733501111072702*^9, {3.73350134599368*^9, 
   3.7335013486588573`*^9}, {3.733503972885684*^9, 3.733504016117463*^9}, 
   3.733505214436618*^9, 3.733505440712426*^9, 3.733508173445731*^9, {
   3.733508240460166*^9, 3.73350824112393*^9}, {3.733509084360868*^9, 
   3.733509084915216*^9}, {3.733509123299161*^9, 3.7335091484120703`*^9}, 
   3.7335128350402117`*^9, {3.7335863781197977`*^9, 3.733586379182414*^9}, {
   3.733595900122507*^9, 3.7335959016098213`*^9}, 3.73376566610367*^9, {
   3.733767394934273*^9, 3.733767408554557*^9}, {3.734104713021542*^9, 
   3.734104732443246*^9}, {3.7341051186689043`*^9, 3.7341052137249393`*^9}, {
   3.7341052987590714`*^9, 3.734105358013435*^9}, {3.734105494939703*^9, 
   3.73410549559128*^9}, {3.7341055810478277`*^9, 3.7341055812232656`*^9}, {
   3.734106136149621*^9, 
   3.734106139508335*^9}},ExpressionUUID->"42662eb5-7a47-4f2a-b71d-\
9b3e34330a6b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.273230029966562`", "0.10841056431164799`", 
      "0.273230029966562`", "0.1863114596276546`", "0.`", 
      "0.10841056431164799`", "0.`", "0.05040735181592544`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.3280408237744218`", "0.`", "0.19087978213318785`", "0.`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.582831994409532`", "0.`", "0.18591544004870342`", "0.`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.19087978213318785`", "0.`", "0.3280408237744218`", "0.`"},
     {"0.2542558691955294`", "0.`", "0.`", "0.`", "0.`", 
      "0.37287206540223533`", "0.`", "0.37287206540223533`", "0.`"},
     {"0.`", "0.15505684402214034`", "0.2273944191267633`", 
      "0.09022418693094873`", "0.2273944191267633`", "0.`", 
      "0.07253571166662104`", "0.`", "0.2273944191267633`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.18591544004870342`", "0.`", "0.582831994409532`", "0.`"},
     {"0.`", "0.09022418693094873`", "0.07253571166662104`", 
      "0.15505684402214034`", "0.2273944191267633`", "0.`", 
      "0.2273944191267633`", "0.`", "0.2273944191267633`"},
     {"0.08445318143306342`", "0.`", "0.`", "0.`", "0.`", 
      "0.45777340928346827`", "0.`", "0.45777340928346827`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734104710743724*^9, 3.7341052141076517`*^9, 3.734105257626121*^9, {
   3.7341053389476852`*^9, 3.734105358601022*^9}, 3.734105398211453*^9, 
   3.7341054959826107`*^9, 3.734105581472834*^9, 3.734106070603263*^9, {
   3.734106121078776*^9, 3.734106137484449*^9}, {3.7341061706418133`*^9, 
   3.73410618230676*^9}, 3.734106214561035*^9, {3.7341062569720697`*^9, 
   3.734106270904004*^9}, 3.734201894467988*^9, 3.734207831640218*^9, 
   3.7342080373950787`*^9, 3.73437258594319*^9, 3.7343728423501587`*^9, 
   3.734470527901113*^9, 
   3.7344713476202393`*^9},ExpressionUUID->"46845ecb-9dd1-42c2-8015-\
0d8e938e0f3b"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "1", "2", "3", "4", "5", "6", "7", "8", "9"}, {{{2, 1}, {3, 1}, {4, 
       1}, {5, 1}, {6, 2}, {6, 3}, {6, 4}, {6, 5}, {7, 1}, {7, 6}, {8, 2}, {8,
        3}, {8, 4}, {8, 5}, {8, 7}, {9, 1}, {9, 6}, {9, 8}}, Null}, {
      Background -> GrayLevel[1], 
       EdgeLabels -> {
        DirectedEdge["5", "1"] -> Placed[0.2542558691955294, Tooltip], 
         DirectedEdge["6", "3"] -> Placed[0.2273944191267633, Tooltip], 
         DirectedEdge["4", "1"] -> Placed[0.48107939409239037`, Tooltip], 
         DirectedEdge["8", "7"] -> Placed[0.2273944191267633, Tooltip], 
         DirectedEdge["6", "5"] -> Placed[0.2273944191267633, Tooltip], 
         DirectedEdge["8", "3"] -> Placed[0.07253571166662104, Tooltip], 
         DirectedEdge["7", "6"] -> Placed[0.18591544004870342`, Tooltip], 
         DirectedEdge["8", "2"] -> Placed[0.09022418693094873, Tooltip], 
         DirectedEdge["9", "8"] -> Placed[0.45777340928346827`, Tooltip], 
         DirectedEdge["7", "1"] -> Placed[0.23125256554176443`, Tooltip], 
         DirectedEdge["6", "4"] -> Placed[0.09022418693094873, Tooltip], 
         DirectedEdge["9", "1"] -> Placed[0.08445318143306342, Tooltip], 
         DirectedEdge["6", "2"] -> Placed[0.15505684402214034`, Tooltip], 
         DirectedEdge["8", "4"] -> Placed[0.15505684402214034`, Tooltip], 
         DirectedEdge["3", "1"] -> Placed[0.23125256554176443`, Tooltip], 
         DirectedEdge["2", "1"] -> Placed[0.48107939409239037`, Tooltip], 
         DirectedEdge["8", "5"] -> Placed[0.2273944191267633, Tooltip], 
         DirectedEdge["9", "6"] -> Placed[0.45777340928346827`, Tooltip]}, 
       EdgeShapeFunction -> {$CellContext`edgeshape2}, 
       EdgeStyle -> {DirectedEdge["4", "1"] -> {
           Opacity[3.6580954556929273`], 
           Thickness[0.002405396970461952]}, DirectedEdge["2", "1"] -> {
           Opacity[3.6580954556929273`], 
           Thickness[0.002405396970461952]}, DirectedEdge["9", "8"] -> {
           Opacity[3.483300569626012], 
           Thickness[0.0022888670464173413`]}, DirectedEdge["8", "2"] -> {
           Opacity[0.7266814019821155], 
           Thickness[0.0004511209346547437]}, DirectedEdge["5", "1"] -> {
           Opacity[1.9569190189664705`], 
           Thickness[0.001271279345977647]}, DirectedEdge["6", "5"] -> {
           Opacity[1.7554581434507248`], 
           Thickness[0.0011369720956338166`]}, DirectedEdge["7", "6"] -> {
           Opacity[1.4443658003652757`], 
           Thickness[0.0009295772002435171]}, DirectedEdge["7", "1"] -> {
           Opacity[1.7843942415632335`], 
           Thickness[0.0011562628277088224`]}, DirectedEdge["8", "5"] -> {
           Opacity[1.7554581434507248`], 
           Thickness[0.0011369720956338166`]}, DirectedEdge["9", "6"] -> {
           Opacity[3.483300569626012], 
           Thickness[0.0022888670464173413`]}, DirectedEdge["6", "2"] -> {
           Opacity[1.2129263301660527`], 
           Thickness[0.0007752842201107018]}, DirectedEdge["8", "3"] -> {
           Opacity[0.5940178374996579], 
           Thickness[0.0003626785583331052]}, DirectedEdge["9", "1"] -> {
           Opacity[0.6833988607479757], 
           Thickness[0.0004222659071653171]}, DirectedEdge["8", "7"] -> {
           Opacity[1.7554581434507248`], 
           Thickness[0.0011369720956338166`]}, DirectedEdge["3", "1"] -> {
           Opacity[1.7843942415632335`], 
           Thickness[0.0011562628277088224`]}, DirectedEdge["6", "3"] -> {
           Opacity[1.7554581434507248`], 
           Thickness[0.0011369720956338166`]}, DirectedEdge["8", "4"] -> {
           Opacity[1.2129263301660527`], 
           Thickness[0.0007752842201107018]}, DirectedEdge["6", "4"] -> {
           Opacity[0.7266814019821155], 
           Thickness[0.0004511209346547437]}}, 
       EdgeWeight -> {0.48107939409239037`, 0.23125256554176443`, 
        0.48107939409239037`, 0.2542558691955294, 0.15505684402214034`, 
        0.2273944191267633, 0.09022418693094873, 0.2273944191267633, 
        0.23125256554176443`, 0.18591544004870342`, 0.09022418693094873, 
        0.07253571166662104, 0.15505684402214034`, 0.2273944191267633, 
        0.2273944191267633, 0.08445318143306342, 0.45777340928346827`, 
        0.45777340928346827`}, Epilog -> {}, Frame -> False, FrameStyle -> 
       Thickness[Large], GraphLayout -> Automatic, ImagePadding -> 0, 
       ImageSize -> 250, PerformanceGoal -> "Speed", Prolog -> {}, 
       VertexCoordinates -> {{0, 0}, {0, 50}, {0, 100}, {50, 0}, {50, 50}, {
        50, 100}, {100, 0}, {100, 50}, {100, 100}}, VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {0.0001}, 
       VertexSize -> {
        "4" -> 0.4485583028219154, "7" -> 0.40235947810852507`, "3" -> 
         0.40235947810852507`, "8" -> 0.6314321610770639, "5" -> 
         0.5103637388853087, "9" -> 0.46056612023610133`, "2" -> 
         0.44855830282191567`, "6" -> 0.6314321610770639, "1" -> 
         0.5863373987377415}, VertexStyle -> {"5" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "6" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "1" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "4" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "9" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "7" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "8" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "3" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "2" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        TagBox[
         TooltipBox[
          {Thickness[0.002405396970461952], Opacity[3.6580954556929273`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 50.}, {0., 0.}}]}},
          "0.48107939409239037`"],
         Annotation[#, 0.48107939409239037`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011562628277088224`], Opacity[1.7843942415632335`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 0.}}]}},
          "0.23125256554176443`"],
         Annotation[#, 0.23125256554176443`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.002405396970461952], Opacity[3.6580954556929273`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 0.}}]}},
          "0.48107939409239037`"],
         Annotation[#, 0.48107939409239037`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.001271279345977647], Opacity[1.9569190189664705`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 0.}}]}},
          "0.2542558691955294`"],
         Annotation[#, 0.2542558691955294, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007752842201107018], Opacity[1.2129263301660527`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 50.}}]}},
          "0.15505684402214034`"],
         Annotation[#, 0.15505684402214034`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011369720956338166`], Opacity[1.7554581434507248`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {0., 100.}}]}},
          "0.2273944191267633`"],
         Annotation[#, 0.2273944191267633, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004511209346547437], Opacity[0.7266814019821155], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 0.}}]}},
          "0.09022418693094873`"],
         Annotation[#, 0.09022418693094873, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011369720956338166`], Opacity[1.7554581434507248`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 100.}, {50., 50.}}]}},
          "0.2273944191267633`"],
         Annotation[#, 0.2273944191267633, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011562628277088224`], Opacity[1.7843942415632335`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 0.}}]}},
          "0.23125256554176443`"],
         Annotation[#, 0.23125256554176443`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0009295772002435171], Opacity[1.4443658003652757`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 100.}}]}},
          "0.18591544004870342`"],
         Annotation[#, 0.18591544004870342`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004511209346547437], Opacity[0.7266814019821155], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 50.}}]}},
          "0.09022418693094873`"],
         Annotation[#, 0.09022418693094873, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0003626785583331052], Opacity[0.5940178374996579], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {0., 100.}}]}},
          "0.07253571166662104`"],
         Annotation[#, 0.07253571166662104, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007752842201107018], Opacity[1.2129263301660527`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 0.}}]}},
          "0.15505684402214034`"],
         Annotation[#, 0.15505684402214034`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011369720956338166`], Opacity[1.7554581434507248`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {50., 50.}}]}},
          "0.2273944191267633`"],
         Annotation[#, 0.2273944191267633, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0011369720956338166`], Opacity[1.7554581434507248`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 50.}, {100., 0.}}]}},
          "0.2273944191267633`"],
         Annotation[#, 0.2273944191267633, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004222659071653171], Opacity[0.6833988607479757], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 0.}}]}},
          "0.08445318143306342`"],
         Annotation[#, 0.08445318143306342, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0022888670464173413`], Opacity[3.483300569626012], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 100.}}]}},
          "0.45777340928346827`"],
         Annotation[#, 0.45777340928346827`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0022888670464173413`], Opacity[3.483300569626012], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 50.}}]}},
          "0.45777340928346827`"],
         Annotation[#, 0.45777340928346827`, "Tooltip"]& ]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 0.}, 14.658434968443537]}, InsetBox[
          StyleBox["\<\"1\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 50.}, 11.213957570547892]}, InsetBox[
          StyleBox["\<\"2\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 100.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"3\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 0.}, 11.213957570547885]}, InsetBox[
          StyleBox["\<\"4\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 50.}, 12.759093472132719]}, InsetBox[
          StyleBox["\<\"5\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 100.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"6\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 0.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"7\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 50.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"8\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 100.}, 11.514153005902534]}, InsetBox[
          StyleBox["\<\"9\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 100.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  Background->GrayLevel[1],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->Thickness[Large],
  FrameTicks->None,
  ImagePadding->0,
  ImageSize->250]], "Output",
 CellChangeTimes->{
  3.734104710743724*^9, 3.7341052141076517`*^9, 3.734105257626121*^9, {
   3.7341053389476852`*^9, 3.734105358601022*^9}, 3.734105398211453*^9, 
   3.7341054959826107`*^9, 3.734105581472834*^9, 3.734106070603263*^9, {
   3.734106121078776*^9, 3.734106137484449*^9}, {3.7341061706418133`*^9, 
   3.73410618230676*^9}, 3.734106214561035*^9, {3.7341062569720697`*^9, 
   3.734106270904004*^9}, 3.734201894467988*^9, 3.734207831640218*^9, 
   3.7342080373950787`*^9, 3.73437258594319*^9, 3.7343728423501587`*^9, 
   3.734470527901113*^9, 
   3.734471347728351*^9},ExpressionUUID->"24d04717-0f0b-4b7e-8673-\
182fdf9e33d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ensembles of Trajectories", "Section",
 CellChangeTimes->{{3.734104689042914*^9, 3.734104704171797*^9}, {
  3.734106422226452*^9, 
  3.734106425216176*^9}},ExpressionUUID->"de8adcce-c0c9-4105-bae1-\
522bec16baac"],

Cell[CellGroupData[{

Cell["Adding in Mosquito Death Transitions", "Subsection",
 CellChangeTimes->{{3.734106583298367*^9, 
  3.734106603888835*^9}},ExpressionUUID->"43f047e4-89ba-49c9-b8d5-\
6e6452bf6610"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "migrationDimensionalMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.734106449548587*^9, 
  3.7341064852897797`*^9}},ExpressionUUID->"96d38dd7-bd59-4d9c-a51b-\
fd0da5df063b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.273230029966562`", "0.10841056431164799`", 
      "0.273230029966562`", "0.1863114596276546`", "0.`", 
      "0.10841056431164799`", "0.`", "0.05040735181592544`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.3280408237744218`", "0.`", "0.19087978213318785`", "0.`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.582831994409532`", "0.`", "0.18591544004870342`", "0.`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.19087978213318785`", "0.`", "0.3280408237744218`", "0.`"},
     {"0.2542558691955294`", "0.`", "0.`", "0.`", "0.`", 
      "0.37287206540223533`", "0.`", "0.37287206540223533`", "0.`"},
     {"0.`", "0.15505684402214034`", "0.2273944191267633`", 
      "0.09022418693094873`", "0.2273944191267633`", "0.`", 
      "0.07253571166662104`", "0.`", "0.2273944191267633`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.18591544004870342`", "0.`", "0.582831994409532`", "0.`"},
     {"0.`", "0.09022418693094873`", "0.07253571166662104`", 
      "0.15505684402214034`", "0.2273944191267633`", "0.`", 
      "0.2273944191267633`", "0.`", "0.2273944191267633`"},
     {"0.08445318143306342`", "0.`", "0.`", "0.`", "0.`", 
      "0.45777340928346827`", "0.`", "0.45777340928346827`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734201906852261*^9, 3.7342076706520643`*^9, 
  3.7342080412258177`*^9, 3.734372590080538*^9, 3.734372846437299*^9, 
  3.7344705392634706`*^9},ExpressionUUID->"10367d3e-47e2-4df4-a5b7-\
601b72f8c0a1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mosHazardRates", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{".1", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "sampledCoordinates", "]"}]}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.73410649327499*^9, 3.734106508160863*^9}, 
   3.734107901076932*^9},ExpressionUUID->"4e9faa9b-8179-491a-85a2-\
e63fcbac012e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mosMatrix", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"migrationDimensionalMatrix", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"mosHazardRates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mosHazardRates", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", "1.", "}"}]}], "]"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.734106524396489*^9, 
  3.7341065435775623`*^9}},ExpressionUUID->"9d8d0291-c077-4179-a8a8-\
bf453a1577b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "mosMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.734106547762836*^9, 
  3.734106551234898*^9}},ExpressionUUID->"bc49d8c1-74fd-4e7d-9371-\
d39aa6a0864a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.2459070269699058`", "0.09756950788048319`", 
      "0.2459070269699058`", "0.16768031366488914`", "0.`", 
      "0.09756950788048319`", "0.`", "0.0453666166343329`", "0.1`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.29523674139697964`", "0.`", "0.17179180391986906`", "0.`", "0.1`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", "0.5245487949685789`",
       "0.`", "0.16732389604383308`", "0.`", "0.1`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.17179180391986906`", "0.`", "0.29523674139697964`", "0.`", "0.1`"},
     {"0.22883028227597646`", "0.`", "0.`", "0.`", "0.`", 
      "0.3355848588620118`", "0.`", "0.3355848588620118`", "0.`", "0.1`"},
     {"0.`", "0.1395511596199263`", "0.20465497721408699`", 
      "0.08120176823785386`", "0.20465497721408699`", "0.`", 
      "0.06528214049995894`", "0.`", "0.20465497721408699`", "0.1`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", 
      "0.16732389604383308`", "0.`", "0.5245487949685789`", "0.`", "0.1`"},
     {"0.`", "0.08120176823785386`", "0.06528214049995894`", 
      "0.1395511596199263`", "0.20465497721408699`", "0.`", 
      "0.20465497721408699`", "0.`", "0.20465497721408699`", "0.1`"},
     {"0.07600786328975707`", "0.`", "0.`", "0.`", "0.`", 
      "0.4119960683551214`", "0.`", "0.4119960683551214`", "0.`", "0.1`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734106551651124*^9, 3.7342019667164183`*^9, 
  3.734207678954513*^9, 3.734208046814097*^9, 3.734372600077927*^9, 
  3.734372852348238*^9, 
  3.734470543437133*^9},ExpressionUUID->"1efbdf6d-4e43-4ea5-beb8-\
21387da32c1e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examining a Single Trajectory", "Subsection",
 CellChangeTimes->{{3.734106583298367*^9, 3.734106603888835*^9}, {
  3.7341077694989634`*^9, 
  3.734107782765037*^9}},ExpressionUUID->"f380ba4f-7168-41b4-9025-\
e3b4a9d0f3a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Start", " ", "by", " ", "generating", " ", "an", " ", "ensemble"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"init", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "mosMatrix", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"init", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", "1"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
       "1", ",", "1"}], "}"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"P", " ", "=", " ", 
     RowBox[{"DiscreteMarkovProcess", "[", 
      RowBox[{"init", ",", "mosMatrix"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RandomSeed", "[", "1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mosEnsemble", " ", "=", " ", 
     RowBox[{"RandomFunction", "[", 
      RowBox[{"P", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "100"}], "}"}], ",", "10"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7341198857064753`*^9, 3.7341198858094587`*^9}, {
   3.7341199713785343`*^9, 3.734119976536685*^9}, {3.734200784450489*^9, 
   3.734200784670923*^9}, {3.734201994215094*^9, 3.734202011298759*^9}, 
   3.734207735626031*^9, {3.734372614805664*^9, 
   3.734372615724083*^9}},ExpressionUUID->"b5665fc3-baaf-4d91-992b-\
b80acb8b963d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "the", " ", "Entomological", " ", "Incubation", " ", 
    "Period"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EIP", " ", "=", " ", "10"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.734119921941354*^9, 3.73411992545394*^9}, {
  3.734120122942436*^9, 
  3.734120123145033*^9}},ExpressionUUID->"8c99bde9-47ab-4825-a8a5-\
168cc9590139"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Select", " ", "a", " ", "chain"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"chainIndex", " ", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mosChain", " ", "=", " ", 
     RowBox[{
      RowBox[{"mosEnsemble", "[", "\"\<Paths\>\"", "]"}], "[", 
      RowBox[{"[", "chainIndex", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Restrict", " ", "to", " ", "only", " ", "time", " ", "steps", " ", 
     "where", " ", "the", " ", "mosquitoes", " ", "are", " ", "not", " ", 
     "dead"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"mosChain", " ", "=", " ", 
    RowBox[{"Cases", "[", 
     RowBox[{"mosChain", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "a_"}], "}"}], "/;", 
       RowBox[{"a", "<", 
        RowBox[{"Length", "[", "mosMatrix", "]"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Time", " ", "of", " ", "death"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"tDeath", " ", "=", " ", 
    RowBox[{"Length", "[", "mosChain", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.734119988638401*^9, 3.734120010392911*^9}, 
   3.734200796956482*^9, {3.734207696826509*^9, 3.734207752046315*^9}, {
   3.7342077872578487`*^9, 3.734207809286502*^9}, {3.7342079631120768`*^9, 
   3.7342079828346863`*^9}, {3.734208068139407*^9, 3.734208089826301*^9}, {
   3.7343726083624077`*^9, 
   3.734372621241091*^9}},ExpressionUUID->"fd591928-944a-4818-92eb-\
1894c10988cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.734119996396262*^9, 3.734120026473138*^9}, {
  3.734200791439087*^9, 3.7342007973299932`*^9}, {3.734201975044327*^9, 
  3.7342020137212543`*^9}, {3.7342076866976023`*^9, 3.734207752468851*^9}, {
  3.734207791304659*^9, 3.734207809976779*^9}, {3.734207967876072*^9, 
  3.734207983276992*^9}, {3.7342080662287827`*^9, 3.734208090032901*^9}, {
  3.73437260550209*^9, 
  3.734372621527728*^9}},ExpressionUUID->"5900e9a5-824c-4783-b10b-\
fd3b831c913e"],

Cell[BoxData["19"], "Output",
 CellChangeTimes->{{3.734119996396262*^9, 3.734120026473138*^9}, {
  3.734200791439087*^9, 3.7342007973299932`*^9}, {3.734201975044327*^9, 
  3.7342020137212543`*^9}, {3.7342076866976023`*^9, 3.734207752468851*^9}, {
  3.734207791304659*^9, 3.734207809976779*^9}, {3.734207967876072*^9, 
  3.734207983276992*^9}, {3.7342080662287827`*^9, 3.734208090032901*^9}, {
  3.73437260550209*^9, 
  3.7343726215451803`*^9}},ExpressionUUID->"1c0be45d-b58a-4f2b-832c-\
2163dff45244"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Look", " ", "at", " ", "the", " ", "node", " ", "type", " ", "at", " ", 
     "each", " ", "place", " ", "visited"}], ",", " ", 
    RowBox[{"just", " ", "to", " ", "verify", " ", 
     RowBox[{"we", "'"}], "re", " ", "alternating"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pathNodeTypes", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"nodeType", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"nodeType", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"mosChain", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Add", " ", "the", " ", "type", " ", "visited", " ", "to", " ", "each", 
     " ", "row", " ", "of", " ", "the", " ", "mosChain", " ", "matrix"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mosChain", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "mosChain", "]"}], ",", 
        RowBox[{"{", "pathNodeTypes", "}"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.734119944874427*^9, 3.734119979968487*^9}, {
  3.7341200149048758`*^9, 
  3.734120023968832*^9}},ExpressionUUID->"f034ee40-8a2f-409f-b7b0-\
c0b1f8857960"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "all", " ", "of", " ", "the", " ", "indexes", 
    " ", "of", " ", "the", " ", "relevant", " ", "starting", " ", "positions",
     "\[IndentingNewLine]", "\"\<Relevant\>\"", " ", "here", " ", "means", 
    " ", "that", " ", "they", " ", "occur", " ", "early", " ", "enough", " ", 
    "that", " ", "the", " ", "mosquitoes", " ", "do", " ", "not", " ", "die", 
    " ", "before", " ", "the", " ", "end", " ", "of", " ", "the", " ", 
    "EIP"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"tIndexes", " ", "=", "  ", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"mosChain", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"tDeath", "-", "EIP"}], ",", "1"}], "]"}]}], "]"}], "]"}], 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}]}]], "Input",
 CellChangeTimes->{{3.73412004881056*^9, 
  3.7341200917131443`*^9}},ExpressionUUID->"2476666b-e4af-4c9f-bcec-\
e835c1b84030"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "6", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.734120049134753*^9, 3.734120092911417*^9, 3.7342008043739853`*^9, 
   3.7342019845624228`*^9, 3.734202017836204*^9, 3.734207813366859*^9, 
   3.7342079871996393`*^9, {3.734208075710087*^9, 3.7342080974092913`*^9}, 
   3.7343726244948807`*^9},ExpressionUUID->"7f2b17fa-b47c-46b5-8bd5-\
8b223d13ee29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Count", " ", "visits", " ", "to", " ", "blood", " ", "feeding", " ", 
    "sites", " ", "following", " ", "an", " ", "initial", " ", "infection", 
    " ", "at", " ", "each", " ", "blood", " ", "feeding", " ", "site"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", 
    RowBox[{"tIndexes", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"And", " ", "the", " ", "initial", " ", "position"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"j", " ", "=", " ", 
    RowBox[{"mosChain", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.734120106194961*^9, 
  3.734120268457755*^9}},ExpressionUUID->"7065d5be-298c-4216-b5d3-\
47ab794ae9da"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.73412013382653*^9, 3.734120161606216*^9}, {
   3.734120234450919*^9, 3.734120269047846*^9}, 3.734200814263958*^9, 
   3.734201985924737*^9, 3.734202019640605*^9, 3.734207816604664*^9, 
   3.734207988730941*^9, {3.734208077201539*^9, 3.7342080987023907`*^9}, 
   3.734372625981196*^9},ExpressionUUID->"0ea6845d-16f2-4ba9-941c-\
d159855d0ab4"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.73412013382653*^9, 3.734120161606216*^9}, {
   3.734120234450919*^9, 3.734120269047846*^9}, 3.734200814263958*^9, 
   3.734201985924737*^9, 3.734202019640605*^9, 3.734207816604664*^9, 
   3.734207988730941*^9, {3.734208077201539*^9, 3.7342080987023907`*^9}, 
   3.734372625997719*^9},ExpressionUUID->"2004df59-8696-4340-aa8d-\
e2c53c1c80e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "time", " ", "steps", " ", "that", " ", "occur", " ", 
    "between", " ", "end", " ", "of", " ", "EIP", " ", "and", " ", "mosquito",
     " ", "death"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"subMosChain", " ", "=", " ", 
    RowBox[{"mosChain", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"i", "+", "EIP"}], ",", 
         RowBox[{"tDeath", " ", "+", " ", "1"}]}], "]"}], ";;", "tDeath"}], 
      "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Find", " ", "where", " ", "the", " ", "secondary", " ", "infectious", 
     " ", 
     RowBox[{"occur", ":", "\[IndentingNewLine]", 
      RowBox[{
      "Find", " ", "the", " ", "Location", " ", "of", " ", "all", " ", "rows",
        " ", "in", " ", "the", " ", "subChain", " ", "where", " ", "we", " ", 
       "visit", " ", "a", " ", "feeding", " ", "site"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"bitesMosChain", " ", "=", " ", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"subMosChain", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{3.73412066165177*^9, 
  3.734202053644443*^9},ExpressionUUID->"a183dc9c-1934-4965-b890-\
35d0090c2461"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"11", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7341202706417*^9, 3.73412066206712*^9, 3.734201448368731*^9, 
   3.7342020252690887`*^9, 3.734207818893797*^9, 3.734207990612804*^9, {
   3.7342080790934467`*^9, 3.734208100151739*^9}, 
   3.7343726278181458`*^9},ExpressionUUID->"75db1c68-2054-4365-9ad9-\
2b32adbd0482"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7341202706417*^9, 3.73412066206712*^9, 3.734201448368731*^9, 
   3.7342020252690887`*^9, 3.734207818893797*^9, 3.734207990612804*^9, {
   3.7342080790934467`*^9, 3.734208100151739*^9}, 
   3.734372627834786*^9},ExpressionUUID->"42291a31-f6c6-4c88-857b-\
35813900d0b4"]
}, Open  ]],

Cell["\<\
For the example above, we would say that a mosquito who was initially \
infected at site 3 then lived long enough to bite 2 more people at site 2\
\>", "Text",
 CellChangeTimes->{{3.734120170870529*^9, 3.73412017846491*^9}, {
  3.734120274940886*^9, 3.734120287857379*^9}, {3.734120675756194*^9, 
  3.734120684570326*^9}, {3.734372629841772*^9, 
  3.734372630685265*^9}},ExpressionUUID->"8d7f8d4e-0639-43a4-8d1e-\
488fb126466c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Repeating", ",", " ", 
    RowBox[{"but", " ", "for", " ", "the", " ", "2", "nd", " ", "index"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Count", " ", "visits", " ", "to", " ", "blood", " ", "feeding", " ", 
    "sites", " ", "following", " ", "an", " ", "initial", " ", "infection", 
    " ", "at", " ", "each", " ", "blood", " ", "feeding", " ", "site"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", 
    RowBox[{"tIndexes", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"And", " ", "the", " ", "initial", " ", "position"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"j", " ", "=", " ", 
    RowBox[{"mosChain", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "time", " ", "steps", " ", "that", " ", "occur", " ", 
     "between", " ", "end", " ", "of", " ", "EIP", " ", "and", " ", 
     "mosquito", " ", "death"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"subMosChain", " ", "=", " ", 
    RowBox[{"mosChain", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"i", "+", "EIP"}], ",", 
         RowBox[{"tDeath", " ", "+", " ", "1"}]}], "]"}], ";;", "tDeath"}], 
      "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Find", " ", "where", " ", "the", " ", "secondary", " ", "infectious", 
     " ", 
     RowBox[{"occur", ":", "\[IndentingNewLine]", 
      RowBox[{
      "Find", " ", "the", " ", "Location", " ", "of", " ", "all", " ", "rows",
        " ", "in", " ", "the", " ", "subChain", " ", "where", " ", "we", " ", 
       "visit", " ", "a", " ", "feeding", " ", "site"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"bitesMosChain", " ", "=", " ", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"subMosChain", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.734120690883054*^9, 3.734120703813113*^9}, {
  3.734201846438418*^9, 
  3.7342018527395372`*^9}},ExpressionUUID->"cec37aeb-672c-44fe-86a8-\
3b36f5cc4238"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.7341206979796124`*^9, 3.734120704023302*^9}, 
   3.734201458938384*^9, 3.734201854802148*^9, 3.7342020321938057`*^9, 
   3.7342078508281517`*^9, 3.7342080020904083`*^9, {3.73420808114886*^9, 
   3.7342081025580187`*^9}, 
   3.7343726335815363`*^9},ExpressionUUID->"09f8b16d-35a8-4d7e-95d5-\
8c3a2f23162e"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.7341206979796124`*^9, 3.734120704023302*^9}, 
   3.734201458938384*^9, 3.734201854802148*^9, 3.7342020321938057`*^9, 
   3.7342078508281517`*^9, 3.7342080020904083`*^9, {3.73420808114886*^9, 
   3.7342081025580187`*^9}, 
   3.7343726335981083`*^9},ExpressionUUID->"36c5ac04-5a6b-48ef-ac54-\
88579a37513e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"13", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7341206979796124`*^9, 3.734120704023302*^9}, 
   3.734201458938384*^9, 3.734201854802148*^9, 3.7342020321938057`*^9, 
   3.7342078508281517`*^9, 3.7342080020904083`*^9, {3.73420808114886*^9, 
   3.7342081025580187`*^9}, 
   3.7343726336114388`*^9},ExpressionUUID->"36544004-c8a3-463c-bf94-\
9981bf8e7bfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.7341206979796124`*^9, 3.734120704023302*^9}, 
   3.734201458938384*^9, 3.734201854802148*^9, 3.7342020321938057`*^9, 
   3.7342078508281517`*^9, 3.7342080020904083`*^9, {3.73420808114886*^9, 
   3.7342081025580187`*^9}, 
   3.734372633624598*^9},ExpressionUUID->"c1897402-e142-42c7-90d1-\
ba92350991d1"]
}, Open  ]],

Cell["\<\
So in addition this same mosquito who bit someone at site 4 lived long enough \
to also bite someone at site 2.\
\>", "Text",
 CellChangeTimes->{{3.734120708280519*^9, 
  3.734120729762745*^9}},ExpressionUUID->"d7c859df-4673-4bec-bbf5-\
ddc79fa685eb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate VC-influence matrix", "Section",
 CellChangeTimes->{{3.734106583298367*^9, 3.734106603888835*^9}, {
  3.7341077694989634`*^9, 3.734107782765037*^9}, {3.7341198008176193`*^9, 
  3.734119809199407*^9}, {3.734547707393124*^9, 
  3.734547708796422*^9}},ExpressionUUID->"903e25fa-15bc-4dda-a88e-\
a224e7bd3bad"],

Cell["\<\
What I call the VC - influence matrix is the number of secondary bites that \
occur at site j given that the initial bite occurred at site i.  If we sum \
over all target sites j we obtain the Vectorial Capacity for each site i. 

This matrix will serve as our objective function

As we will see, we can calculate the VCI matrix as long as we only count the \
very first blood feeding site visited as the origin of all secondary \
infectious bites.  If we allow for mosquitoes to visit multiple blood feeding \
sites and attribute the secondary infectious bites that can be attributed to \
all blood feeding sites visited then we get the proportions right but not the \
total numbers of secondary bites right.\
\>", "Text",
 CellChangeTimes->{{3.734547795787073*^9, 3.7345478353483686`*^9}, {
  3.734548155744516*^9, 
  3.734548329098116*^9}},ExpressionUUID->"9862123e-4e3c-46f4-8c7e-\
6f02c744a875"],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{
   "Start", " ", "by", " ", "generating", " ", "an", " ", "ensemble"}], " ", 
   "*)"}],
  FontSize->16]], "Input",ExpressionUUID->"3c3c94bc-1c5c-4517-84de-\
e19093ab7296"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"init", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "mosMatrix", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"init", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", "1."}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1.", "/", 
          RowBox[{"Length", "[", "nodeType", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "nodeType", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "init", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", " ", "=", " ", 
     RowBox[{"DiscreteMarkovProcess", "[", 
      RowBox[{"init", ",", "mosMatrix"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RandomSeed", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mosEnsemble", " ", "=", " ", 
     RowBox[{"RandomFunction", "[", 
      RowBox[{"P", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "100"}], "}"}], ",", "100000"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7341077856570587`*^9, 3.7341078392937517`*^9}, {
   3.7341079058957253`*^9, 3.7341079120066233`*^9}, {3.734107944376143*^9, 
   3.7341080041491137`*^9}, {3.734109844845972*^9, 3.7341098451567593`*^9}, 
   3.7341185129666023`*^9, 3.734118557071031*^9, 3.734119269709387*^9, 
   3.7341195375378733`*^9, {3.734119629235561*^9, 3.734119629439665*^9}, 
   3.7341225196551037`*^9, {3.734200775720797*^9, 3.7342007759911337`*^9}, {
   3.734201465557746*^9, 3.7342014675854797`*^9}, {3.734201518550695*^9, 
   3.73420153092365*^9}, {3.734202084714775*^9, 3.734202104779439*^9}, 
   3.734202669946383*^9, {3.7342071374795713`*^9, 3.734207157004056*^9}, {
   3.734207188865572*^9, 3.7342072115023193`*^9}, 3.7342078615295687`*^9, {
   3.7342081311559353`*^9, 3.734208136727931*^9}, 3.734208168714994*^9, {
   3.73420825091451*^9, 3.734208251055603*^9}, 3.734208350539496*^9, 
   3.7342084624683*^9, {3.7342097964163*^9, 3.734209798477619*^9}, {
   3.734210044889863*^9, 3.734210045214498*^9}, {3.734210087536388*^9, 
   3.734210088014557*^9}, {3.7342105409165277`*^9, 3.734210541888377*^9}, {
   3.734369575973526*^9, 3.73436957656811*^9}, {3.7343726481490517`*^9, 
   3.7343726497211103`*^9}, 3.73437274181076*^9, {3.7343730991751432`*^9, 
   3.734373349612439*^9}, {3.734463163794258*^9, 3.734463236742071*^9}, {
   3.7344634916945744`*^9, 3.7344635050008163`*^9}, {3.7344636202744837`*^9, 
   3.73446362759671*^9}, {3.7345391542865763`*^9, 3.734539176217204*^9}, {
   3.734539347948606*^9, 3.734539348163739*^9}, {3.73453942148555*^9, 
   3.734539421618064*^9}, {3.73453964231513*^9, 3.734539659081304*^9}, {
   3.734540562541133*^9, 3.7345405646205807`*^9}, {3.734540609123551*^9, 
   3.734540645258148*^9}, {3.734540907245336*^9, 3.734540909484498*^9}, {
   3.734548347159738*^9, 3.734548364230051*^9}, {3.734550389691045*^9, 
   3.7345503898184633`*^9}, {3.734706306957181*^9, 3.734706307097842*^9}, {
   3.734706502818591*^9, 
   3.734706503125689*^9}},ExpressionUUID->"c1b34467-3a7f-4cdc-9c9e-\
3b2a1f07fffe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.734540645749887*^9, {3.734540907715748*^9, 3.734540909921726*^9}, {
   3.7345483623698463`*^9, 3.73454836470791*^9}, 3.734548529851893*^9, 
   3.734550390185446*^9, 3.734706089068153*^9, 3.734706307464566*^9, 
   3.7347065036402187`*^9},ExpressionUUID->"a6eb847e-e562-4e2c-acb7-\
aeb89346890d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "the", " ", "Entomological", " ", "Incubation", " ", 
    "Period"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EIP", " ", "=", " ", "10"}], ";"}]}]], "Input",
 CellChangeTimes->{3.7345483800078993`*^9},
 FontWeight->"Plain",ExpressionUUID->"6197a3a4-c2d9-43b2-aabb-9e9aff5de19f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "is", " ", "the", " ", "Markov", " ", "Matrix"}], 
    ",", " ", 
    RowBox[{
    "but", " ", "with", " ", "all", " ", "of", " ", "the", " ", "dead", " ", 
     "states", " ", "removed", " ", "for", " ", "analytical", " ", 
     "tractability"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ms", " ", "=", " ", 
    RowBox[{"mosMatrix", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{";;", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{";;", 
        RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.734709564765954*^9, 
  3.734709608939168*^9}},ExpressionUUID->"76d04818-21b2-4bad-a54e-\
5c4ec447605b"],

Cell[CellGroupData[{

Cell["\<\
Only count the number of secondary bites that follow from the first initial \
bite\
\>", "Subsection",
 CellChangeTimes->{{3.734547724539934*^9, 
  3.734547757038802*^9}},ExpressionUUID->"a26b1e65-1787-430f-9085-\
aac0f4b04000"],

Cell["\<\
That is to say, count only the visits to blood feeding sites that occur >= \
EIP time steps following the first visit to a blood feeding site. \
\>", "Text",
 CellChangeTimes->{{3.7345477485720577`*^9, 3.734547790356044*^9}, {
  3.734547821360917*^9, 
  3.73454782787048*^9}},ExpressionUUID->"263f27e4-86da-4113-9dbf-\
cce3e338cd4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Initialize", " ", "VCI"}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      RowBox[{"VCI", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "=", " ", 
     RowBox[{
     "Number", " ", "of", " ", "bites", " ", "at", " ", "j", " ", "following",
       " ", "an", " ", "infectious", " ", "bite", " ", "at", " ", "i"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VCI", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Select", " ", "a", " ", "chain"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{
        RowBox[{"mosEnsemble", "[", "\"\<Paths\>\"", "]"}], "[", 
        RowBox[{"[", "chainIndex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"mosChain", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "a_"}], "}"}], "/;", 
          RowBox[{"a", "<", 
           RowBox[{"Length", "[", "mosMatrix", "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tDeath", " ", "=", " ", 
       RowBox[{"Length", "[", "mosChain", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Look", " ", "at", " ", "the", " ", "node", " ", "type", " ", "at", 
         " ", "each", " ", "place", " ", "visited"}], ",", " ", 
        RowBox[{"just", " ", "to", " ", "verify", " ", 
         RowBox[{"we", "'"}], "re", " ", "alternating"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pathNodeTypes", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"nodeType", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"nodeType", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"mosChain", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Add", " ", "the", " ", "type", " ", "visited", " ", "to", " ", 
        "each"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "mosChain", "]"}], ",", 
          RowBox[{"{", "pathNodeTypes", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "These", " ", "are", " ", "all", " ", "of", " ", "the", " ", "indexes",
         " ", "of", " ", "the", " ", "relevant", " ", "starting", " ", 
        "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tIndexes", " ", "=", "  ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"mosChain", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"tDeath", "-", "EIP"}], ",", "1"}], "]"}]}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Count", " ", "visits", " ", "to", " ", "blood", " ", "feeding", " ", 
        "sites", " ", "following", " ", "initial", " ", "infection", " ", 
        "at", " ", "each", " ", "blood", " ", "feeding", " ", "site"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Loop", " ", "over", " ", "all", " ", "starting", " ", "indices"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Subset", " ", "our", " ", "chain", " ", "according", " ", "to", " ",
           "the", " ", "times", " ", "when", " ", "secondary", " ", 
          "infections", " ", "could", " ", "occur", "\[IndentingNewLine]", 
          "Between", " ", "t"}], " ", "=", " ", 
         RowBox[{"i", " ", "+", " ", 
          RowBox[{"EIP", " ", "and", " ", "tDeath"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"subMosChain", " ", "=", " ", 
          RowBox[{"mosChain", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"i", "+", "EIP"}], ",", 
               RowBox[{"tDeath", " ", "+", " ", "1"}]}], "]"}], ";;", 
             "tDeath"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Find", " ", "where", " ", "the", " ", "secondary", " ", 
           "infectious", " ", 
           RowBox[{"occur", ":", "\[IndentingNewLine]", 
            RowBox[{
            "Find", " ", "the", " ", "Location", " ", "of", " ", "all", " ", 
             "rows", " ", "in", " ", "the", " ", "subChain", " ", "where", 
             " ", "we", " ", "visit", " ", "a", " ", "feeding", " ", 
             "site"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bitesMosChain", " ", "=", " ", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"subMosChain", ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Add", " ", "biting", " ", "event", " ", "counts"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"VCI", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"mosChain", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"bitesMosChain", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+=", "1"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bitesMosChain", "]"}]}], "}"}]}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "End", " ", "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"tIndexes", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "[", "tIndexes", "]"}], ",", "1"}], "]"}]}], 
            "]"}], "]"}]}], "}"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Right", " ", "now"}], ",", " ", 
       RowBox[{"only", " ", "the", " ", "first"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"End", " ", "loop", " ", "over", " ", "chain"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"chainIndex", ",", "1", ",", 
       RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.73411785434835*^9, 3.734117982359322*^9}, {
   3.734118018571885*^9, 3.734118035009857*^9}, {3.734118066339849*^9, 
   3.734118134983396*^9}, 3.734118348070063*^9, {3.7341194004976377`*^9, 
   3.734119401180655*^9}, {3.734119903040627*^9, 3.734119910937655*^9}, 
   3.734120984423744*^9, {3.734202062223466*^9, 3.734202065654992*^9}, {
   3.734207870844441*^9, 3.734207871097543*^9}, 3.7342079554398203`*^9, 
   3.734210001325836*^9, {3.7342100641309633`*^9, 3.73421006876027*^9}, {
   3.734210610100998*^9, 3.734210612251481*^9}, {3.7343730901804867`*^9, 
   3.734373090439365*^9}, {3.734539139046851*^9, 3.734539139628211*^9}, {
   3.7345440628801727`*^9, 3.7345440632017183`*^9}, 3.7345463009386263`*^9, {
   3.7345464199581337`*^9, 3.7345464529951773`*^9}, {3.734546580397357*^9, 
   3.734546580835205*^9}, {3.7345483767688503`*^9, 3.73454840484412*^9}, 
   3.734702779267601*^9},ExpressionUUID->"86785f35-1c95-465d-8ea9-\
ba9ade9d8fe2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Visualize", " ", "the", " ", "VC"}], "-", 
    RowBox[{"influence", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"1.", "*", 
    RowBox[{"VCI", "/", 
     RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.734118571247315*^9, 3.734118577340452*^9}, 
   3.734118613753275*^9, {3.7341195011629963`*^9, 3.734119556799581*^9}, {
   3.734119602818775*^9, 3.7341196072154293`*^9}, {3.7341197778511333`*^9, 
   3.7341197818159857`*^9}, 3.734119912198392*^9, {3.73420975770667*^9, 
   3.734209778118647*^9}, 
   3.734209808799264*^9},ExpressionUUID->"0c5c6db4-3386-4c57-8fe1-\
31786ef972a2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04946`", "0.04042`", "0.0485`", "0.06282`", "0.`", "0.0411`", 
      "0.`", "0.05046`"},
     {"0.`", "0.04782`", "0.03904`", "0.04676`", "0.06052`", "0.`", 
      "0.03736`", "0.`", "0.04792`"},
     {"0.`", "0.04688`", "0.0392`", "0.04748`", "0.06134`", "0.`", "0.03994`",
       "0.`", "0.05152`"},
     {"0.`", "0.05728`", "0.0468`", "0.05754`", "0.07336`", "0.`", "0.0442`", 
      "0.`", "0.05972`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04608`", "0.03886`", "0.04738`", "0.06072`", "0.`", 
      "0.03636`", "0.`", "0.05028`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04954`", "0.04182`", "0.04932`", "0.06546`", "0.`", 
      "0.03914`", "0.`", "0.05226`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734209778362384*^9, 3.7342098096890717`*^9, 3.734210007912529*^9, 
   3.7342100640297623`*^9, 3.73421014744561*^9, 3.734210561342683*^9, 
   3.734210631915956*^9, 3.734372656399588*^9, 3.7343727642109623`*^9, 
   3.7343728814903517`*^9, 3.734373121655263*^9, 3.734373291457176*^9, 
   3.73437335469812*^9, {3.734463610831706*^9, 3.734463634956539*^9}, 
   3.734530837867292*^9, 3.734539181738381*^9, 3.7345393517711897`*^9, 
   3.734539426245406*^9, 3.734544081514656*^9, 3.734546320531526*^9, 
   3.734546475286251*^9, 3.734546600359851*^9, 3.7345484712461576`*^9, 
   3.7345485416275473`*^9, 
   3.73455041153097*^9},ExpressionUUID->"b9059e77-a23f-4a83-88b2-\
ed3fe593e425"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compare", " ", "to", " ", "an", " ", "analytical", " ", "approximation"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"2.", "-", "nodeType"}], ")"}]}], ")"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"init", "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
        ")"}], "]"}], ".", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"ms", ",", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"ms", ",", "1"}], "]"}]}], ")"}], "]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"(", 
        RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "h", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7345485141709843`*^9, 
  3.734548522488165*^9}},ExpressionUUID->"07fbc456-747f-497d-8f6d-\
25a83e7ab541"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.0499105304181162`", "0.041196812730183906`", 
      "0.04991051728744986`", "0.06439426290342952`", "0.`", 
      "0.0411967813663912`", "0.`", "0.05245115681867138`"},
     {"0.`", "0.046536128615748976`", "0.03841179652634237`", 
      "0.04653609318704963`", "0.0600409581354827`", "0.`", 
      "0.0384117119016666`", "0.`", "0.04890546194874776`"},
     {"0.`", "0.04991051728744986`", "0.0411967813663912`", 
      "0.04991053041811621`", "0.06439426290342953`", "0.`", 
      "0.04119681273018392`", "0.`", "0.05245115681867139`"},
     {"0.`", "0.053664841169016986`", "0.044295912467441405`", 
      "0.05366484116901699`", "0.0692384199128339`", "0.`", 
      "0.04429591246744141`", "0.`", "0.056397094294699586`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04653609318704964`", "0.0384117119016666`", 
      "0.04653612861574897`", "0.0600409581354827`", "0.`", 
      "0.03841179652634237`", "0.`", "0.048905461948747765`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.049502358128762636`", "0.040860299764618246`", 
      "0.04950235812876263`", "0.063868228954335`", "0.`", 
      "0.040860299764618246`", "0.`", "0.052023038678839846`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7345485230265923`*^9, 3.73454854410072*^9}, 
   3.7345504116677227`*^9},ExpressionUUID->"1fc43e96-b089-440e-8e57-\
0f4d1681fe95"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Network", " ", "Visualization", " ", "of", " ", "the", " ", "VC"}], "-", 
    
    RowBox[{"influence", " ", "matrix"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"markovPDF", "=", 
     RowBox[{
     "CalculateMarkovSteadyState", "[", "migrationDimensionalMatrix", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colorsType", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<LakeColors\>\"", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "1", ",", 
         RowBox[{"1", "/", "networkDimension"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesSwatchType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"colorsType", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", ".75", "]"}], ",", 
            RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", "networkDimension", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesListType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"stylesSwatchType", "[", 
          RowBox[{"[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"nodeType", "//", "Length"}], "]"}], ",", "nodeType"}], 
        "}"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"markovDimensional", "=", 
    RowBox[{"GraphPlotWrapper", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"10.", "*", 
           RowBox[{"VCI", "/", 
            RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}]}], ")"}],
          "//", "LowerTriangularize"}], ",", "edgeChopThreshold"}], "]"}], 
      ",", ".1", ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"VertexList", "[", "originalMap", " ", "]"}], "\[Rule]", 
        RowBox[{".25", "*", 
         RowBox[{"Log", "[", 
          RowBox[{"5", "+", 
           RowBox[{"7.5", "*", 
            RowBox[{"Rescale", "[", "markovPDF", "]"}]}]}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", "stylesListType"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.734119702404113*^9, 3.734119773529461*^9}, 
   3.7341199155970182`*^9, {3.734539213350245*^9, 3.73453922335248*^9}, {
   3.734548604039173*^9, 
   3.73454860974207*^9}},ExpressionUUID->"c78a8d87-97a6-4ab9-9620-\
9607d705789f"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "1", "2", "3", "4", "5", "6", "7", "8", "9"}, {{{2, 2}, {3, 2}, {3, 
       3}, {4, 2}, {4, 3}, {4, 4}, {5, 2}, {5, 3}, {5, 4}, {5, 5}, {7, 2}, {7,
        3}, {7, 4}, {7, 5}, {7, 7}, {9, 2}, {9, 3}, {9, 4}, {9, 5}, {9, 7}, {
       9, 9}}, Null}, {
      Background -> GrayLevel[1], 
       EdgeLabels -> {
        DirectedEdge["9", "4"] -> Placed[0.4932, Tooltip], 
         DirectedEdge["3", "3"] -> Placed[0.39039999999999997`, Tooltip], 
         DirectedEdge["2", "2"] -> Placed[0.4946, Tooltip], 
         DirectedEdge["7", "3"] -> Placed[0.3886, Tooltip], 
         DirectedEdge["7", "2"] -> Placed[0.46080000000000004`, Tooltip], 
         DirectedEdge["4", "2"] -> Placed[0.4688, Tooltip], 
         DirectedEdge["9", "3"] -> Placed[0.4182, Tooltip], 
         DirectedEdge["5", "3"] -> Placed[0.468, Tooltip], 
         DirectedEdge["9", "5"] -> Placed[0.6546000000000001, Tooltip], 
         DirectedEdge["7", "4"] -> Placed[0.4738, Tooltip], 
         DirectedEdge["9", "7"] -> Placed[0.3914, Tooltip], 
         DirectedEdge["3", "2"] -> Placed[0.4782, Tooltip], 
         DirectedEdge["7", "7"] -> Placed[0.36360000000000003`, Tooltip], 
         DirectedEdge["5", "4"] -> Placed[0.5754, Tooltip], 
         DirectedEdge["4", "3"] -> Placed[0.392, Tooltip], 
         DirectedEdge["5", "2"] -> Placed[0.5728, Tooltip], 
         DirectedEdge["4", "4"] -> Placed[0.4748, Tooltip], 
         DirectedEdge["9", "2"] -> Placed[0.4954, Tooltip], 
         DirectedEdge["9", "9"] -> Placed[0.5226, Tooltip], 
         DirectedEdge["5", "5"] -> Placed[0.7335999999999999, Tooltip], 
         DirectedEdge["7", "5"] -> Placed[0.6072000000000001, Tooltip]}, 
       EdgeShapeFunction -> {$CellContext`edgeshape2}, 
       EdgeStyle -> {DirectedEdge["9", "7"] -> {
           Opacity[2.9855], 
           Thickness[0.001957]}, DirectedEdge["5", "2"] -> {
           Opacity[4.345999999999999], 
           Thickness[0.002864]}, DirectedEdge["9", "5"] -> {
           Opacity[4.959500000000001], 
           Thickness[0.0032730000000000007`]}, DirectedEdge["4", "4"] -> {
           Opacity[3.6109999999999998`], 
           Thickness[0.0023740000000000002`]}, DirectedEdge["7", "4"] -> {
           Opacity[3.6034999999999995`], 
           Thickness[0.002369]}, DirectedEdge["4", "2"] -> {
           Opacity[3.566], 
           Thickness[0.0023439999999999997`]}, DirectedEdge["7", "7"] -> {
           Opacity[2.777], 
           Thickness[0.0018180000000000002`]}, DirectedEdge["5", "3"] -> {
           Opacity[3.5600000000000005`], 
           Thickness[0.0023400000000000005`]}, DirectedEdge["3", "2"] -> {
           Opacity[3.6365], 
           Thickness[0.002391]}, DirectedEdge["9", "9"] -> {
           Opacity[3.969499999999999], 
           Thickness[0.0026129999999999994`]}, DirectedEdge["7", "2"] -> {
           Opacity[3.5060000000000002`], 
           Thickness[0.0023040000000000005`]}, DirectedEdge["9", "4"] -> {
           Opacity[3.749], 
           Thickness[0.0024660000000000003`]}, DirectedEdge["7", "5"] -> {
           Opacity[4.604], 
           Thickness[0.0030360000000000005`]}, DirectedEdge["4", "3"] -> {
           Opacity[2.9899999999999998`], 
           Thickness[0.00196]}, DirectedEdge["7", "3"] -> {
           Opacity[2.9645], 
           Thickness[0.001943]}, DirectedEdge["9", "3"] -> {
           Opacity[3.1865], 
           Thickness[0.0020910000000000004`]}, DirectedEdge["5", "5"] -> {
           Opacity[5.552], 
           Thickness[0.003668]}, DirectedEdge["5", "4"] -> {
           Opacity[4.3655], 
           Thickness[0.0028770000000000002`]}, DirectedEdge["3", "3"] -> {
           Opacity[2.9779999999999998`], 
           Thickness[0.001952]}, DirectedEdge["9", "2"] -> {
           Opacity[3.7654999999999994`], 
           Thickness[0.002477]}, DirectedEdge["2", "2"] -> {
           Opacity[3.7594999999999996`], 
           Thickness[0.002473]}}, 
       EdgeWeight -> {0.4946, 0.4782, 0.39039999999999997`, 0.4688, 0.392, 
        0.4748, 0.5728, 0.468, 0.5754, 0.7335999999999999, 
        0.46080000000000004`, 0.3886, 0.4738, 0.6072000000000001, 
        0.36360000000000003`, 0.4954, 0.4182, 0.4932, 0.6546000000000001, 
        0.3914, 0.5226}, Epilog -> {}, Frame -> False, FrameStyle -> 
       Thickness[Large], GraphLayout -> Automatic, ImagePadding -> 0, 
       ImageSize -> 250, PerformanceGoal -> "Speed", Prolog -> {}, 
       VertexCoordinates -> {{0, 0}, {0, 50}, {0, 100}, {50, 0}, {50, 50}, {
        50, 100}, {100, 0}, {100, 50}, {100, 100}}, VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {0.0001}, 
       VertexSize -> {
        "4" -> 0.4485583028219154, "7" -> 0.40235947810852507`, "3" -> 
         0.40235947810852507`, "8" -> 0.6314321610770639, "5" -> 
         0.5103637388853087, "9" -> 0.46056612023610133`, "2" -> 
         0.44855830282191567`, "6" -> 0.6314321610770639, "1" -> 
         0.5863373987377415}, VertexStyle -> {"5" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "6" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "1" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "4" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "9" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "7" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "8" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "3" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "2" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        TagBox[
         TooltipBox[
          {Thickness[0.002473], Opacity[3.7594999999999996`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQjQo8HRoaDDQZeg/YX3h4vc/omoeDgYJe2/ZlP+1b
39W2PT3o6tCwqMk3YeUX+4wzp4oCZzg5HPjPp/3w/4v9F9PEZ58xsXd48i93
sdBpwQPp/0Il1LmtHDxMrv2/fUXpwJNtzSZbZc0cdl3aYfV1ot6Bq3OUb8vs
NXaQEa7982Sq6YEpajFM+lLGDqxM+4LOnrc+EFX0zuWvo4mDjPhiodzdDgdS
Xuu3n5Uxd9gU9PJ4DbfzgU+fy3UZC6wdYh5NDpmxwuVAS97h9JRCB4e0TzJv
5hS6HqiR//N2YZOzg3jLzStZYa4HTjyv/LRnjZuDxkf1eoNIlwPM93pW7Frn
6bAuNXmXbZ/TgejdC35d9/JxCGFMm58k5XDg3J0bR2q9/Rx2JEh6fY+3OrB0
RbFzb7u/w8QphxnPi5ocmCwypWDNU38HKb4HUs/XaR/IWKAw3S/O36HqbEWv
sZfCgU0LjSL9//g6LIjz/3hnLveBNokTu4TveDs0HPN9zHP74P7CL9+FnDU9
HdDDHwBnKbVA
             "]]}},
          "0.4946`"],
         Annotation[#, 0.4946, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.002391], Opacity[3.6365], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 50.}}]}},
          "0.4782`"],
         Annotation[#, 0.4782, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.001952], Opacity[2.9779999999999998`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQjQoiHRImGz/fonJh/63SdwrRHyIcVG7q7hVpFj2g
arrQMp4pwkHuk29wyTq1A/5HIzc+rwx3+Hr0YGDjSsMDAqW+h54lhjsEvJY/
cOaq+QGz046BnnvCHfZVxTRGxdoecNHMSjnfGOFQdGryDv/nDgeuBFoyLVwU
6XDIWiXeMN3pQMhbq/bJ7NEOXx4wd7XzOx/Y+qI6inVKjEOs5NIpFy85HZj1
OOSGpkacw2/3ROV3Wx0PXOG39p62ON5B69MEz7z59gdc5YxOvi1OcAi0f6MT
2Wd14F/gjY7qtwkOWX3BicsXmBwId9NM3WKS6LDB9f5lrQU6B2x/NDx66Jzo
sCLruuUcG4UDH/hOhp+RTHTosdJyVwhhOTD3k8q7yzsTHHasK32q1vPfPqJf
O2C1doLDLJ/Hr7OsRRyu/GI3KP4a5/BrncbtyQ8lHWoLC0ISsmId+FYnv2pJ
lHBw2ZfZde5qtINL9M3TElv4HSbeveRtGBHlcMBbRHmf53l7cDALRDqghz8A
wOmvJw==
             "]]}},
          "0.39039999999999997`"],
         Annotation[#, 0.39039999999999997`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0023439999999999997`], Opacity[3.566], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 50.}}]}},
          "0.4688`"],
         Annotation[#, 0.4688, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00196], Opacity[2.9899999999999998`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 100.}}]}},
          "0.392`"],
         Annotation[#, 0.392, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0023740000000000002`], Opacity[3.6109999999999998`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGeDjBW4ZfvQs6ang4Nx3wf89w+uL9T4sQu4Tve
Djvi/D/emct9YPNCo0j/P74OpWcreo29FA5kLVCY7hfn7yDG90Dq+TrtA1NF
phSseerv0DflMON5UZMDK1YUO/e2+ztsS5D0+h5vdeDinRtHar39HIIZ0+Yn
STkciNu94Nd1Lx+HtanJu2z7nA6w3etZsWudp4PGR/V6g0iXA2eeV37as8bN
Qbzl5pWsMNcD9fJ/3i5scnZI/yTzZk6h64GOvMPpKYUODrGPJofMWOFy4Mfn
cl3GAmuHzUEvj9dwOx/Ifq3fflbG3EFOfLFQ7m6HAwlF71z+Opo4cDLtCzp7
3vrADLUYJn0pYwdF4do/T6aaHrgxR/m2zF5jh0OXdlh9nah34Nm2ZpOtsmYO
QSbX/t++onQg41+ohDq3lcOXf7mLhU4LHriSJj77jIm9w4P/fNoP/7/Yn37m
VFHgDCeHhEVNvgkrv9i3vatte3rQ1UFBQa9t+7Kf9hceXu8zuubhwNBooMnQ
e8AePfwBFrm1KA==
             "]]}},
          "0.4748`"],
         Annotation[#, 0.4748, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.002864], Opacity[4.345999999999999], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 50.}}]}},
          "0.5728`"],
         Annotation[#, 0.5728, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0023400000000000005`], Opacity[3.5600000000000005`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 100.}}]}},
          "0.468`"],
         Annotation[#, 0.468, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0028770000000000002`], Opacity[4.3655], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {50., 0.}}]}},
          "0.5754`"],
         Annotation[#, 0.5754, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.003668], Opacity[5.552], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGeDjC64svry5elAx2mH8rbn7zJ30Fh7vv0skuB
Dv7nq43OOgc47N2yqGfhrCCHydJc75k7AhwS6iL+RecEOxx3USqVWxzg8Nav
+o+XfYiDTeDUeI4pAQ6mH79Vs3OHOty+d78tOjrAoUXp17Xi46EOLcsmH9j8
zd+h2MVhAl9umMNVL5EPa977OdjxPr1r9zXMwaY695HMGl+Hv9XG76dHhTss
js8zem7h46C4J8NeYGa4w2oNgfirS7wcXv6wO6i1Lhzufph86PX3C7Si3eH6
4xZMPCtx3NXBHmr+kZZJso+DXeD2a299zR8s4Ax3X01kjr0PpxPc/V5ODp88
PB0d3kH91x571eH9dQe4/4vKdose3ukAD59bJ14r/njvAA+/pESO2akVjvDw
zbSd6DDH18kBPfwBKvuoRQ==
             "]]}},
          "0.7335999999999999`"],
         Annotation[#, 0.7335999999999999, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0023040000000000005`], Opacity[3.5060000000000002`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 50.}}]}},
          "0.46080000000000004`"],
         Annotation[#, 0.46080000000000004`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.001943], Opacity[2.9645], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 100.}}]}},
          "0.3886`"],
         Annotation[#, 0.3886, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.002369], Opacity[3.6034999999999995`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 0.}}]}},
          "0.4738`"],
         Annotation[#, 0.4738, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0030360000000000005`], Opacity[4.604], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 50.}}]}},
          "0.6072000000000001`"],
         Annotation[#, 0.6072000000000001, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0018180000000000002`], Opacity[2.777], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGRDjDWZOPnW1QEgHwfEeV9nuftJ9295G0YEeWQ
EH3ztMQWfgeXfZld565GO4isTn7VkijhUFtYEJKQFevAsF7j9uSHkg5XfrEb
FH+Nc1ji8/h1lrWIQ0S/dsBq7QSHB+tKn6r1/Lef+0nl3eWdCQ4NVlruCiEs
Bz7wnQw/I5nosCjruuUcG4UDtj8aHj10TnRY5Xr/stYCnQPhbpqpW0wSHTL6
ghOXLzA58D/wRkf12wQHP/s3OpF9Vgdc5YxOvi1OcFD7NMEzb779gcv81t7T
Fsc7/HJPVH631fHArMchNzQ14hxiJJdOuXjJ6cDWF9VRrFNiHD4/YO5q53c+
EPLWqn0ye7TDQWuVeMN0pwNXAi2ZFi6KdCg6NXmH/3OHAy6aWSnnGyMc9lXF
NEbF2h4wO+0Y6Lkn3CHgtfyBM1fNDwiU+h56lhju8OXowcDGlYYH/I9Gbnxe
Ge4g88k3uGSd2gE104WW8UwRDnw3dfeKNIseuFX6TiH6Q4SDAjigL+xHD38A
yputRw==
             "]]}},
          "0.36360000000000003`"],
         Annotation[#, 0.36360000000000003`, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.002477], Opacity[3.7654999999999994`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 50.}}]}},
          "0.4954`"],
         Annotation[#, 0.4954, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0020910000000000004`], Opacity[3.1865], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 100.}}]}},
          
          "0.4182`"],
         Annotation[#, 0.4182, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0024660000000000003`], Opacity[3.749], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 0.}}]}},
          "0.4932`"],
         Annotation[#, 0.4932, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0032730000000000007`], Opacity[4.959500000000001], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 50.}}]}},
          
          "0.6546000000000001`"],
         Annotation[#, 0.6546000000000001, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.001957], Opacity[2.9855], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 0.}}]}},
          
          "0.3914`"],
         Annotation[#, 0.3914, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0026129999999999994`], Opacity[3.969499999999999], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGRDjD6Vuk7hegPEQ6TjZ9vURGIdFA1XWgZzxTh
MOnuJW/DiCgH/6ORG59Xhjs478vsOnc12kGg1PfQs8Rwh9rCgpCErFgHs9OO
gZ57wh2u/GI3KP4a5+CimZVyvjHCIaJfO2C1doLD5UBLpoWLIh3mfFJ5d3ln
gkPIW6v2yezRDh/4ToafkUx02PqiOop1SoyD7Y+GRw+dEx1mPQ65oakR5xDu
ppm6xSTR4TK/tfe0xfEO/wNvdFS/TXBwlTM6+bYYQf+Dil+BqoPpg5kDM3cb
1B6YvaFQd8yFuusK1J0wd7tC/QHzF8yfMH/DwsEFGi6wcJoIDTdYOMLCFRbO
6OEPAC99p+A=
             "]]}},
          "0.5226`"],
         Annotation[#, 0.5226, "Tooltip"]& ]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 0.}, 14.658434968443537]}, InsetBox[
          StyleBox["\<\"1\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 50.}, 11.213957570547892]}, InsetBox[
          StyleBox["\<\"2\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 100.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"3\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 0.}, 11.213957570547885]}, InsetBox[
          StyleBox["\<\"4\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 50.}, 12.759093472132719]}, InsetBox[
          StyleBox["\<\"5\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 100.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"6\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 0.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"7\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 50.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"8\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 100.}, 11.514153005902534]}, InsetBox[
          StyleBox["\<\"9\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 100.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  Background->GrayLevel[1],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->Thickness[Large],
  FrameTicks->None,
  ImagePadding->0,
  ImageSize->250]], "Output",
 CellChangeTimes->{
  3.734119720340057*^9, 3.7341197510874567`*^9, 3.73412252654661*^9, 
   3.734202681855893*^9, 3.734207231808936*^9, 3.734207885307434*^9, 
   3.734210633816553*^9, 3.734372666361145*^9, 3.734372769304948*^9, 
   3.734372900651164*^9, 3.73446354007777*^9, 3.734463640002551*^9, 
   3.734539202443207*^9, 3.734548484265875*^9, {3.734548551878456*^9, 
   3.7345486101818943`*^9}, 
   3.734550426793597*^9},ExpressionUUID->"94f63c6d-bbe5-4667-ae7a-\
083ac3437e7c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Count the number of secondary bites that follow from the ALL initial bites\
\>", "Subsection",
 CellChangeTimes->{{3.734547724539934*^9, 3.734547757038802*^9}, {
  3.734549214269977*^9, 
  3.734549222725067*^9}},ExpressionUUID->"55c6004c-1fbe-453c-a343-\
1d0d4a6928ba"],

Cell["\<\
That is to say, count ALL of the visits to blood feeding sites that occur >= \
EIP time steps after an initial visit to ANY blood feeding site\
\>", "Text",
 CellChangeTimes->{{3.7345477485720577`*^9, 3.734547790356044*^9}, {
  3.734547821360917*^9, 3.73454782787048*^9}, {3.7345492269754257`*^9, 
  3.73454924960783*^9}},ExpressionUUID->"b51c86e2-4ef2-4e8a-bb26-\
224b9b250de3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Initialize", " ", "VCI"}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      RowBox[{"VCI", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "=", " ", 
     RowBox[{
     "Number", " ", "of", " ", "bites", " ", "at", " ", "j", " ", "following",
       " ", "an", " ", "infectious", " ", "bite", " ", "at", " ", "i"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VCI", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Select", " ", "a", " ", "chain"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{
        RowBox[{"mosEnsemble", "[", "\"\<Paths\>\"", "]"}], "[", 
        RowBox[{"[", "chainIndex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"mosChain", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "a_"}], "}"}], "/;", 
          RowBox[{"a", "<", 
           RowBox[{"Length", "[", "mosMatrix", "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tDeath", " ", "=", " ", 
       RowBox[{"Length", "[", "mosChain", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Look", " ", "at", " ", "the", " ", "node", " ", "type", " ", "at", 
         " ", "each", " ", "place", " ", "visited"}], ",", " ", 
        RowBox[{"just", " ", "to", " ", "verify", " ", 
         RowBox[{"we", "'"}], "re", " ", "alternating"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pathNodeTypes", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"nodeType", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"nodeType", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"mosChain", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Add", " ", "the", " ", "type", " ", "visited", " ", "to", " ", 
        "each"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mosChain", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "mosChain", "]"}], ",", 
          RowBox[{"{", "pathNodeTypes", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "These", " ", "are", " ", "all", " ", "of", " ", "the", " ", "indexes",
         " ", "of", " ", "the", " ", "relevant", " ", "starting", " ", 
        "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tIndexes", " ", "=", "  ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"mosChain", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"tDeath", "-", "EIP"}], ",", "1"}], "]"}]}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Count", " ", "visits", " ", "to", " ", "blood", " ", "feeding", " ", 
        "sites", " ", "following", " ", "initial", " ", "infection", " ", 
        "at", " ", "each", " ", "blood", " ", "feeding", " ", "site"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Loop", " ", "over", " ", "all", " ", "starting", " ", "indices"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Subset", " ", "our", " ", "chain", " ", "according", " ", "to", " ",
           "the", " ", "times", " ", "when", " ", "secondary", " ", 
          "infections", " ", "could", " ", "occur", "\[IndentingNewLine]", 
          "Between", " ", "t"}], " ", "=", " ", 
         RowBox[{"i", " ", "+", " ", 
          RowBox[{"EIP", " ", "and", " ", "tDeath"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"subMosChain", " ", "=", " ", 
          RowBox[{"mosChain", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"i", "+", "EIP"}], ",", 
               RowBox[{"tDeath", " ", "+", " ", "1"}]}], "]"}], ";;", 
             "tDeath"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Find", " ", "where", " ", "the", " ", "secondary", " ", 
           "infectious", " ", 
           RowBox[{"occur", ":", "\[IndentingNewLine]", 
            RowBox[{
            "Find", " ", "the", " ", "Location", " ", "of", " ", "all", " ", 
             "rows", " ", "in", " ", "the", " ", "subChain", " ", "where", 
             " ", "we", " ", "visit", " ", "a", " ", "feeding", " ", 
             "site"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bitesMosChain", " ", "=", " ", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"subMosChain", ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Add", " ", "biting", " ", "event", " ", "counts"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"VCI", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"mosChain", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"bitesMosChain", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+=", "1"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bitesMosChain", "]"}]}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "End", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tIndexes"}], "}"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Right", " ", "now"}], ",", " ", 
       RowBox[{"only", " ", "the", " ", "first"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"End", " ", "loop", " ", "over", " ", "chain"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"chainIndex", ",", "1", ",", 
       RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.73411785434835*^9, 3.734117982359322*^9}, {
   3.734118018571885*^9, 3.734118035009857*^9}, {3.734118066339849*^9, 
   3.734118134983396*^9}, 3.734118348070063*^9, {3.7341194004976377`*^9, 
   3.734119401180655*^9}, {3.734119903040627*^9, 3.734119910937655*^9}, 
   3.734120984423744*^9, {3.734202062223466*^9, 3.734202065654992*^9}, {
   3.734207870844441*^9, 3.734207871097543*^9}, 3.7342079554398203`*^9, 
   3.734210001325836*^9, {3.7342100641309633`*^9, 3.73421006876027*^9}, {
   3.734210610100998*^9, 3.734210612251481*^9}, {3.7343730901804867`*^9, 
   3.734373090439365*^9}, {3.734539139046851*^9, 3.734539139628211*^9}, {
   3.7345440628801727`*^9, 3.7345440632017183`*^9}, 3.7345463009386263`*^9, {
   3.7345464199581337`*^9, 3.7345464529951773`*^9}, {3.734546580397357*^9, 
   3.734546580835205*^9}, {3.7345483767688503`*^9, 3.73454840484412*^9}, 
   3.7345492589516087`*^9, {3.7345513925613527`*^9, 3.734551393164444*^9}, 
   3.7347019443902903`*^9},ExpressionUUID->"14093ed7-1a79-44c5-8762-\
d28fcad223e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Visualize", " ", "the", " ", "VC"}], "-", 
    RowBox[{"influence", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"1.", "*", 
    RowBox[{"VCI", "/", 
     RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.734118571247315*^9, 3.734118577340452*^9}, 
   3.734118613753275*^9, {3.7341195011629963`*^9, 3.734119556799581*^9}, {
   3.734119602818775*^9, 3.7341196072154293`*^9}, {3.7341197778511333`*^9, 
   3.7341197818159857`*^9}, 3.734119912198392*^9, {3.73420975770667*^9, 
   3.734209778118647*^9}, 
   3.734209808799264*^9},ExpressionUUID->"46d552a8-4418-4217-9026-\
14166c6afa4d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.25656`", "0.21234`", "0.25691`", "0.33489`", "0.`", 
      "0.21245`", "0.`", "0.27345`"},
     {"0.`", "0.21672`", "0.17731`", "0.21706`", "0.27967`", "0.`", 
      "0.17841`", "0.`", "0.23053`"},
     {"0.`", "0.26104`", "0.21461`", "0.26298`", "0.33946`", "0.`", 
      "0.21501`", "0.`", "0.27374`"},
     {"0.`", "0.32264`", "0.26296`", "0.32304`", "0.41709`", "0.`", 
      "0.26863`", "0.`", "0.33882`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.21614`", "0.18074`", "0.21775`", "0.28501`", "0.`", 
      "0.18389`", "0.`", "0.23568`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.27298`", "0.22246`", "0.2727`", "0.35189`", "0.`", "0.22606`",
       "0.`", "0.288`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734209778362384*^9, 3.7342098096890717`*^9, 3.734210007912529*^9, 
   3.7342100640297623`*^9, 3.73421014744561*^9, 3.734210561342683*^9, 
   3.734210631915956*^9, 3.734372656399588*^9, 3.7343727642109623`*^9, 
   3.7343728814903517`*^9, 3.734373121655263*^9, 3.734373291457176*^9, 
   3.73437335469812*^9, {3.734463610831706*^9, 3.734463634956539*^9}, 
   3.734530837867292*^9, 3.734539181738381*^9, 3.7345393517711897`*^9, 
   3.734539426245406*^9, 3.734544081514656*^9, 3.734546320531526*^9, 
   3.734546475286251*^9, 3.734546600359851*^9, 3.7345484712461576`*^9, 
   3.7345485416275473`*^9, 3.734549265377204*^9, 3.734550449733987*^9, 
   3.734705971961162*^9, 3.7347061185867147`*^9, 3.7347063319082193`*^9, 
   3.734706577388275*^9},ExpressionUUID->"27112c52-84b5-48d9-91e5-\
44f1396d29bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compare", " ", "to", " ", "an", " ", "analytical", " ", "approximation"}],
    " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"2.", "-", "nodeType"}], ")"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"init", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
         ")"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{"ms", ",", "2"}], "]"}]}], ")"}], "]"}]}], "]"}], ".", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"ms", ",", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"ms", ",", "2"}], "]"}]}], ")"}], "]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"(", 
        RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "h", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7347058470183*^9, 3.734705859620875*^9}, {
  3.734705897374658*^9, 3.734705929514371*^9}, {3.734706057480566*^9, 
  3.734706072966937*^9}},ExpressionUUID->"586c396f-2d4a-46a6-9a75-\
53083e7c6012"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.2606024647442589`", "0.2151047253386173`", 
      "0.26060239618389724`", "0.3362277156231616`", "0.`", 
      "0.21510456157594796`", "0.`", "0.27386807215080117`"},
     {"0.`", "0.22038938083026766`", "0.1819135434088058`", 
      "0.22038921304430553`", "0.2843465922400964`", "0.`", 
      "0.1819131426367508`", "0.`", "0.23161025204952507`"},
     {"0.`", "0.2606023961838973`", "0.215104561575948`", 
      "0.26060246474425885`", "0.3362277156231616`", "0.`", 
      "0.21510472533861721`", "0.`", "0.27386807215080117`"},
     {"0.`", "0.32542072182662585`", "0.26860804010813144`", 
      "0.32542072182662585`", "0.4198580689954208`", "0.`", 
      "0.2686080401081314`", "0.`", "0.34198895840394794`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.2203892130443056`", "0.1819131426367508`", 
      "0.2203893808302676`", "0.28434659224009634`", "0.`", 
      "0.18191354340880572`", "0.`", "0.231610252049525`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.2708087876394256`", "0.22353133588216736`", 
      "0.2708087876394256`", "0.349399065127588`", "0.`", 
      "0.22353133588216728`", "0.`", "0.28459848311245933`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7347058474060173`*^9, 3.73470586015975*^9}, {
   3.734705899878983*^9, 3.7347059299246387`*^9}, 3.7347059768870792`*^9, 
   3.734706118755797*^9, 3.734706332059351*^9, 
   3.734706577654092*^9},ExpressionUUID->"ea6b6a92-f0fd-4ab7-abe2-\
625a9dfde541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Simple", " ", "ratio", " ", "comparison", " ", "between", " ", 
     "simulation", " ", "and", " ", "analytic", " ", "results"}], " ", "-", 
    " ", 
    RowBox[{"looks", " ", "like", " ", 
     RowBox[{"we", "'"}], "re", " ", "within", " ", "a", " ", "few", " ", 
     RowBox[{"percent", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}], ",", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}]}], "]"}], 
     "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VCI", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}], ",", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}]}], "]"}], 
       "]"}], "/", 
      RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}], ",", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}]}], "]"}],
         "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VCI", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}], ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"nodeType", ",", "1"}], "]"}], "//", "Flatten"}]}], 
           "]"}], "]"}], "/", 
         RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], ")"}]}], 
      ")"}], "//", "Flatten"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.734706159983061*^9, 3.7347061624519653`*^9}, {
  3.7347062581417*^9, 3.734706293471607*^9}, {3.7347063965869303`*^9, 
  3.734706414274672*^9}, {3.73470645262682*^9, 3.7347064758785353`*^9}, {
  3.734706732872018*^9, 
  3.734706742922858*^9}},ExpressionUUID->"6a892daf-82a2-43ab-9193-\
8ca9fc372214"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.0157564107587267`", ",", "1.0130202756834195`", ",", 
     "1.014372333439326`", ",", "1.0039944925890938`", ",", 
     "1.012494994473749`", ",", "1.0015288796884299`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.016931436093889`", ",", "1.0259632474694365`", ",", 
     "1.0153377547420324`", ",", "1.01672182300603`", ",", 
     "1.0196353491214103`", ",", "1.0046859499827574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.9983236139438297`", ",", "1.002304466594977`", ",", 
     "0.990959254484215`", ",", "0.9904781583195712`", ",", 
     "1.0004405624790345`", ",", "1.0004678605640431`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.0086186518306033`", ",", "1.0214787043966058`", ",", 
     "1.007369743148297`", ",", "1.0066366227802652`", ",", 
     "0.9999182522731317`", ",", "1.0093529260490761`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.0196595403178754`", ",", "1.0064907747966736`", ",", 
     "1.0121211519185653`", ",", "0.9976723351464732`", ",", 
     "0.9892519626342146`", ",", "0.9827318909093898`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.9920462584783707`", ",", "1.0048158585011568`", ",", 
     "0.9930648611640104`", ",", "0.9929212683724687`", ",", 
     "0.9888141904015186`", ",", "0.9881891774738172`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.734706476444907*^9, 
  3.7347065778852*^9},ExpressionUUID->"8ca6eefc-0d93-4636-b079-38995c24892b"],

Cell[BoxData["1.0045714176118468`"], "Output",
 CellChangeTimes->{3.734706476444907*^9, 
  3.73470657792692*^9},ExpressionUUID->"d2304e02-42dd-431a-9cad-13a55b2be3aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Suppressing", " ", "and", " ", "replacing", " ", 
    RowBox[{"complexinfinity", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Indeterminate", "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"h", "/", "VCI"}], "*", 
      RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.734707091300276*^9, 
  3.7347070931692247`*^9}},ExpressionUUID->"542e21b3-b445-4b85-b9ec-\
cc58fe4f6d10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Network", " ", "Visualization", " ", "of", " ", "the", " ", "VC"}], "-", 
    
    RowBox[{"influence", " ", "matrix"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"markovPDF", "=", 
     RowBox[{
     "CalculateMarkovSteadyState", "[", "migrationDimensionalMatrix", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colorsType", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<LakeColors\>\"", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "1", ",", 
         RowBox[{"1", "/", "networkDimension"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesSwatchType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"colorsType", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", ".75", "]"}], ",", 
            RowBox[{"Thickness", "[", ".005", "]"}]}], "]"}], "]"}]}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", "networkDimension", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stylesListType", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"stylesSwatchType", "[", 
          RowBox[{"[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"nodeType", "//", "Length"}], "]"}], ",", "nodeType"}], 
        "}"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"markovDimensional", "=", 
    RowBox[{"GraphPlotWrapper", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{".5", "*", 
           RowBox[{"VCI", "/", 
            RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}]}], ")"}],
          "//", "LowerTriangularize"}], ",", "edgeChopThreshold"}], "]"}], 
      ",", ".1", ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"VertexList", "[", "originalMap", " ", "]"}], "\[Rule]", 
        RowBox[{".25", "*", 
         RowBox[{"Log", "[", 
          RowBox[{"5", "+", 
           RowBox[{"7.5", "*", 
            RowBox[{"Rescale", "[", "markovPDF", "]"}]}]}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", "stylesListType"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.734119702404113*^9, 3.734119773529461*^9}, 
   3.7341199155970182`*^9, {3.734539213350245*^9, 3.73453922335248*^9}, {
   3.734548604039173*^9, 3.73454860974207*^9}, {3.734550249935762*^9, 
   3.73455025057052*^9}, {3.7347063669085712`*^9, 
   3.734706370801363*^9}},ExpressionUUID->"a838f197-7fe6-472d-9281-\
3d0ed90358d9"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "1", "2", "3", "4", "5", "6", "7", "8", "9"}, {{{2, 2}, {3, 2}, {3, 
       3}, {4, 2}, {4, 3}, {4, 4}, {5, 2}, {5, 3}, {5, 4}, {5, 5}, {7, 2}, {7,
        3}, {7, 4}, {7, 5}, {7, 7}, {9, 2}, {9, 3}, {9, 4}, {9, 5}, {9, 7}, {
       9, 9}}, Null}, {
      Background -> GrayLevel[1], 
       EdgeLabels -> {
        DirectedEdge["9", "4"] -> Placed[0.13506, Tooltip], 
         DirectedEdge["3", "3"] -> Placed[0.08922, Tooltip], 
         DirectedEdge["2", "2"] -> Placed[0.12543, Tooltip], 
         DirectedEdge["7", "3"] -> Placed[0.09092, Tooltip], 
         DirectedEdge["7", "2"] -> Placed[0.11113, Tooltip], 
         DirectedEdge["4", "2"] -> Placed[0.12605, Tooltip], 
         DirectedEdge["9", "3"] -> Placed[0.10937, Tooltip], 
         DirectedEdge["5", "3"] -> Placed[0.13184, Tooltip], 
         DirectedEdge["9", "5"] -> Placed[0.17064, Tooltip], 
         DirectedEdge["7", "4"] -> Placed[0.10928, Tooltip], 
         DirectedEdge["9", "7"] -> Placed[0.11209, Tooltip], 
         DirectedEdge["3", "2"] -> Placed[0.10781, Tooltip], 
         DirectedEdge["7", "7"] -> Placed[0.09041, Tooltip], 
         DirectedEdge["5", "4"] -> Placed[0.16012, Tooltip], 
         DirectedEdge["4", "3"] -> Placed[0.1033, Tooltip], 
         DirectedEdge["5", "2"] -> Placed[0.16106, Tooltip], 
         DirectedEdge["4", "4"] -> Placed[0.12512, Tooltip], 
         DirectedEdge["9", "2"] -> Placed[0.13751, Tooltip], 
         DirectedEdge["9", "9"] -> Placed[0.14038, Tooltip], 
         DirectedEdge["5", "5"] -> Placed[0.20325, Tooltip], 
         DirectedEdge["7", "5"] -> Placed[0.14135, Tooltip]}, 
       EdgeShapeFunction -> {$CellContext`edgeshape2}, 
       EdgeStyle -> {DirectedEdge["9", "7"] -> {
           Opacity[0.8906750000000001], 
           Thickness[0.00056045]}, DirectedEdge["5", "2"] -> {
           Opacity[1.2579500000000001`], 
           Thickness[0.0008053]}, DirectedEdge["9", "5"] -> {
           Opacity[1.3297999999999999`], 
           Thickness[0.0008531999999999999]}, DirectedEdge["4", "4"] -> {
           Opacity[0.9884000000000002], 
           Thickness[0.0006256]}, DirectedEdge["7", "4"] -> {
           Opacity[0.8696], 
           Thickness[0.0005464]}, DirectedEdge["4", "2"] -> {
           Opacity[0.995375], 
           Thickness[0.00063025]}, DirectedEdge["7", "7"] -> {
           Opacity[0.728075], 
           Thickness[0.00045205]}, DirectedEdge["5", "3"] -> {
           Opacity[1.0388], 
           Thickness[0.0006592]}, DirectedEdge["3", "2"] -> {
           Opacity[0.8585750000000001], 
           Thickness[0.00053905]}, DirectedEdge["9", "9"] -> {
           Opacity[1.1028499999999999`], 
           Thickness[0.0007019]}, DirectedEdge["7", "2"] -> {
           Opacity[0.883475], 
           Thickness[0.00055565]}, DirectedEdge["9", "4"] -> {
           Opacity[1.06295], 
           Thickness[0.0006753]}, DirectedEdge["7", "5"] -> {
           Opacity[1.110125], 
           Thickness[0.00070675]}, DirectedEdge["4", "3"] -> {
           Opacity[0.82475], 
           Thickness[0.0005164999999999999]}, DirectedEdge["7", "3"] -> {
           Opacity[0.7319], 
           Thickness[0.0004546]}, DirectedEdge["9", "3"] -> {
           Opacity[0.8702749999999999], 
           Thickness[0.00054685]}, DirectedEdge["5", "5"] -> {
           Opacity[1.5743749999999999`], 
           Thickness[0.0010162499999999998`]}, DirectedEdge["5", "4"] -> {
           Opacity[1.2509000000000001`], 
           Thickness[0.0008006]}, DirectedEdge["3", "3"] -> {
           Opacity[0.71915], 
           Thickness[0.00044609999999999995`]}, DirectedEdge["9", "2"] -> {
           Opacity[1.081325], 
           Thickness[0.00068755]}, DirectedEdge["2", "2"] -> {
           Opacity[0.9907250000000002], 
           Thickness[0.0006271500000000001]}}, 
       EdgeWeight -> {0.12543, 0.10781, 0.08922, 0.12605, 0.1033, 0.12512, 
        0.16106, 0.13184, 0.16012, 0.20325, 0.11113, 0.09092, 0.10928, 
        0.14135, 0.09041, 0.13751, 0.10937, 0.13506, 0.17064, 0.11209, 
        0.14038}, Epilog -> {}, Frame -> False, FrameStyle -> 
       Thickness[Large], GraphLayout -> Automatic, ImagePadding -> 0, 
       ImageSize -> 250, PerformanceGoal -> "Speed", Prolog -> {}, 
       VertexCoordinates -> {{0, 0}, {0, 50}, {0, 100}, {50, 0}, {50, 50}, {
        50, 100}, {100, 0}, {100, 50}, {100, 100}}, VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {0.0001}, 
       VertexSize -> {
        "4" -> 0.4485583028219154, "7" -> 0.40235947810852507`, "3" -> 
         0.40235947810852507`, "8" -> 0.6314321610770639, "5" -> 
         0.5103637388853087, "9" -> 0.46056612023610133`, "2" -> 
         0.44855830282191567`, "6" -> 0.6314321610770639, "1" -> 
         0.5863373987377415}, VertexStyle -> {"5" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "6" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "1" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "4" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "9" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "7" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "8" -> Directive[
           Opacity[1], 
           RGBColor[0.663226, 0.6872815, 0.9117649999999999], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "3" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]], "2" -> Directive[
           Opacity[1], 
           RGBColor[0.941176, 0.906538, 0.834043], 
           EdgeForm[
            Directive[
             Opacity[0.75], 
             Thickness[0.005]]]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006271500000000001], Opacity[0.9907250000000002], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQjQo8HRoaDDQZeg/YX3h4vc/omoeDgYJe2/ZlP+1b
39W2PT3o6tCwqMk3YeUX+4wzp4oCZzg5HPjPp/3w/4v9F9PEZ58xsXd48i93
sdBpwQPp/0Il1LmtHDxMrv2/fUXpwJNtzSZbZc0cdl3aYfV1ot6Bq3OUb8vs
NXaQEa7982Sq6YEpajFM+lLGDqxM+4LOnrc+EFX0zuWvo4mDjPhiodzdDgdS
Xuu3n5Uxd9gU9PJ4DbfzgU+fy3UZC6wdYh5NDpmxwuVAS97h9JRCB4e0TzJv
5hS6HqiR//N2YZOzg3jLzStZYa4HTjyv/LRnjZuDxkf1eoNIlwPM93pW7Frn
6bAuNXmXbZ/TgejdC35d9/JxCGFMm58k5XDg3J0bR2q9/Rx2JEh6fY+3OrB0
RbFzb7u/w8QphxnPi5ocmCwypWDNU38HKb4HUs/XaR/IWKAw3S/O36HqbEWv
sZfCgU0LjSL9//g6LIjz/3hnLveBNokTu4TveDs0HPN9zHP74P7CL9+FnDU9
HdDDHwBnKbVA
             "]]}},
          "0.12543`"],
         Annotation[#, 0.12543, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00053905], Opacity[0.8585750000000001], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{0., 100.}, {0., 50.}}]}},
          "0.10781`"],
         Annotation[#, 0.10781, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00044609999999999995`], Opacity[0.71915], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQjQoiHRImGz/fonJh/63SdwrRHyIcVG7q7hVpFj2g
arrQMp4pwkHuk29wyTq1A/5HIzc+rwx3+Hr0YGDjSsMDAqW+h54lhjsEvJY/
cOaq+QGz046BnnvCHfZVxTRGxdoecNHMSjnfGOFQdGryDv/nDgeuBFoyLVwU
6XDIWiXeMN3pQMhbq/bJ7NEOXx4wd7XzOx/Y+qI6inVKjEOs5NIpFy85HZj1
OOSGpkacw2/3ROV3Wx0PXOG39p62ON5B69MEz7z59gdc5YxOvi1OcAi0f6MT
2Wd14F/gjY7qtwkOWX3BicsXmBwId9NM3WKS6LDB9f5lrQU6B2x/NDx66Jzo
sCLruuUcG4UDH/hOhp+RTHTosdJyVwhhOTD3k8q7yzsTHHasK32q1vPfPqJf
O2C1doLDLJ/Hr7OsRRyu/GI3KP4a5/BrncbtyQ8lHWoLC0ISsmId+FYnv2pJ
lHBw2ZfZde5qtINL9M3TElv4HSbeveRtGBHlcMBbRHmf53l7cDALRDqghz8A
wOmvJw==
             "]]}},
          "0.08922`"],
         Annotation[#, 0.08922, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00063025], Opacity[0.995375], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 50.}}]}},
          "0.12605`"],
         Annotation[#, 0.12605, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005164999999999999], Opacity[0.82475], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 0.}, {0., 100.}}]}},
          "0.1033`"],
         Annotation[#, 0.1033, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006256], Opacity[0.9884000000000002], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGeDjBW4ZfvQs6ang4Nx3wf89w+uL9T4sQu4Tve
Djvi/D/emct9YPNCo0j/P74OpWcreo29FA5kLVCY7hfn7yDG90Dq+TrtA1NF
phSseerv0DflMON5UZMDK1YUO/e2+ztsS5D0+h5vdeDinRtHar39HIIZ0+Yn
STkciNu94Nd1Lx+HtanJu2z7nA6w3etZsWudp4PGR/V6g0iXA2eeV37as8bN
Qbzl5pWsMNcD9fJ/3i5scnZI/yTzZk6h64GOvMPpKYUODrGPJofMWOFy4Mfn
cl3GAmuHzUEvj9dwOx/Ifq3fflbG3EFOfLFQ7m6HAwlF71z+Opo4cDLtCzp7
3vrADLUYJn0pYwdF4do/T6aaHrgxR/m2zF5jh0OXdlh9nah34Nm2ZpOtsmYO
QSbX/t++onQg41+ohDq3lcOXf7mLhU4LHriSJj77jIm9w4P/fNoP/7/Yn37m
VFHgDCeHhEVNvgkrv9i3vatte3rQ1UFBQa9t+7Kf9hceXu8zuubhwNBooMnQ
e8AePfwBFrm1KA==
             "]]}},
          "0.12512`"],
         Annotation[#, 0.12512, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0008053], Opacity[1.2579500000000001`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 50.}}]}},
          "0.16106`"],
         Annotation[#, 0.16106, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006592], Opacity[1.0388], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {0., 100.}}]}},
          "0.13184`"],
         Annotation[#, 0.13184, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0008006], Opacity[1.2509000000000001`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{50., 50.}, {50., 0.}}]}},
          "0.16012`"],
         Annotation[#, 0.16012, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0010162499999999998`], Opacity[1.5743749999999999`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGeDjC64svry5elAx2mH8rbn7zJ30Fh7vv0skuB
Dv7nq43OOgc47N2yqGfhrCCHydJc75k7AhwS6iL+RecEOxx3USqVWxzg8Nav
+o+XfYiDTeDUeI4pAQ6mH79Vs3OHOty+d78tOjrAoUXp17Xi46EOLcsmH9j8
zd+h2MVhAl9umMNVL5EPa977OdjxPr1r9zXMwaY695HMGl+Hv9XG76dHhTss
js8zem7h46C4J8NeYGa4w2oNgfirS7wcXv6wO6i1Lhzufph86PX3C7Si3eH6
4xZMPCtx3NXBHmr+kZZJso+DXeD2a299zR8s4Ax3X01kjr0PpxPc/V5ODp88
PB0d3kH91x571eH9dQe4/4vKdose3ukAD59bJ14r/njvAA+/pESO2akVjvDw
zbSd6DDH18kBPfwBKvuoRQ==
             "]]}},
          "0.20325`"],
         Annotation[#, 0.20325, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00055565], Opacity[0.883475], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 50.}}]}},
          "0.11113`"],
         Annotation[#, 0.11113, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0004546], Opacity[0.7319], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {0., 100.}}]}},
          "0.09092`"],
         Annotation[#, 0.09092, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0005464], Opacity[0.8696], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 0.}}]}},
          "0.10928`"],
         Annotation[#, 0.10928, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00070675], Opacity[1.110125], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 0.}, {50., 50.}}]}},
          "0.14135`"],
         Annotation[#, 0.14135, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00045205], Opacity[0.728075], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGRDjDWZOPnW1QEgHwfEeV9nuftJ9295G0YEeWQ
EH3ztMQWfgeXfZld565GO4isTn7VkijhUFtYEJKQFevAsF7j9uSHkg5XfrEb
FH+Nc1ji8/h1lrWIQ0S/dsBq7QSHB+tKn6r1/Lef+0nl3eWdCQ4NVlruCiEs
Bz7wnQw/I5nosCjruuUcG4UDtj8aHj10TnRY5Xr/stYCnQPhbpqpW0wSHTL6
ghOXLzA58D/wRkf12wQHP/s3OpF9Vgdc5YxOvi1OcFD7NMEzb779gcv81t7T
Fsc7/HJPVH631fHArMchNzQ14hxiJJdOuXjJ6cDWF9VRrFNiHD4/YO5q53c+
EPLWqn0ye7TDQWuVeMN0pwNXAi2ZFi6KdCg6NXmH/3OHAy6aWSnnGyMc9lXF
NEbF2h4wO+0Y6Lkn3CHgtfyBM1fNDwiU+h56lhju8OXowcDGlYYH/I9Gbnxe
Ge4g88k3uGSd2gE104WW8UwRDnw3dfeKNIseuFX6TiH6Q4SDAjigL+xHD38A
yputRw==
             "]]}},
          "0.09041`"],
         Annotation[#, 0.09041, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00068755], Opacity[1.081325], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 50.}}]}},
          "0.13751`"],
         Annotation[#, 0.13751, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00054685], Opacity[0.8702749999999999], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {0., 100.}}]}},
          
          "0.10937`"],
         Annotation[#, 0.10937, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0006753], Opacity[1.06295], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 0.}}]}},
          "0.13506`"],
         Annotation[#, 0.13506, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0008531999999999999], Opacity[1.3297999999999999`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {50., 50.}}]}},
          
          "0.17064`"],
         Annotation[#, 0.17064, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.00056045], Opacity[0.8906750000000001], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[{{100., 100.}, {100., 0.}}]}},
          
          "0.11209`"],
         Annotation[#, 0.11209, "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          {Thickness[0.0007019], Opacity[1.1028499999999999`], 
           {Arrowheads[{{1.*^-9, 1}}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQGRDjD6Vuk7hegPEQ6TjZ9vURGIdFA1XWgZzxTh
MOnuJW/DiCgH/6ORG59Xhjs478vsOnc12kGg1PfQs8Rwh9rCgpCErFgHs9OO
gZ57wh2u/GI3KP4a5+CimZVyvjHCIaJfO2C1doLD5UBLpoWLIh3mfFJ5d3ln
gkPIW6v2yezRDh/4ToafkUx02PqiOop1SoyD7Y+GRw+dEx1mPQ65oakR5xDu
ppm6xSTR4TK/tfe0xfEO/wNvdFS/TXBwlTM6+bYYQf+Dil+BqoPpg5kDM3cb
1B6YvaFQd8yFuusK1J0wd7tC/QHzF8yfMH/DwsEFGi6wcJoIDTdYOMLCFRbO
6OEPAC99p+A=
             "]]}},
          "0.14038`"],
         Annotation[#, 0.14038, "Tooltip"]& ]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 0.}, 14.658434968443537]}, InsetBox[
          StyleBox["\<\"1\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 50.}, 11.213957570547892]}, InsetBox[
          StyleBox["\<\"2\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{0., 100.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"3\"\>",
           StripOnInput->False,
           FontSize->0.0001], {0., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 0.}, 11.213957570547885]}, InsetBox[
          StyleBox["\<\"4\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 50.}, 12.759093472132719]}, InsetBox[
          StyleBox["\<\"5\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{50., 100.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"6\"\>",
           StripOnInput->False,
           FontSize->0.0001], {50., 100.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 0.}, 10.058986952713127]}, InsetBox[
          StyleBox["\<\"7\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 0.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.663226, 0.6872815, 0.9117649999999999], Opacity[1], 
          EdgeForm[{Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 50.}, 15.785804026926598]}, InsetBox[
          StyleBox["\<\"8\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 50.},
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.941176, 0.906538, 0.834043], Opacity[1], EdgeForm[{
          Opacity[0.75], Thickness[0.005]}], 
          DiskBox[{100., 100.}, 11.514153005902534]}, InsetBox[
          StyleBox["\<\"9\"\>",
           StripOnInput->False,
           FontSize->0.0001], {100., 100.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  Background->GrayLevel[1],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameStyle->Thickness[Large],
  FrameTicks->None,
  ImagePadding->0,
  ImageSize->250]], "Output",
 CellChangeTimes->{
  3.734119720340057*^9, 3.7341197510874567`*^9, 3.73412252654661*^9, 
   3.734202681855893*^9, 3.734207231808936*^9, 3.734207885307434*^9, 
   3.734210633816553*^9, 3.734372666361145*^9, 3.734372769304948*^9, 
   3.734372900651164*^9, 3.73446354007777*^9, 3.734463640002551*^9, 
   3.734539202443207*^9, 3.734548484265875*^9, {3.734548551878456*^9, 
   3.7345486101818943`*^9}, {3.734706361605258*^9, 3.734706371127318*^9}, 
   3.734706478873105*^9},ExpressionUUID->"c2f9969d-6ab4-4a7d-a667-\
2c5e50d93f51"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Some notes one how we can calculate VCI from the Markov Matrix \
\>", "Subsection",
 CellChangeTimes->{{3.734106583298367*^9, 3.734106603888835*^9}, {
  3.7341077694989634`*^9, 3.734107782765037*^9}, {3.7341198008176193`*^9, 
  3.734119809199407*^9}, {3.734120950285625*^9, 3.7341209667793827`*^9}, {
  3.734372770444607*^9, 3.73437277497725*^9}, {3.734548565096814*^9, 
  3.734548572871496*^9}, {3.7345486997670107`*^9, 
  3.7345487054985647`*^9}},ExpressionUUID->"b6717bd0-fe3b-4bc2-b8bf-\
906fa4331f8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Visualize", " ", "the", " ", "VC"}], "-", 
    RowBox[{"influence", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"1.", "*", 
    RowBox[{"VCI", "/", 
     RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.734118571247315*^9, 3.734118577340452*^9}, 
   3.734118613753275*^9, {3.7341195011629963`*^9, 3.734119556799581*^9}, {
   3.734119602818775*^9, 3.7341196072154293`*^9}, {3.7341197778511333`*^9, 
   3.7341197818159857`*^9}, 3.734119912198392*^9, {3.73420975770667*^9, 
   3.734209778118647*^9}, 
   3.734209808799264*^9},ExpressionUUID->"04b58bae-5d04-4171-b437-\
389cfc27dd2f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.0529`", "0.0464`", "0.0572`", "0.0707`", "0.`", "0.0462`", 
      "0.`", "0.0547`"},
     {"0.`", "0.0419`", "0.0372`", "0.0441`", "0.0549`", "0.`", "0.0367`", 
      "0.`", "0.045`"},
     {"0.`", "0.0501`", "0.0425`", "0.0494`", "0.0681`", "0.`", "0.0394`", 
      "0.`", "0.0525`"},
     {"0.`", "0.0572`", "0.0449`", "0.0594`", "0.0701`", "0.`", "0.0491`", 
      "0.`", "0.0602`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.0411`", "0.0373`", "0.0439`", "0.06`", "0.`", "0.0359`", 
      "0.`", "0.049`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.0501`", "0.0411`", "0.0522`", "0.0644`", "0.`", "0.0431`", 
      "0.`", "0.0522`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734209778362384*^9, 3.7342098096890717`*^9, 3.734210007912529*^9, 
   3.7342100640297623`*^9, 3.73421014744561*^9, 3.734210561342683*^9, 
   3.734210631915956*^9, 3.734372656399588*^9, 3.7343727642109623`*^9, 
   3.7343728814903517`*^9, 3.734373121655263*^9, 3.734373291457176*^9, 
   3.73437335469812*^9, {3.734463610831706*^9, 3.734463634956539*^9}, 
   3.734530837867292*^9, 3.734539181738381*^9, 3.7345393517711897`*^9, 
   3.734539426245406*^9, 3.734544081514656*^9, 3.734546320531526*^9, 
   3.734546475286251*^9, 3.734546600359851*^9, 3.7345484712461576`*^9, 
   3.7345485416275473`*^9},ExpressionUUID->"dc613808-d51f-4948-89ea-\
69fc31645f50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compare", " ", "to", " ", "an", " ", "analytical", " ", "approximation"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"2.", "-", "nodeType"}], ")"}]}], ")"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"init", "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
        ")"}], "]"}], ".", " ", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"ms", ",", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
      "\[IndentingNewLine]", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", "ms"}], 
        ")"}], "]"}], ".", "\[IndentingNewLine]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"(", 
        RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "h", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7345485141709843`*^9, 3.734548522488165*^9}, {
  3.7345490034283447`*^9, 3.7345490035885277`*^9}, {3.734549135717025*^9, 
  3.7345491563763523`*^9}},ExpressionUUID->"3f7c51a0-b892-4f9a-8407-\
10bbec590a2d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.0499105304181162`", "0.041196812730183906`", 
      "0.04991051728744986`", "0.06439426290342952`", "0.`", 
      "0.0411967813663912`", "0.`", "0.05245115681867138`"},
     {"0.`", "0.046536128615748976`", "0.03841179652634237`", 
      "0.04653609318704963`", "0.0600409581354827`", "0.`", 
      "0.0384117119016666`", "0.`", "0.04890546194874776`"},
     {"0.`", "0.04991051728744986`", "0.0411967813663912`", 
      "0.04991053041811621`", "0.06439426290342953`", "0.`", 
      "0.04119681273018392`", "0.`", "0.05245115681867139`"},
     {"0.`", "0.053664841169016986`", "0.044295912467441405`", 
      "0.05366484116901699`", "0.0692384199128339`", "0.`", 
      "0.04429591246744141`", "0.`", "0.056397094294699586`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04653609318704964`", "0.0384117119016666`", 
      "0.04653612861574897`", "0.0600409581354827`", "0.`", 
      "0.03841179652634237`", "0.`", "0.048905461948747765`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.049502358128762636`", "0.040860299764618246`", 
      "0.04950235812876263`", "0.063868228954335`", "0.`", 
      "0.040860299764618246`", "0.`", "0.052023038678839846`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7345485230265923`*^9, 3.73454854410072*^9}, 
   3.734549004207008*^9, {3.7345491386471367`*^9, 
   3.734549159537859*^9}},ExpressionUUID->"ab694752-02be-453c-8134-\
4964fbf802e3"]
}, Open  ]],

Cell["\<\
How did we come up with that huge expression?  We can divide it up into 4 \
parts:\
\>", "Text",
 CellChangeTimes->{{3.734548719806554*^9, 
  3.734548743843074*^9}},ExpressionUUID->"d19656cc-aad9-4ac6-a6f6-\
6016ad238396"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "the", " ", "vector", " ", "that", " ", 
     "represents", " ", "the", " ", "initial", " ", "conditions"}], ",", " ", 
    
    RowBox[{
    "a", " ", "superposition", " ", "of", " ", "the", " ", "probability", " ",
      "of", " ", "the", " ", "first", " ", "visit", " ", "to", " ", "each", 
     " ", "blood", " ", "feeding", " ", "site"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"init", "[", 
      RowBox[{"[", 
       RowBox[{";;", 
        RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"2.", "-", "nodeType"}], ")"}]}], ")"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "all", " ", "blood", " ", "feeding", " ", 
     "nodes"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"init", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "all", " ", "egg", " ", "laying", " ", "nodes"}],
      ",", " ", 
     RowBox[{
     "where", " ", "all", " ", "who", " ", "start", " ", "at", " ", "egg", 
      " ", "laying", " ", "nodes", " ", "need", " ", "1", " ", "extra", " ", 
      "step", " ", "to", " ", "get", " ", "to", " ", "the", " ", "very", " ", 
      "first", " ", "blood", " ", "feeding", " ", "node"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Lastly", " ", "we", " ", "convert", " ", "to", " ", "a", " ", 
      "diagonal", " ", "matrix"}], ",", " ", 
     RowBox[{
     "in", " ", "order", " ", "to", " ", "get", " ", "out", " ", "a", " ", 
      "full", " ", "matrix", " ", "VCI", " ", "and", " ", "not", " ", "just", 
      " ", "a", " ", "single", " ", "vector"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"init", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"2.", "-", "nodeType"}], ")"}]}], ")"}], "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"init", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
      ")"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.734548746388776*^9, 3.734548923035421*^9}, {
  3.734549107050591*^9, 
  3.734549109211152*^9}},ExpressionUUID->"b0a6d06e-a010-48a8-96c4-\
b25b9e57c050"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", "0.`", ",", 
   "0.1111111111111111`", ",", "0.`", ",", "0.1111111111111111`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7345491096847897`*^9, 
  3.734549161516494*^9},ExpressionUUID->"b7cb6812-82e6-4cde-ac1d-\
a90587042e47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.0518511060919651`", ",", "0.04083406951050323`", ",", 
   "0.0518511060919651`", ",", "0.06411002978811811`", ",", "0.`", ",", 
   "0.04083406951050323`", ",", "0.`", ",", "0.0505196190069452`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7345491096847897`*^9, 
  3.734549161536707*^9},ExpressionUUID->"f2e46739-1a24-47ce-86ac-\
f40d1557fee3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.16296221720307622`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.15194518062161433`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.16296221720307622`", "0.`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.17522114089922922`", "0.`", "0.`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.15194518062161433`", "0.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.16163073011805631`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7345491096847897`*^9, 
  3.734549161553143*^9},ExpressionUUID->"3814268c-b89c-4f5e-a44b-\
5d16c7691429"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "time", " ", "delay", " ", "between", 
    " ", "reaching", " ", "the", " ", "initial", " ", "blood", " ", "feeding",
     " ", "site", " ", "and", " ", "the", " ", "end", " ", "of", " ", "the", 
    " ", "EIP"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{"ms", ",", 
     RowBox[{
      RowBox[{"Ceiling", "[", 
       RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.73454893288144*^9, 3.734548958308813*^9}, {
  3.7345491149831743`*^9, 
  3.734549120211446*^9}},ExpressionUUID->"369d1968-b43b-48cd-8337-\
a31bd6bb1bff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.10246043103179303`", "0.`", "0.`", "0.`", "0.`", 
      "0.1231090045341035`", "0.`", "0.12310900453410352`", "0.`"},
     {"0.`", "0.05819222633119249`", "0.048031813150751834`", 
      "0.05819215034827549`", "0.07507798497099473`", "0.`", 
      "0.04803163165863286`", "0.`", "0.061152633640152644`"},
     {"0.`", "0.058190971797021915`", "0.048032351042456276`", 
      "0.058190751917694364`", "0.07507834685423678`", "0.`", 
      "0.04803182584065231`", "0.`", "0.06115419264793837`"},
     {"0.`", "0.058192150348275504`", "0.04803163165863287`", 
      "0.05819222633119249`", "0.07507798497099474`", "0.`", 
      "0.048031813150751834`", "0.`", "0.06115263364015265`"},
     {"0.`", "0.05819098399586929`", "0.04803205473797997`", 
      "0.05819098399586928`", "0.0750783135331153`", "0.`", 
      "0.04803205473797997`", "0.`", "0.06115404909918622`"},
     {"0.10245689530807608`", "0.`", "0.`", "0.`", "0.`", 
      "0.12311107298832247`", "0.`", "0.12311047180360152`", "0.`"},
     {"0.`", "0.05819075191769438`", "0.04803182584065231`", 
      "0.05819097179702191`", "0.07507834685423678`", "0.`", 
      "0.048032351042456276`", "0.`", "0.06115419264793839`"},
     {"0.10245689530807608`", "0.`", "0.`", "0.`", "0.`", 
      "0.1231104718036015`", "0.`", "0.12311107298832245`", "0.`"},
     {"0.`", "0.05819008241026299`", "0.048032303526484146`", 
      "0.05819008241026298`", "0.07507855949848063`", "0.`", 
      "0.048032303526484146`", "0.`", "0.06115510872802511`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734549120690707*^9, 
  3.734549163151585*^9},ExpressionUUID->"295edd04-a403-48cc-ba40-\
53bdf77499df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "an", " ", "algebraic", " ", "way", " ", "of", " ",
     "summing", " ", "over", " ", "the", " ", "probabilities", " ", "of", " ",
     "visiting", " ", "any", " ", "particular", " ", "blood", " ", "feeding", 
    " ", "site"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"ms", ",", "1"}], "]"}]}], ")"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Is", " ", "derived", " ", "from", " ", "summing", " ", "over", " ", 
     "the", " ", "matrix", " ", "raised", " ", "to", " ", "higher", " ", 
     "and", " ", "higher", " ", "powers"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"x", "^", "n"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7345489662556477`*^9, 3.734549061034418*^9}, {
  3.7345490992639513`*^9, 
  3.734549101784657*^9}},ExpressionUUID->"74d6f871-4552-45e3-8b7a-\
30a309df6825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.315142931896432`", "0.8947013826008255`", "0.623776687561624`", 
      "0.8947013826008254`", "0.9915298280463364`", "1.4740074814202047`", 
      "0.623776687561624`", "1.4740074814202049`", "0.7083561368919223`"},
     {"1.5753114659025742`", "1.7401578534066922`", "0.5895319187495586`", 
      "0.7325196100076486`", "0.9111717016824179`", "1.6462179595289927`", 
      "0.5712872785772753`", "1.5153126798315903`", "0.718489532313249`"},
     {"1.3305895070252898`", "0.7142231993143654`", "1.6159601330252258`", 
      "0.6921196543496978`", "0.920220213775006`", "1.892533115892165`", 
      "0.5631638023318687`", "1.5137194823457016`", "0.7574708919406775`"},
     {"1.575311465902574`", "0.7325196100076485`", "0.5712872785772752`", 
      "1.740157853406692`", "0.9111717016824179`", "1.51531267983159`", 
      "0.5895319187495587`", "1.646217959528993`", "0.718489532313249`"},
     {"1.3531227696194534`", "0.7062253725985698`", "0.5887192450421203`", 
      "0.7062253725985697`", "1.919387053971921`", "1.6918596678218514`", 
      "0.5887192450421204`", "1.6918596678218518`", "0.7538816054835401`"},
     {"1.2267358572081934`", "0.7781268149499029`", "0.7383799666016139`", 
      "0.7162511029511041`", "1.0317733134375002`", "2.5484283058105235`", 
      "0.590584191860618`", "1.4879937317181238`", "0.8817267154624177`"},
     {"1.3305895070252898`", "0.6921196543496978`", "0.5631638023318688`", 
      "0.7142231993143655`", "0.9202202137750062`", "1.5137194823457016`", 
      "1.6159601330252256`", "1.8925331158921657`", "0.7574708919406776`"},
     {"1.2267358572081934`", "0.7162511029511042`", "0.590584191860618`", 
      "0.778126814949903`", "1.0317733134375005`", "1.4879937317181235`", 
      "0.7383799666016141`", "2.5484283058105244`", "0.8817267154624178`"},
     {"1.1867897676238819`", "0.6836821671858074`", "0.5949399414628334`", 
      "0.6836821671858073`", "0.9255371607578352`", "1.7750261688196367`", 
      "0.5949399414628335`", "1.7750261688196372`", "1.7803765166817234`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734549026021409*^9, 3.734549061955092*^9, 
  3.7345491023981533`*^9, 
  3.734549164679347*^9},ExpressionUUID->"2cb05533-bfe3-4548-b211-\
09271b57edaf"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "-", "x"}]]], "Output",
 CellChangeTimes->{3.734549026021409*^9, 3.734549061955092*^9, 
  3.7345491023981533`*^9, 
  3.7345491647073298`*^9},ExpressionUUID->"9dc2fef5-2d40-4b73-8069-\
05db7bcd7cd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Need", " ", "one", " ", "more", " ", "part", " ", "to", " ", "pull", " ", 
    "out", " ", "only", " ", "the", " ", "columns", " ", "that", " ", 
    "correspond", " ", "to", " ", "blood", " ", "feeding", " ", 
    RowBox[{"sites", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"(", 
     RowBox[{"2", "-", "nodeType"}], ")"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.734549070659719*^9, 
  3.734549095470199*^9}},ExpressionUUID->"c4fca229-9502-4c86-b6fc-\
fdddf9b032a4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.73454909034335*^9, 3.734549095890033*^9}, 
   3.73454916620061*^9},ExpressionUUID->"c6f2940d-793d-46f2-8288-\
cad82d1296b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"And", " ", "then"}], ",", " ", 
    RowBox[{
    "to", " ", "get", " ", "to", " ", "the", " ", "case", " ", "where", " ", 
     "we", " ", "enumerate", " ", "all", " ", "secondary", " ", "bites", " ", 
     "by", " ", "summing", " ", "over", " ", "all", " ", "primary", " ", 
     "bites"}], ",", " ", 
    RowBox[{
    "all", " ", "we", " ", "need", " ", "to", " ", "do", " ", "is", " ", 
     "further", " ", "adjust", " ", "the", " ", "initial", " ", "conditions", 
     " ", 
     RowBox[{"(", 
      RowBox[{"first", " ", "term", " ", "in", " ", "the", " ", "sum"}], 
      ")"}], " ", "to", " ", "sum", " ", "over", " ", "all", " ", "primary", 
     " ", "bites"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"init", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"2.", "-", "nodeType"}], ")"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"init", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
     ")"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"ms", ",", "2"}], "]"}]}], ")"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.734706657735793*^9, 
  3.734706702202676*^9}},ExpressionUUID->"f90c0874-ea2d-4578-8e5d-\
70292fb8dda9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.850889684151624`", ",", "0.`", ",", "0.`", ",", "0.`", ",",
      "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.7195936850236376`", ",", "0.`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.8508896841516239`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.0625316111739935`", 
     ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.7195936850236375`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.8842209487210974`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.734706666245831*^9, 
  3.734706688996154*^9}},ExpressionUUID->"cf708028-5406-41d8-a74d-\
e0f806e34eb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"init", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"2.", "-", "nodeType"}], ")"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
       ")"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"ms", ",", "2"}], "]"}]}], ")"}], "]"}]}], "]"}], ".", " ", 
    
    RowBox[{"MatrixPower", "[", 
     RowBox[{"ms", ",", 
      RowBox[{
       RowBox[{"Ceiling", "[", 
        RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
    "\[IndentingNewLine]", 
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", "ms"}], 
      ")"}], "]"}], ".", "\[IndentingNewLine]", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"(", 
      RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "h", "]"}]}], "Input",
 CellChangeTimes->{{3.734723713140233*^9, 
  3.734723723785523*^9}},ExpressionUUID->"ceebd6b7-255b-4921-878e-\
c64e3e9c4db7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.26060246474425885`", "0.21510472533861724`", 
      "0.26060239618389724`", "0.33622771562316145`", "0.`", 
      "0.21510456157594796`", "0.`", "0.2738680721508011`"},
     {"0.`", "0.2203893808302676`", "0.18191354340880575`", 
      "0.22038921304430553`", "0.2843465922400963`", "0.`", 
      "0.18191314263675076`", "0.`", "0.23161025204952496`"},
     {"0.`", "0.26060239618389724`", "0.21510456157594798`", 
      "0.26060246474425885`", "0.3362277156231615`", "0.`", 
      "0.21510472533861721`", "0.`", "0.2738680721508011`"},
     {"0.`", "0.3254207218266258`", "0.2686080401081314`", 
      "0.3254207218266258`", "0.4198580689954207`", "0.`", 
      "0.2686080401081314`", "0.`", "0.34198895840394783`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.22038921304430553`", "0.18191314263675074`", 
      "0.22038938083026757`", "0.2843465922400963`", "0.`", 
      "0.18191354340880575`", "0.`", "0.23161025204952496`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.27080878763942556`", "0.22353133588216728`", 
      "0.2708087876394256`", "0.34939906512758795`", "0.`", 
      "0.22353133588216728`", "0.`", "0.2845984831124593`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.73472372417161*^9},ExpressionUUID->"cbc2b576-a241-4205-8bf5-1f187f42d4e6"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VC-influence matrix, with additional interventions added", "Section",
 CellChangeTimes->{{3.734106583298367*^9, 3.734106603888835*^9}, {
  3.7341077694989634`*^9, 3.734107782765037*^9}, {3.7341198008176193`*^9, 
  3.734119809199407*^9}, {3.734547707393124*^9, 3.734547708796422*^9}, {
  3.7347095006595993`*^9, 3.734709506588216*^9}, {3.734709676958529*^9, 
  3.734709679627076*^9}},ExpressionUUID->"4afda1f0-ead6-4091-ae21-\
2029b4a50078"],

Cell[CellGroupData[{

Cell["\<\
Define function for calculating VCI:
vci = calculateVCI[mosEnsemble, mosMatrix]\
\>", "Subsection",
 CellChangeTimes->{{3.734106583298367*^9, 3.734106603888835*^9}, {
  3.73472511093302*^9, 
  3.7347251353478413`*^9}},ExpressionUUID->"9fe54bcc-f173-4110-a1b2-\
10815ac38eff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Define", " ", "our", " ", "VCI"}], "-", 
     RowBox[{
     "calculating", " ", "function", " ", "\[IndentingNewLine]", "First", " ", 
      RowBox[{"argument", ":", " ", 
       RowBox[{"the", " ", "ensemble"}]}]}]}], ",", " ", 
    RowBox[{"output", " ", "from", " ", "RandomFunction"}], ",", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"Second", " ", 
     RowBox[{"argument", ":", " ", 
      RowBox[{"the", " ", "Markov", " ", "Matrix"}]}]}]}], " ", 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"calculateVCI", "[", 
    RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "VCI", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VCI", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "Y", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "Y", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Select", " ", "a", " ", "chain"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mosChain", " ", "=", " ", 
          RowBox[{
           RowBox[{"X", "[", "\"\<Paths\>\"", "]"}], "[", 
           RowBox[{"[", "chainIndex", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mosChain", " ", "=", " ", 
          RowBox[{"Cases", "[", 
           RowBox[{"mosChain", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_", ",", "a_"}], "}"}], "/;", 
             RowBox[{"a", "<", 
              RowBox[{"Length", "[", "mosMatrixInsecticide", "]"}]}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tDeath", " ", "=", " ", 
          RowBox[{"Length", "[", "mosChain", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Look", " ", "at", " ", "the", " ", "node", " ", "type", " ", "at",
             " ", "each", " ", "place", " ", "visited"}], ",", " ", 
           RowBox[{"just", " ", "to", " ", "verify", " ", 
            RowBox[{"we", "'"}], "re", " ", "alternating"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"pathNodeTypes", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"nodeType", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"nodeType", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"mosChain", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Add", " ", "the", " ", "type", " ", "visited", " ", "to", " ", 
           "each"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mosChain", " ", "=", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "mosChain", "]"}], ",", 
             RowBox[{"{", "pathNodeTypes", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "These", " ", "are", " ", "all", " ", "of", " ", "the", " ", 
           "indexes", " ", "of", " ", "the", " ", "relevant", " ", "starting",
            " ", "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"tIndexes", " ", "=", "  ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"mosChain", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"tDeath", "-", "EIP"}], ",", "1"}], "]"}]}], "]"}], 
              "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "//", 
           "Flatten"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Count", " ", "visits", " ", "to", " ", "blood", " ", "feeding", 
           " ", "sites", " ", "following", " ", "initial", " ", "infection", 
           " ", "at", " ", "each", " ", "blood", " ", "feeding", " ", 
           "site"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Loop", " ", "over", " ", "all", " ", "starting", " ", "indices"}],
            " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Subset", " ", "our", " ", "chain", " ", "according", " ", "to", 
             " ", "the", " ", "times", " ", "when", " ", "secondary", " ", 
             "infections", " ", "could", " ", "occur", "\[IndentingNewLine]", 
             "Between", " ", "t"}], " ", "=", " ", 
            RowBox[{"i", " ", "+", " ", 
             RowBox[{"EIP", " ", "and", " ", "tDeath"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"subMosChain", " ", "=", " ", 
             RowBox[{"mosChain", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "EIP"}], ",", 
                  RowBox[{"tDeath", " ", "+", " ", "1"}]}], "]"}], ";;", 
                "tDeath"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Find", " ", "where", " ", "the", " ", "secondary", " ", 
              "infectious", " ", 
              RowBox[{"occur", ":", "\[IndentingNewLine]", 
               RowBox[{
               "Find", " ", "the", " ", "Location", " ", "of", " ", "all", 
                " ", "rows", " ", "in", " ", "the", " ", "subChain", " ", 
                "where", " ", "we", " ", "visit", " ", "a", " ", "feeding", 
                " ", "site"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"bitesMosChain", " ", "=", " ", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"subMosChain", ",", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_", ",", "1"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"Add", " ", "biting", " ", "event", " ", "counts"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"VCI", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"mosChain", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"bitesMosChain", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+=", 
               "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "bitesMosChain", "]"}]}], "}"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "End", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tIndexes"}], "}"}]}], "]"}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Right", " ", "now"}], ",", " ", 
          RowBox[{"only", " ", "the", " ", "first"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"End", " ", "loop", " ", "over", " ", "chain"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"chainIndex", ",", "1", ",", 
          RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "VCI"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.734714705441874*^9, 3.734714730174178*^9}, {
   3.7347147802563753`*^9, 3.734714809465757*^9}, {3.734714890062688*^9, 
   3.734714893038437*^9}, {3.734714933390225*^9, 3.73471498539603*^9}, {
   3.734715059449671*^9, 3.73471508219762*^9}, {3.7347154306794853`*^9, 
   3.734715483357994*^9}, 
   3.7347194472159452`*^9},ExpressionUUID->"bdf643b5-73b2-4a7a-a3cf-\
220507e0ad43"]
}, Closed]],

Cell[CellGroupData[{

Cell["Adding in Mosquito Death Transitions", "Subsection",
 CellChangeTimes->{{3.734106583298367*^9, 
  3.734106603888835*^9}},ExpressionUUID->"6479ac30-fcbb-4d07-aa80-\
6822f4e5ba04"],

Cell["Add increased hazard rate at each of the egg-laying sites", "Text",
 CellChangeTimes->{{3.734709839093405*^9, 
  3.73470985142142*^9}},ExpressionUUID->"0fc72fd1-a5c2-4162-8d93-\
6894d344f4e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "migrationDimensionalMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.734106449548587*^9, 
  3.7341064852897797`*^9}},ExpressionUUID->"e4fa08f7-4ccf-42e8-98bd-\
0565c60f308f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.273230029966562`", "0.10841056431164799`", 
      "0.273230029966562`", "0.1863114596276546`", "0.`", 
      "0.10841056431164799`", "0.`", "0.05040735181592544`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.3280408237744218`", "0.`", "0.19087978213318785`", "0.`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.582831994409532`", "0.`", "0.18591544004870342`", "0.`"},
     {"0.48107939409239037`", "0.`", "0.`", "0.`", "0.`", 
      "0.19087978213318785`", "0.`", "0.3280408237744218`", "0.`"},
     {"0.2542558691955294`", "0.`", "0.`", "0.`", "0.`", 
      "0.37287206540223533`", "0.`", "0.37287206540223533`", "0.`"},
     {"0.`", "0.15505684402214034`", "0.2273944191267633`", 
      "0.09022418693094873`", "0.2273944191267633`", "0.`", 
      "0.07253571166662104`", "0.`", "0.2273944191267633`"},
     {"0.23125256554176443`", "0.`", "0.`", "0.`", "0.`", 
      "0.18591544004870342`", "0.`", "0.582831994409532`", "0.`"},
     {"0.`", "0.09022418693094873`", "0.07253571166662104`", 
      "0.15505684402214034`", "0.2273944191267633`", "0.`", 
      "0.2273944191267633`", "0.`", "0.2273944191267633`"},
     {"0.08445318143306342`", "0.`", "0.`", "0.`", "0.`", 
      "0.45777340928346827`", "0.`", "0.45777340928346827`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734201906852261*^9, 3.7342076706520643`*^9, 3.7342080412258177`*^9, 
   3.734372590080538*^9, 3.734372846437299*^9, 3.7344705392634706`*^9, {
   3.7347097159955263`*^9, 3.7347097365843773`*^9}, 
   3.734723218786084*^9},ExpressionUUID->"17daeb10-9206-4ea1-99ec-\
b06417e1e8af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Hazard", " ", "Rates"}], ",", " ", 
    RowBox[{"with", " ", "interventions"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mosHazardRatesInsecticide", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{".1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sampledCoordinates", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Let", "'"}], "s", " ", "poison", " ", "all", " ", "of", " ", 
      "the", " ", "Egg"}], "-", 
     RowBox[{"Laying", " ", "sites"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mosHazardRatesInsecticide", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"nodeType", ",", "2"}], "]"}], "//", "Flatten"}], "]"}], 
      "]"}], "=", ".15"}], ";"}], "\[IndentingNewLine]", 
   "mosHazardRatesInsecticide"}]}]], "Input",
 CellChangeTimes->{{3.73410649327499*^9, 3.734106508160863*^9}, 
   3.734107901076932*^9, {3.734709746986287*^9, 3.734709808812303*^9}, {
   3.734714414881982*^9, 3.7347144302897463`*^9}, {3.734719364875431*^9, 
   3.7347193788021803`*^9}, {3.734719592490638*^9, 3.734719592609618*^9}, {
   3.734719654122847*^9, 3.734719654526198*^9}, {3.734719706307439*^9, 
   3.734719707895145*^9}, {3.734723213431349*^9, 
   3.734723216067581*^9}},ExpressionUUID->"2e4e40ec-96ed-4668-8035-\
6a7bc659ebfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.15`", ",", "0.1`", ",", "0.1`", ",", "0.1`", ",", "0.1`", ",", "0.15`", 
   ",", "0.1`", ",", "0.15`", ",", "0.1`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.734709753941752*^9, {3.7347097913288*^9, 3.73470980939108*^9}, 
   3.734714430753705*^9, 3.734719593007244*^9, 3.734719655016733*^9, 
   3.734719708362021*^9, 
   3.7347232196305017`*^9},ExpressionUUID->"32c55ea5-fdc3-4484-b7f4-\
b89d0b24b534"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mosMatrixInsecticide", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"migrationDimensionalMatrix", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"mosHazardRatesInsecticide", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"mosHazardRatesInsecticide", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", "1.", "}"}]}], "]"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mosMatrixInsecticide", "]"}]}], "Input",
 CellChangeTimes->{{3.734106524396489*^9, 3.7341065435775623`*^9}, {
  3.734709820026326*^9, 3.734709820164166*^9}, {3.734714437104678*^9, 
  3.734714453129401*^9}},ExpressionUUID->"db617dac-031e-4add-b2d8-\
a0f74138996f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.23224552547157767`", "0.09214897966490078`", 
      "0.23224552547157767`", "0.15836474068350642`", "0.`", 
      "0.09214897966490078`", "0.`", "0.04284624904353662`", "0.15`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.29523674139697964`", "0.`", "0.17179180391986906`", "0.`", "0.1`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", "0.5245487949685789`",
       "0.`", "0.16732389604383308`", "0.`", "0.1`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.17179180391986906`", "0.`", "0.29523674139697964`", "0.`", "0.1`"},
     {"0.22883028227597646`", "0.`", "0.`", "0.`", "0.`", 
      "0.3355848588620118`", "0.`", "0.3355848588620118`", "0.`", "0.1`"},
     {"0.`", "0.13179831741881928`", "0.1932852562577488`", 
      "0.07669055889130642`", "0.1932852562577488`", "0.`", 
      "0.06165535491662788`", "0.`", "0.1932852562577488`", "0.15`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", 
      "0.16732389604383308`", "0.`", "0.5245487949685789`", "0.`", "0.1`"},
     {"0.`", "0.07669055889130642`", "0.06165535491662788`", 
      "0.13179831741881928`", "0.1932852562577488`", "0.`", 
      "0.1932852562577488`", "0.`", "0.1932852562577488`", "0.15`"},
     {"0.07600786328975707`", "0.`", "0.`", "0.`", "0.`", 
      "0.4119960683551214`", "0.`", "0.4119960683551214`", "0.`", "0.1`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734709822975891*^9, {3.734714442063431*^9, 3.734714454004566*^9}, 
   3.734719594059133*^9, 3.734719656768477*^9, 3.734719709364873*^9, 
   3.7347232212147093`*^9},ExpressionUUID->"00349dbd-ca24-47da-a013-\
8989c037fd18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"And", " ", "without", " ", "insecticide"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mosHazardRates", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{".1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sampledCoordinates", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mosMatrix", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"migrationDimensionalMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"mosHazardRates", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"mosHazardRates", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "migrationDimensionalMatrix", "]"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"{", "1.", "}"}]}], "]"}], "}"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "mosMatrix", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7347193296633368`*^9, 3.734719342477318*^9}, {
  3.734719400285906*^9, 
  3.734719418569377*^9}},ExpressionUUID->"eb3bf756-52f3-45bd-8f6a-\
98b4596b70c7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.2459070269699058`", "0.09756950788048319`", 
      "0.2459070269699058`", "0.16768031366488914`", "0.`", 
      "0.09756950788048319`", "0.`", "0.0453666166343329`", "0.1`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.29523674139697964`", "0.`", "0.17179180391986906`", "0.`", "0.1`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", "0.5245487949685789`",
       "0.`", "0.16732389604383308`", "0.`", "0.1`"},
     {"0.43297145468315135`", "0.`", "0.`", "0.`", "0.`", 
      "0.17179180391986906`", "0.`", "0.29523674139697964`", "0.`", "0.1`"},
     {"0.22883028227597646`", "0.`", "0.`", "0.`", "0.`", 
      "0.3355848588620118`", "0.`", "0.3355848588620118`", "0.`", "0.1`"},
     {"0.`", "0.1395511596199263`", "0.20465497721408699`", 
      "0.08120176823785386`", "0.20465497721408699`", "0.`", 
      "0.06528214049995894`", "0.`", "0.20465497721408699`", "0.1`"},
     {"0.208127308987588`", "0.`", "0.`", "0.`", "0.`", 
      "0.16732389604383308`", "0.`", "0.5245487949685789`", "0.`", "0.1`"},
     {"0.`", "0.08120176823785386`", "0.06528214049995894`", 
      "0.1395511596199263`", "0.20465497721408699`", "0.`", 
      "0.20465497721408699`", "0.`", "0.20465497721408699`", "0.1`"},
     {"0.07600786328975707`", "0.`", "0.`", "0.`", "0.`", 
      "0.4119960683551214`", "0.`", "0.4119960683551214`", "0.`", "0.1`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734719342864778*^9, 3.734719420541214*^9, 
  3.73471971095317*^9, 
  3.734723222801355*^9},ExpressionUUID->"85083021-b9a1-4668-bcdb-\
1eb9d940b3ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform Simulation", "Subsection",
 CellChangeTimes->{{3.734547724539934*^9, 3.734547757038802*^9}, {
  3.734549214269977*^9, 3.734549222725067*^9}, {3.734709878564229*^9, 
  3.734709904169526*^9}},ExpressionUUID->"0732ae54-d385-48da-8477-\
2e416c581996"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1.", "/", 
          RowBox[{"Length", "[", "nodeType", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "nodeType", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"init", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "nodeType", "]"}], "+", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"init", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "init"}]}]], "Input",
 CellChangeTimes->{{3.734714626655838*^9, 
  3.7347146299552507`*^9}},ExpressionUUID->"84999e52-6ed6-4285-9a0d-\
d48ad994f85d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0.1111111111111111`", ",", 
   "0.1111111111111111`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7347146312421293`*^9, 3.7347194269624434`*^9, 
  3.734719713077491*^9},ExpressionUUID->"9aef6a51-8d40-4cd1-bdc1-\
40f4631176f3"]
}, Open  ]],

Cell["With Insecticide", "Item",
 CellChangeTimes->{{3.734714565106996*^9, 
  3.734714590551774*^9}},ExpressionUUID->"45d62966-ec63-4fca-9052-\
9bd71140e887"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pInsecticide", " ", "=", " ", 
   RowBox[{"DiscreteMarkovProcess", "[", 
    RowBox[{"init", ",", "mosMatrixInsecticide"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomSeed", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mosEnsembleInsecticide", " ", "=", " ", 
   RowBox[{"RandomFunction", "[", 
    RowBox[{"pInsecticide", ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100"}], "}"}], ",", "10000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msInsecticide", " ", "=", " ", 
   RowBox[{"mosMatrixInsecticide", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{";;", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{";;", 
       RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.734713942481379*^9, {3.7347140567776213`*^9, 3.7347140582068644`*^9}, {
   3.734714158278236*^9, 3.73471418569023*^9}, {3.734714276267047*^9, 
   3.734714285636805*^9}, {3.73471445800662*^9, 3.734714488802862*^9}, {
   3.7347145583126593`*^9, 3.7347145622499733`*^9}, {3.734714621950027*^9, 
   3.734714624188036*^9}, 3.734719553677699*^9, {3.734719627411956*^9, 
   3.7347196276495028`*^9}},ExpressionUUID->"3deba83a-dbaf-4d84-8c84-\
d8dae0f3b77d"],

Cell["Without Insecticide (for comparison)", "Item",
 CellChangeTimes->{{3.734714565106996*^9, 
  3.73471459758812*^9}},ExpressionUUID->"a591d1f0-2ae0-48ff-b3e9-\
07f4f76b259e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", " ", "=", " ", 
   RowBox[{"DiscreteMarkovProcess", "[", 
    RowBox[{"init", ",", "mosMatrix"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomSeed", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mosEnsemble", " ", "=", " ", 
   RowBox[{"RandomFunction", "[", 
    RowBox[{"P", ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100"}], "}"}], ",", "10000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ms", " ", "=", " ", 
   RowBox[{"mosMatrix", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{";;", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{";;", 
       RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.734714642790164*^9, 3.7347146438035097`*^9}, 
   3.734719550876514*^9, {3.734719628837044*^9, 
   3.7347196344276943`*^9}},ExpressionUUID->"1cf184a1-6b09-4fd9-9620-\
27eb6d327196"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulated and analytically calculated VCI", "Subsection",
 CellChangeTimes->{{3.734547724539934*^9, 3.734547757038802*^9}, {
  3.734549214269977*^9, 3.734549222725067*^9}, {3.734709878564229*^9, 
  3.734709888809936*^9}},ExpressionUUID->"1a578081-d84a-41a0-bef5-\
1cddbcd7a97d"],

Cell["\<\
That is to say, count ALL of the visits to blood feeding sites that occur >= \
EIP time steps after an initial visit to ANY blood feeding site\
\>", "Text",
 CellChangeTimes->{{3.7345477485720577`*^9, 3.734547790356044*^9}, {
  3.734547821360917*^9, 3.73454782787048*^9}, {3.7345492269754257`*^9, 
  3.73454924960783*^9}},ExpressionUUID->"6c0dc212-a263-47f7-b7c2-\
ecbf86c5adfc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vciInsecticide", " ", "=", " ", 
   RowBox[{"calculateVCI", "[", 
    RowBox[{"mosEnsembleInsecticide", ",", " ", "mosMatrixInsecticide"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "vciInsecticide", "]"}]}], "Input",
 CellChangeTimes->{{3.734714991133069*^9, 3.7347149954656563`*^9}, {
  3.7347150868569403`*^9, 3.734715087741248*^9}, {3.73471529964786*^9, 
  3.734715334171775*^9}},ExpressionUUID->"b502f975-c769-463e-b424-\
ad6360662250"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1152", "967", "1292", "1562", "0", "1022", "0", "1349"},
     {"0", "999", "901", "1086", "1235", "0", "874", "0", "1109"},
     {"0", "1129", "1023", "1339", "1509", "0", "1109", "0", "1319"},
     {"0", "1478", "1304", "1662", "1955", "0", "1378", "0", "1669"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1017", "827", "1060", "1340", "0", "859", "0", "1162"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1242", "969", "1197", "1480", "0", "1058", "0", "1302"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734715040624549*^9, 3.734715142227665*^9, 3.7347153569351463`*^9, 
   3.7347154481224623`*^9, 3.734719564155397*^9, 3.7347196028338223`*^9, {
   3.734719639938653*^9, 3.734719674031643*^9}, 3.734719723122202*^9, 
   3.734723237733885*^9},ExpressionUUID->"79d56b78-3597-467b-a449-\
92a26f52d5d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vci", " ", "=", " ", 
   RowBox[{"calculateVCI", "[", 
    RowBox[{"mosEnsemble", ",", " ", "mosMatrix"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "vci", "]"}]}], "Input",
 CellChangeTimes->{{3.734715396931665*^9, 
  3.73471541332967*^9}},ExpressionUUID->"16016ea5-cb25-44f2-98b0-\
bedd80b6d825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "2436", "2019", "2559", "3398", "0", "2086", "0", "2634"},
     {"0", "2245", "1718", "2130", "2902", "0", "1799", "0", "2175"},
     {"0", "2581", "2082", "2574", "3296", "0", "2102", "0", "2573"},
     {"0", "3198", "2621", "3453", "4272", "0", "2713", "0", "3312"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "2138", "1798", "2245", "3041", "0", "1948", "0", "2429"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "2626", "2247", "2870", "3638", "0", "2241", "0", "2826"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.734715501595401*^9, 3.734715704567161*^9, 
  3.734719517513711*^9, 3.734719567110405*^9, 3.7347196056443653`*^9, 
  3.734719642814781*^9, 3.734719691246085*^9, 3.734719728496138*^9, 
  3.734723240046545*^9},ExpressionUUID->"bdc4eb8a-b2eb-4356-95af-\
ac48c463e093"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "And", " ", "we", " ", "can", " ", "compare", " ", "the", " ", "total", 
    " ", "number", " ", "of", " ", "secondary", " ", "bites", " ", "that", 
    " ", "each", " ", "feeding", " ", "site", " ", "is", " ", "responsible", 
    " ", "for"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"vci", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "vci", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"vciInsecticide", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "vci", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.734715509550661*^9, 3.7347155162697773`*^9}, {
  3.7347236111282*^9, 
  3.734723638358347*^9}},ExpressionUUID->"66cbc6a9-c6a1-4001-b49d-\
a87ae18594a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "15132", ",", "12969", ",", "15208", ",", "19569", ",", "0", ",", 
   "13599", ",", "0", ",", "16448"}], "}"}]], "Output",
 CellChangeTimes->{{3.734715511556274*^9, 3.734715516662861*^9}, 
   3.7347157046951523`*^9, 3.734719517795868*^9, 3.734719575446281*^9, 
   3.7347232476622753`*^9, 
   3.7347236390894814`*^9},ExpressionUUID->"f409cdfd-8c20-4bd2-8ebc-\
80f7ddffccba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "7344", ",", "6204", ",", "7428", ",", "9446", ",", "0", ",", 
   "6265", ",", "0", ",", "7248"}], "}"}]], "Output",
 CellChangeTimes->{{3.734715511556274*^9, 3.734715516662861*^9}, 
   3.7347157046951523`*^9, 3.734719517795868*^9, 3.734719575446281*^9, 
   3.7347232476622753`*^9, 
   3.734723639118313*^9},ExpressionUUID->"5ce262bb-f51d-483f-8511-\
ca8ebb2ec0f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"1.", "*", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"vci", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "vci", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "/", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"vciInsecticide", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "vci", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.734723656096683*^9, 
  3.734723663393113*^9}},ExpressionUUID->"d60e5960-66d9-4d4e-8cac-\
895f796f88a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Indeterminate", ",", "2.060457516339869`", ",", "2.0904255319148937`", ",",
    "2.0473882606354334`", ",", "2.0716705483802667`", ",", "Indeterminate", 
   ",", "2.170630486831604`", ",", "Indeterminate", ",", 
   "2.2693156732891833`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.734723663785677*^9},ExpressionUUID->"c3c60628-c4fd-49ef-b200-\
7e1f60387520"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"init", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"2.", "-", "nodeType"}], ")"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", "ms"}]}], 
       ")"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"ms", ",", "2"}], "]"}]}], ")"}], "]"}]}], "]"}], ".", " ", 
    
    RowBox[{"MatrixPower", "[", 
     RowBox[{"ms", ",", 
      RowBox[{
       RowBox[{"Ceiling", "[", 
        RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
    "\[IndentingNewLine]", 
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "ms", "]"}], "]"}], " ", "-", " ", "ms"}], 
      ")"}], "]"}], ".", "\[IndentingNewLine]", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"(", 
      RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "h", "]"}]}], "Input",ExpressionUUID->"e9e99233-\
1dda-4201-bfcb-62b62cd41543"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.26060246474425885`", "0.21510472533861724`", 
      "0.26060239618389724`", "0.33622771562316145`", "0.`", 
      "0.21510456157594796`", "0.`", "0.2738680721508011`"},
     {"0.`", "0.2203893808302676`", "0.18191354340880575`", 
      "0.22038921304430553`", "0.2843465922400963`", "0.`", 
      "0.18191314263675076`", "0.`", "0.23161025204952496`"},
     {"0.`", "0.26060239618389724`", "0.21510456157594798`", 
      "0.26060246474425885`", "0.3362277156231615`", "0.`", 
      "0.21510472533861721`", "0.`", "0.2738680721508011`"},
     {"0.`", "0.3254207218266258`", "0.2686080401081314`", 
      "0.3254207218266258`", "0.4198580689954207`", "0.`", 
      "0.2686080401081314`", "0.`", "0.34198895840394783`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.22038921304430553`", "0.18191314263675074`", 
      "0.22038938083026757`", "0.2843465922400963`", "0.`", 
      "0.18191354340880575`", "0.`", "0.23161025204952496`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.27080878763942556`", "0.22353133588216728`", 
      "0.2708087876394256`", "0.34939906512758795`", "0.`", 
      "0.22353133588216728`", "0.`", "0.2845984831124593`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734723774762692*^9},ExpressionUUID->"6ef10fb8-34d2-46b5-8808-\
489eafc31418"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hInsecticide", " ", "=", " ", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"init", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"2.", "-", "nodeType"}], ")"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"init", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"nodeType", "-", "1."}], ")"}]}], ")"}], ".", 
         "msInsecticide"}]}], ")"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "msInsecticide", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"msInsecticide", ",", "2"}], "]"}]}], ")"}], "]"}]}], "]"}],
     ".", " ", 
    RowBox[{"MatrixPower", "[", 
     RowBox[{"msInsecticide", ",", 
      RowBox[{
       RowBox[{"Ceiling", "[", 
        RowBox[{"EIP", "/", "2."}], "]"}], "*", "2"}]}], "]"}], ".", 
    "\[IndentingNewLine]", 
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", "msInsecticide", "]"}], "]"}], " ", "-", " ", 
       "msInsecticide"}], ")"}], "]"}], ".", "\[IndentingNewLine]", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"(", 
      RowBox[{"2", "-", "nodeType"}], ")"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "hInsecticide", "]"}]}], "Input",
 CellChangeTimes->{{3.734723745451393*^9, 3.734723765379211*^9}, {
  3.7347237976535482`*^9, 3.734723835866129*^9}, {3.734723868941229*^9, 
  3.734723876042419*^9}, {3.734723977815127*^9, 
  3.734723978050519*^9}},ExpressionUUID->"bd93e207-109b-43f0-9786-\
3561a3c92bfb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.12584649889723368`", "0.10387525967696566`", 
      "0.12584645808466577`", "0.16236622241102677`", "0.`", 
      "0.10387516219242937`", "0.`", "0.13225230808012606`"},
     {"0.`", "0.10710984154654012`", "0.08841052636895723`", 
      "0.10710974102642329`", "0.13819325452164027`", "0.`", 
      "0.08841028626750125`", "0.`", "0.112563270661135`"},
     {"0.`", "0.12584645808466577`", "0.10387516219242937`", 
      "0.12584649889723365`", "0.16236622241102672`", "0.`", 
      "0.10387525967696568`", "0.`", "0.13225230808012606`"},
     {"0.`", "0.15583470210111164`", "0.12862875881708466`", 
      "0.15583470210111164`", "0.201058096133278`", "0.`", 
      "0.12862875881708466`", "0.`", "0.16376881785622813`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.10710974102642329`", "0.08841028626750125`", 
      "0.10710984154654012`", "0.13819325452164027`", "0.`", 
      "0.08841052636895724`", "0.`", "0.112563270661135`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.13044220372274545`", "0.10766990165140963`", 
      "0.13044220372274545`", "0.16829747210260468`", "0.`", 
      "0.10766990165140963`", "0.`", "0.13708463949479777`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7347237697142*^9, 3.73472382359791*^9, {3.734723871813586*^9, 
   3.7347238764930153`*^9}, 
   3.734723978626968*^9},ExpressionUUID->"50d97951-1d4b-4649-81b8-\
8392e793ddd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Comparing", " ", "with", " ", "the", " ", "simulation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{
    RowBox[{"vciInsecticide", "/", "1."}], "/", 
    RowBox[{"mosEnsemble", "[", "\"\<PathCount\>\"", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7347239794945717`*^9, 
  3.734723983473914*^9}},ExpressionUUID->"1ffa0756-0a31-4452-b946-\
c2d9fb8312c7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.11520000000000001`", "0.09670000000000001`", "0.1292`", 
      "0.1562`", "0.`", "0.1022`", "0.`", "0.13490000000000002`"},
     {"0.`", "0.0999`", "0.0901`", "0.1086`", "0.12350000000000001`", "0.`", 
      "0.0874`", "0.`", "0.1109`"},
     {"0.`", "0.1129`", "0.1023`", "0.13390000000000002`", "0.1509`", "0.`", 
      "0.1109`", "0.`", "0.13190000000000002`"},
     {"0.`", "0.14780000000000001`", "0.13040000000000002`", 
      "0.16620000000000001`", "0.1955`", "0.`", "0.1378`", "0.`", 
      "0.16690000000000002`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.1017`", "0.08270000000000001`", "0.10600000000000001`", 
      "0.134`", "0.`", "0.0859`", "0.`", "0.11620000000000001`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.1242`", "0.0969`", "0.1197`", "0.14800000000000002`", "0.`", 
      "0.1058`", "0.`", "0.1302`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.734723983901744*^9},ExpressionUUID->"792e0d7b-a10a-4b53-8add-\
deb728e542f5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{916, 783},
WindowMargins->{{15, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 195, 3, 98, "Title",ExpressionUUID->"b93f26bf-ec86-4921-8932-5b7bc7451b44"],
Cell[CellGroupData[{
Cell[800, 29, 168, 3, 67, "Section",ExpressionUUID->"84bafdf8-9794-4195-8c61-15f5fa49c2ce"],
Cell[971, 34, 2246, 39, 518, "Text",ExpressionUUID->"1a53b065-2d0a-4340-b45b-7858aed2d5b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3254, 78, 193, 3, 67, "Section",ExpressionUUID->"3a2a1455-9005-4fae-9827-0ad611b1e804"],
Cell[3450, 83, 347, 9, 81, "Text",ExpressionUUID->"8216e951-8bec-487b-b1c9-35f14ff3924a"],
Cell[CellGroupData[{
Cell[3822, 96, 157, 3, 54, "Subsection",ExpressionUUID->"f9de247d-6670-4550-9532-01cac2cb9dfe"],
Cell[CellGroupData[{
Cell[4004, 103, 24497, 594, 2686, "Input",ExpressionUUID->"e7410658-f0ce-416d-8652-8d0c1c6f5eb3"],
Cell[28504, 699, 2111, 31, 34, "Output",ExpressionUUID->"d8a87927-15bf-44c9-968a-0137e500b503"],
Cell[30618, 732, 2061, 30, 34, "Output",ExpressionUUID->"86dacd1c-0eac-414c-8e82-3d1c5721eb7f"],
Cell[32682, 764, 2058, 30, 34, "Output",ExpressionUUID->"9fa38f15-3125-4c58-825a-0f82b29cdc13"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[34789, 800, 156, 3, 38, "Subsection",ExpressionUUID->"d8a35b3a-798d-4eed-ab20-d4671c74d004"],
Cell[CellGroupData[{
Cell[34970, 807, 160, 3, 45, "Subsubsection",ExpressionUUID->"22066219-5034-4548-9426-eb6176f0c1c5"],
Cell[35133, 812, 1191, 27, 94, "Input",ExpressionUUID->"a25402cb-58e1-4e9b-912d-52e45c50bf85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36361, 844, 336, 5, 45, "Subsubsection",ExpressionUUID->"bc1b8081-6095-4c89-8258-568a5ae7c658"],
Cell[CellGroupData[{
Cell[36722, 853, 5142, 104, 325, "Input",ExpressionUUID->"cba831cb-c146-4a1d-a318-1333fdef0f6a"],
Cell[41867, 959, 2619, 47, 49, "Output",ExpressionUUID->"1c617976-4492-4ae3-a855-fed6f4de7e64"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44535, 1012, 264, 4, 45, "Subsubsection",ExpressionUUID->"3a2d7d1b-537d-4bf3-acf0-db159c3ccf9f"],
Cell[44802, 1018, 363, 10, 88, "Input",ExpressionUUID->"d6c8d334-155f-4b31-a117-4932cc78bf23"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45214, 1034, 215, 3, 54, "Subsection",ExpressionUUID->"7053704c-0f87-4dd3-9334-ae41c01f4a8f"],
Cell[45432, 1039, 964, 25, 94, "Input",ExpressionUUID->"97d229b1-6290-423c-8314-b8c40906d425"],
Cell[CellGroupData[{
Cell[46421, 1068, 3021, 72, 388, "Input",ExpressionUUID->"cc4ece86-d3d8-4758-ac3c-fee7beeb33de"],
Cell[49445, 1142, 2701, 75, 269, "Output",ExpressionUUID->"e982fbd2-0f13-4f2f-bc4f-d94863adf516"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[52195, 1223, 264, 4, 38, "Subsection",ExpressionUUID->"99f6d9b1-b686-4af0-8a93-8963a917bbf3"],
Cell[52462, 1229, 166, 3, 35, "Text",ExpressionUUID->"fd18c51a-13c8-44a5-a4fa-50498d95e437"],
Cell[52631, 1234, 848, 23, 52, "Input",ExpressionUUID->"5909f107-794e-41b3-840b-c9f75e05d982"],
Cell[CellGroupData[{
Cell[53504, 1261, 2639, 71, 262, "Input",ExpressionUUID->"79fb1f70-5016-448b-8f9d-64b6d719d1f2"],
Cell[56146, 1334, 24357, 489, 267, "Output",ExpressionUUID->"e91b7bfb-0400-470c-8d19-e34ade2dc5f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80552, 1829, 313, 5, 54, "Subsection",ExpressionUUID->"4b38f5f4-de95-4343-abf1-dd268ce6c1f3"],
Cell[CellGroupData[{
Cell[80890, 1838, 2454, 68, 262, "Input",ExpressionUUID->"190880cb-5db9-4dfd-a641-c8f839dd193b"],
Cell[83347, 1908, 24713, 497, 267, "Output",ExpressionUUID->"daa01908-1736-44cc-8881-f6fcd44cd318"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108109, 2411, 341, 5, 54, "Subsection",ExpressionUUID->"17fef265-a841-4939-b2bb-4823b6a08504"],
Cell[CellGroupData[{
Cell[108475, 2420, 3537, 80, 283, "Input",ExpressionUUID->"30825443-0650-4127-8ca5-f6ed12d07464"],
Cell[112015, 2502, 682, 13, 34, "Output",ExpressionUUID->"8e5d096c-2ba3-4151-825b-e94bfb5f5b5f"],
Cell[112700, 2517, 2503, 63, 269, "Output",ExpressionUUID->"3fc675f5-a3fb-4fa9-bbf1-d300c3231637"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115264, 2587, 186, 3, 67, "Section",ExpressionUUID->"be222b10-4087-496d-a6f2-5aca1e2ab1c4"],
Cell[CellGroupData[{
Cell[115475, 2594, 5087, 115, 451, "Input",ExpressionUUID->"42662eb5-7a47-4f2a-b71d-9b3e34330a6b"],
Cell[120565, 2711, 2499, 47, 167, "Output",ExpressionUUID->"46845ecb-9dd1-42c2-8015-0d8e938e0f3b"],
Cell[123067, 2760, 16151, 332, 267, "Output",ExpressionUUID->"24d04717-0f0b-4b7e-8673-182fdf9e33d3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139267, 3098, 219, 4, 67, "Section",ExpressionUUID->"de8adcce-c0c9-4105-bae1-522bec16baac"],
Cell[CellGroupData[{
Cell[139511, 3106, 184, 3, 54, "Subsection",ExpressionUUID->"43f047e4-89ba-49c9-b8d5-6e6452bf6610"],
Cell[CellGroupData[{
Cell[139720, 3113, 216, 4, 30, "Input",ExpressionUUID->"96d38dd7-bd59-4d9c-a51b-fd0da5df063b"],
Cell[139939, 3119, 2080, 40, 167, "Output",ExpressionUUID->"10367d3e-47e2-4df4-a5b7-601b72f8c0a1"]
}, Open  ]],
Cell[142034, 3162, 418, 11, 30, "Input",ExpressionUUID->"4e9faa9b-8179-491a-85a2-e63fcbac012e"],
Cell[142455, 3175, 1283, 36, 94, "Input",ExpressionUUID->"9d8d0291-c077-4179-a8a8-bf453a1577b6"],
Cell[CellGroupData[{
Cell[143763, 3215, 197, 4, 30, "Input",ExpressionUUID->"bc49d8c1-74fd-4e7d-9371-d39aa6a0864a"],
Cell[143963, 3221, 2235, 42, 185, "Output",ExpressionUUID->"1efbdf6d-4e43-4ea5-beb8-21387da32c1e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146247, 3269, 228, 4, 54, "Subsection",ExpressionUUID->"f380ba4f-7168-41b4-9025-e3b4a9d0f3a1"],
Cell[146478, 3275, 1592, 42, 136, "Input",ExpressionUUID->"b5665fc3-baaf-4d91-992b-b80acb8b963d"],
Cell[148073, 3319, 427, 11, 52, "Input",ExpressionUUID->"8c99bde9-47ab-4825-a8a5-168cc9590139"],
Cell[CellGroupData[{
Cell[148525, 3334, 1589, 38, 157, "Input",ExpressionUUID->"fd591928-944a-4818-92eb-1894c10988cd"],
Cell[150117, 3374, 1653, 48, 56, "Output",ExpressionUUID->"5900e9a5-824c-4783-b10b-fd3b831c913e"],
Cell[151773, 3424, 501, 8, 34, "Output",ExpressionUUID->"1c0be45d-b58a-4f2b-832c-2163dff45244"]
}, Open  ]],
Cell[152289, 3435, 1520, 42, 94, "Input",ExpressionUUID->"f034ee40-8a2f-409f-b7b0-c0b1f8857960"],
Cell[CellGroupData[{
Cell[153834, 3481, 1127, 27, 94, "Input",ExpressionUUID->"2476666b-e4af-4c9f-bcec-e835c1b84030"],
Cell[154964, 3510, 417, 8, 34, "Output",ExpressionUUID->"7f2b17fa-b47c-46b5-8bd5-8b223d13ee29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155418, 3523, 856, 21, 115, "Input",ExpressionUUID->"7065d5be-298c-4216-b5d3-47ab794ae9da"],
Cell[156277, 3546, 392, 6, 34, "Output",ExpressionUUID->"0ea6845d-16f2-4ba9-941c-d159855d0ab4"],
Cell[156672, 3554, 392, 6, 34, "Output",ExpressionUUID->"2004df59-8696-4340-aa8d-e2c53c1c80e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157101, 3565, 1455, 37, 115, "Input",ExpressionUUID->"a183dc9c-1934-4965-b890-35d0090c2461"],
Cell[158559, 3604, 908, 24, 34, "Output",ExpressionUUID->"75db1c68-2054-4365-9ad9-2b32adbd0482"],
Cell[159470, 3630, 386, 8, 34, "Output",ExpressionUUID->"42291a31-f6c6-4c88-857b-35813900d0b4"]
}, Open  ]],
Cell[159871, 3641, 438, 8, 58, "Text",ExpressionUUID->"8d7f8d4e-0639-43a4-8d1e-488fb126466c"],
Cell[CellGroupData[{
Cell[160334, 3653, 2395, 58, 241, "Input",ExpressionUUID->"cec37aeb-672c-44fe-86a8-3b36f5cc4238"],
Cell[162732, 3713, 356, 6, 34, "Output",ExpressionUUID->"09f8b16d-35a8-4d7e-95d5-8c3a2f23162e"],
Cell[163091, 3721, 356, 6, 34, "Output",ExpressionUUID->"36c5ac04-5a6b-48ef-ac54-88579a37513e"],
Cell[163450, 3729, 801, 20, 34, "Output",ExpressionUUID->"36544004-c8a3-463c-bf94-9981bf8e7bfe"],
Cell[164254, 3751, 409, 8, 34, "Output",ExpressionUUID->"c1897402-e142-42c7-90d1-ba92350991d1"]
}, Open  ]],
Cell[164678, 3762, 261, 6, 35, "Text",ExpressionUUID->"d7c859df-4673-4bec-bbf5-ddc79fa685eb"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164988, 3774, 322, 5, 67, "Section",ExpressionUUID->"903e25fa-15bc-4dda-a88e-a224e7bd3bad"],
Cell[165313, 3781, 910, 17, 219, "Text",ExpressionUUID->"9862123e-4e3c-46f4-8c7e-6f02c744a875"],
Cell[166226, 3800, 231, 7, 34, "Input",ExpressionUUID->"3c3c94bc-1c5c-4517-84de-e19093ab7296"],
Cell[CellGroupData[{
Cell[166482, 3811, 3441, 71, 157, "Input",ExpressionUUID->"c1b34467-3a7f-4cdc-9c9e-3b2a1f07fffe"],
Cell[169926, 3884, 653, 13, 34, "Output",ExpressionUUID->"a6eb847e-e562-4e2c-acb7-aeb89346890d"]
}, Open  ]],
Cell[170594, 3900, 374, 9, 52, "Input",ExpressionUUID->"6197a3a4-c2d9-43b2-aabb-9e9aff5de19f"],
Cell[170971, 3911, 751, 21, 73, "Input",ExpressionUUID->"76d04818-21b2-4bad-a54e-5c4ec447605b"],
Cell[CellGroupData[{
Cell[171747, 3936, 238, 6, 54, "Subsection",ExpressionUUID->"a26b1e65-1787-430f-9085-aac0f4b04000"],
Cell[171988, 3944, 343, 7, 58, "Text",ExpressionUUID->"263f27e4-86da-4113-9dbf-cce3e338cd4b"],
Cell[172334, 3953, 8789, 205, 661, "Input",ExpressionUUID->"86785f35-1c95-465d-8ea9-ba9ade9d8fe2"],
Cell[CellGroupData[{
Cell[181148, 4162, 755, 17, 52, "Input",ExpressionUUID->"0c5c6db4-3386-4c57-8fe1-31786ef972a2"],
Cell[181906, 4181, 2099, 42, 178, "Output",ExpressionUUID->"b9059e77-a23f-4a83-88b2-ed3fe593e425"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184042, 4228, 1749, 50, 115, "Input",ExpressionUUID->"07fbc456-747f-497d-8f6d-25a83e7ab541"],
Cell[185794, 4280, 2029, 39, 178, "Output",ExpressionUUID->"1fc43e96-b089-440e-8e57-0f4d1681fe95"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187860, 4324, 3250, 89, 304, "Input",ExpressionUUID->"c78a8d87-97a6-4ab9-9620-9607d705789f"],
Cell[191113, 4415, 19351, 420, 267, "Output",ExpressionUUID->"94f63c6d-bbe5-4667-ae7a-083ac3437e7c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[210513, 4841, 279, 6, 38, "Subsection",ExpressionUUID->"55c6004c-1fbe-453c-a343-1d0d4a6928ba"],
Cell[210795, 4849, 389, 7, 58, "Text",ExpressionUUID->"b51c86e2-4ef2-4e8a-bb26-224b9b250de3"],
Cell[211187, 4858, 8628, 199, 661, "Input",ExpressionUUID->"14093ed7-1a79-44c5-8762-d28fcad223e4"],
Cell[CellGroupData[{
Cell[219840, 5061, 755, 17, 52, "Input",ExpressionUUID->"46d552a8-4418-4217-9026-14166c6afa4d"],
Cell[220598, 5080, 2220, 43, 178, "Output",ExpressionUUID->"27112c52-84b5-48d9-91e5-44f1396d29bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222855, 5128, 2118, 58, 157, "Input",ExpressionUUID->"586c396f-2d4a-46a6-9a75-53083e7c6012"],
Cell[224976, 5188, 2130, 41, 178, "Output",ExpressionUUID->"ea6b6a92-f0fd-4ab7-abe2-625a9dfde541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227143, 5234, 2536, 70, 178, "Input",ExpressionUUID->"6a892daf-82a2-43ab-9193-8ca9fc372214"],
Cell[229682, 5306, 1512, 35, 140, "Output",ExpressionUUID->"8ca6eefc-0d93-4636-b079-38995c24892b"],
Cell[231197, 5343, 167, 2, 34, "Output",ExpressionUUID->"d2304e02-42dd-431a-9cad-13a55b2be3aa"]
}, Open  ]],
Cell[231379, 5348, 674, 18, 52, "Input",ExpressionUUID->"542e21b3-b445-4b85-b9ec-cc58fe4f6d10"],
Cell[CellGroupData[{
Cell[232078, 5370, 3346, 90, 304, "Input",ExpressionUUID->"a838f197-7fe6-472d-9281-3d0ed90358d9"],
Cell[235427, 5462, 19057, 419, 267, "Output",ExpressionUUID->"c2f9969d-6ab4-4a7d-a667-2c5e50d93f51"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[254533, 5887, 516, 9, 38, "Subsection",ExpressionUUID->"b6717bd0-fe3b-4bc2-b8bf-906fa4331f8b"],
Cell[CellGroupData[{
Cell[255074, 5900, 755, 17, 52, "Input",ExpressionUUID->"04b58bae-5d04-4171-b437-389cfc27dd2f"],
Cell[255832, 5919, 2039, 41, 178, "Output",ExpressionUUID->"dc613808-d51f-4948-89ea-69fc31645f50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257908, 5965, 1841, 51, 136, "Input",ExpressionUUID->"3f7c51a0-b892-4f9a-8407-10bbec590a2d"],
Cell[259752, 6018, 2079, 40, 178, "Output",ExpressionUUID->"ab694752-02be-453c-8134-4964fbf802e3"]
}, Open  ]],
Cell[261846, 6061, 232, 6, 35, "Text",ExpressionUUID->"d19656cc-aad9-4ac6-a6f6-6016ad238396"],
Cell[CellGroupData[{
Cell[262103, 6071, 2973, 81, 220, "Input",ExpressionUUID->"b0a6d06e-a010-48a8-96c4-b25b9e57c050"],
Cell[265079, 6154, 397, 9, 34, "Output",ExpressionUUID->"b7cb6812-82e6-4cde-ac1d-a90587042e47"],
Cell[265479, 6165, 400, 9, 34, "Output",ExpressionUUID->"f2e46739-1a24-47ce-86ac-f40d1557fee3"],
Cell[265882, 6176, 1451, 33, 178, "Output",ExpressionUUID->"3814268c-b89c-4f5e-a44b-5d16c7691429"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267370, 6214, 763, 18, 94, "Input",ExpressionUUID->"369d1968-b43b-48cd-8337-a31bd6bb1bff"],
Cell[268136, 6234, 2182, 42, 178, "Output",ExpressionUUID->"295edd04-a403-48cc-ba40-53bdf77499df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270355, 6281, 1338, 33, 136, "Input",ExpressionUUID->"74d6f871-4552-45e3-8b7a-30a309df6825"],
Cell[271696, 6316, 2760, 46, 178, "Output",ExpressionUUID->"2cb05533-bfe3-4548-b211-09271b57edaf"],
Cell[274459, 6364, 246, 6, 50, "Output",ExpressionUUID->"9dc2fef5-2d40-4b73-8069-05db7bcd7cd2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274742, 6375, 618, 14, 52, "Input",ExpressionUUID->"c4fca229-9502-4c86-b6fc-fdddf9b032a4"],
Cell[275363, 6391, 1166, 27, 178, "Output",ExpressionUUID->"c6f2940d-793d-46f2-8288-cad82d1296b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276566, 6423, 1801, 48, 115, "Input",ExpressionUUID->"f90c0874-ea2d-4578-8e5d-70292fb8dda9"],
Cell[278370, 6473, 1699, 42, 119, "Output",ExpressionUUID->"cf708028-5406-41d8-a74d-e0f806e34eb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280106, 6520, 1772, 52, 157, "Input",ExpressionUUID->"ceebd6b7-255b-4921-878e-c64e3e9c4db7"],
Cell[281881, 6574, 1963, 38, 178, "Output",ExpressionUUID->"cbc2b576-a241-4205-8bf5-1f187f42d4e6"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[283905, 6619, 446, 6, 67, "Section",ExpressionUUID->"4afda1f0-ead6-4091-ae21-2029b4a50078"],
Cell[CellGroupData[{
Cell[284376, 6629, 285, 7, 81, "Subsection",ExpressionUUID->"9fe54bcc-f173-4110-a1b2-10815ac38eff"],
Cell[284664, 6638, 8838, 201, 724, "Input",ExpressionUUID->"bdf643b5-73b2-4a7a-a3cf-220507e0ad43"]
}, Closed]],
Cell[CellGroupData[{
Cell[293539, 6844, 184, 3, 38, "Subsection",ExpressionUUID->"6479ac30-fcbb-4d07-aa80-6822f4e5ba04"],
Cell[293726, 6849, 198, 3, 35, "Text",ExpressionUUID->"0fc72fd1-a5c2-4162-8d93-6894d344f4e2"],
Cell[CellGroupData[{
Cell[293949, 6856, 216, 4, 30, "Input",ExpressionUUID->"e4fa08f7-4ccf-42e8-98bd-0565c60f308f"],
Cell[294168, 6862, 2161, 42, 178, "Output",ExpressionUUID->"17daeb10-9206-4ea1-99ec-b06417e1e8af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296366, 6909, 1557, 38, 115, "Input",ExpressionUUID->"2e4e40ec-96ed-4668-8035-6a7bc659ebfc"],
Cell[297926, 6949, 449, 10, 34, "Output",ExpressionUUID->"32c55ea5-fdc3-4484-b7f4-b89d0b24b534"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298412, 6964, 1496, 38, 115, "Input",ExpressionUUID->"db617dac-031e-4add-b2d8-a0f74138996f"],
Cell[299911, 7004, 2241, 42, 196, "Output",ExpressionUUID->"00349dbd-ca24-47da-a013-8989c037fd18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302189, 7051, 1904, 51, 157, "Input",ExpressionUUID->"eb3bf756-52f3-45bd-8f6a-98b4596b70c7"],
Cell[304096, 7104, 2163, 41, 196, "Output",ExpressionUUID->"85083021-b9a1-4668-bcdb-1eb9d940b3ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[306308, 7151, 261, 4, 54, "Subsection",ExpressionUUID->"0732ae54-d385-48da-8477-2e416c581996"],
Cell[CellGroupData[{
Cell[306594, 7159, 1174, 33, 115, "Input",ExpressionUUID->"84999e52-6ed6-4285-9a0d-d48ad994f85d"],
Cell[307771, 7194, 484, 10, 34, "Output",ExpressionUUID->"9aef6a51-8d40-4cd1-bdc1-40f4631176f3"]
}, Open  ]],
Cell[308270, 7207, 158, 3, 32, "Item",ExpressionUUID->"45d62966-ec63-4fca-9052-9bd71140e887"],
Cell[308431, 7212, 1280, 31, 94, "Input",ExpressionUUID->"3deba83a-dbaf-4d84-8c84-d8dae0f3b77d"],
Cell[309714, 7245, 177, 3, 32, "Item",ExpressionUUID->"a591d1f0-2ae0-48ff-b3e9-07f4f76b259e"],
Cell[309894, 7250, 940, 26, 94, "Input",ExpressionUUID->"1cf184a1-6b09-4fd9-9620-27eb6d327196"]
}, Closed]],
Cell[CellGroupData[{
Cell[310871, 7281, 284, 4, 38, "Subsection",ExpressionUUID->"1a578081-d84a-41a0-bef5-1cddbcd7a97d"],
Cell[311158, 7287, 389, 7, 58, "Text",ExpressionUUID->"6c0dc212-a263-47f7-b7c2-ecbf86c5adfc"],
Cell[CellGroupData[{
Cell[311572, 7298, 508, 10, 52, "Input",ExpressionUUID->"b502f975-c769-463e-b424-ad6360662250"],
Cell[312083, 7310, 1440, 30, 178, "Output",ExpressionUUID->"79d56b78-3597-467b-a449-92a26f52d5d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313560, 7345, 363, 9, 52, "Input",ExpressionUUID->"16016ea5-cb25-44f2-98b0-bedd80b6d825"],
Cell[313926, 7356, 1413, 29, 178, "Output",ExpressionUUID->"bdc4eb8a-b2eb-4356-95af-ac48c463e093"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315376, 7390, 1239, 33, 94, "Input",ExpressionUUID->"66cbc6a9-c6a1-4001-b49d-a87ae18594a0"],
Cell[316618, 7425, 425, 9, 34, "Output",ExpressionUUID->"f409cdfd-8c20-4bd2-8ebc-80f7ddffccba"],
Cell[317046, 7436, 417, 9, 34, "Output",ExpressionUUID->"5ce262bb-f51d-483f-8511-ca8ebb2ec0f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317500, 7450, 915, 27, 52, "Input",ExpressionUUID->"d60e5960-66d9-4d4e-8cac-895f796f88a6"],
Cell[318418, 7479, 402, 9, 34, "Output",ExpressionUUID->"c3c60628-c4fd-49ef-b200-7e1f60387520"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318857, 7493, 1703, 50, 157, "Input",ExpressionUUID->"e9e99233-1dda-4201-bfcb-62b62cd41543"],
Cell[320563, 7545, 1966, 39, 178, "Output",ExpressionUUID->"6ef10fb8-34d2-46b5-8808-489eafc31418"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322566, 7589, 2009, 54, 157, "Input",ExpressionUUID->"bd93e207-109b-43f0-9786-3561a3c92bfb"],
Cell[324578, 7645, 2070, 41, 178, "Output",ExpressionUUID->"50d97951-1d4b-4649-81b8-8392e793ddd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326685, 7691, 460, 12, 52, "Input",ExpressionUUID->"1ffa0756-0a31-4452-b946-c2d9fb8312c7"],
Cell[327148, 7705, 1657, 34, 178, "Output",ExpressionUUID->"792e0d7b-a10a-4b53-8add-deb728e542f5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

